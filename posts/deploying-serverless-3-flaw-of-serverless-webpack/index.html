<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.116.1"><title>serverless ë°°í¬í•˜ê¸° (3) serverless-webpackì˜ ê²°í•¨ - if1live space</title><meta name=author content="if1live"><meta name=title content="serverless ë°°í¬í•˜ê¸° (3) serverless-webpackì˜ ê²°í•¨"><meta name=description content="ì´ì „ê¸€ì—ì„œëŠ” serverless-webpack ê¸°ë°˜ìœ¼ë¡œ ë°°í¬ íŒ¨í‚¤ì§€ í¬ê¸°ë¥¼ ì¤„ì—¬ë´¤ë‹¤. 3ë¶€ì—ì„œëŠ” serverless-webpackì˜ ê²°í•¨ì„ ë‹¤ë£¬ë‹¤. ì‘ì„±ì¼ ê¸°ì¤€ìœ¼ë¡œ ìµœì‹  ë²„ì „ì€ 5.5.1 ì´ë‹¤"><meta name=keywords content="serverless"><meta name=naver-site-verification content="2ddc1a56777489f4a64a4f6a59822f8b1c1ea502"><meta name=google-site-verification content="VsvNNnJZUV-iLEYKNju16p-HtDqZeqL15H-VVy-HwpA"><meta name=gc:client-id content="785d47c81cbc2fd42b65"><meta name=gc:client-secret content="5e5d558f0b16fae154aa47fc9d94f7c09e540ec7"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><script type=text/javascript>var host="if1live.github.io";host==window.location.host&&window.location.protocol!="https:"?window.location.protocol="https":console.log("skip https redirect")</script><link rel=stylesheet href=/css/style.ad6245cc6a90c30a30dba42b8bbe9be63bed9ea169e339d8ecfc6b9afc6eb8382bbd422b2d31dc71c3355c79f057ddcaa7e1ca96b5eb7f5f16a28a34e74051db.css integrity="sha512-rWJFzGqQwwow26Qri76b5jvtnqFp4znY7PxrmvxuuDgrvUIrLTHcccM1XHnwV93Kp+HKlrXrf18Wooo050BR2w=="><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css integrity="sha512-cbQXwDFK7lj2Fqfkuxbo5iD1dSbLlJGXGpfTDqbggqjHJeyzx88I3rfwjS38WJag/ihH7lzuGlGHpDBymLirZQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin=anonymous><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-3043297488880636",enable_page_level_ads:!0})</script><meta property="og:title" content="serverless ë°°í¬í•˜ê¸° (3) serverless-webpackì˜ ê²°í•¨"><meta property="og:description" content="ì´ì „ê¸€ì—ì„œëŠ” serverless-webpack ê¸°ë°˜ìœ¼ë¡œ ë°°í¬ íŒ¨í‚¤ì§€ í¬ê¸°ë¥¼ ì¤„ì—¬ë´¤ë‹¤. 3ë¶€ì—ì„œëŠ” serverless-webpackì˜ ê²°í•¨ì„ ë‹¤ë£¬ë‹¤. ì‘ì„±ì¼ ê¸°ì¤€ìœ¼ë¡œ ìµœì‹  ë²„ì „ì€ 5.5.1 ì´ë‹¤"><meta property="og:type" content="article"><meta property="og:url" content="https://if1live.github.io/posts/deploying-serverless-3-flaw-of-serverless-webpack/"><meta property="og:image" content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-08-12T00:00:00+00:00"><meta property="article:modified_time" content="2021-08-12T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta name=twitter:title content="serverless ë°°í¬í•˜ê¸° (3) serverless-webpackì˜ ê²°í•¨"><meta name=twitter:description content="ì´ì „ê¸€ì—ì„œëŠ” serverless-webpack ê¸°ë°˜ìœ¼ë¡œ ë°°í¬ íŒ¨í‚¤ì§€ í¬ê¸°ë¥¼ ì¤„ì—¬ë´¤ë‹¤. 3ë¶€ì—ì„œëŠ” serverless-webpackì˜ ê²°í•¨ì„ ë‹¤ë£¬ë‹¤. ì‘ì„±ì¼ ê¸°ì¤€ìœ¼ë¡œ ìµœì‹  ë²„ì „ì€ 5.5.1 ì´ë‹¤"><meta name=twitter:site content="@if1live"><script async src="https://www.googletagmanager.com/gtag/js?id=G-SKE54STL16"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SKE54STL16",{anonymize_ip:!1})}</script></head><body><nav class=sora-navigation><a href=/ title=home><h1>if1live space</h1></a><ul class=menu-button-list><li><a href=/posts title=archive><i class="fa-solid fa-box-archive"></i>
<span hidden>archive</span></a></li><li><a href=/tags title=tags><i class="fa-solid fa-tags"></i>
<span hidden>tags</span></a></li><li><a href=//github.com/if1live title=GitHub><i class="fa-brands fa-github"></i>
<span hidden>GitHub</span></a></li><li><a href=/about title=about><i class="fa-solid fa-info"></i>
<span hidden>about</span></a></li><li><a href=https://if1live.github.io/index.xml title=RSS><i class="fa-solid fa-rss"></i>
<span hidden>RSS</span></a></li></ul></nav><div class=main><section id=single><h1 class=title><span>serverless ë°°í¬í•˜ê¸° (3) serverless-webpackì˜ ê²°í•¨</span></h1><div class=tip><time datetime="2021-08-12 00:00:00 +0000 UTC">2021. 08. 12</time></div><div class=content><p><a href=/posts/deploying-serverless-2-serverless-webpack-advance>ì´ì „ê¸€</a>ì—ì„œëŠ” serverless-webpack ê¸°ë°˜ìœ¼ë¡œ ë°°í¬ íŒ¨í‚¤ì§€ í¬ê¸°ë¥¼ ì¤„ì—¬ë´¤ë‹¤.
3ë¶€ì—ì„œëŠ” serverless-webpackì˜ ê²°í•¨ì„ ë‹¤ë£¬ë‹¤.
ì‘ì„±ì¼ ê¸°ì¤€ìœ¼ë¡œ ìµœì‹  ë²„ì „ì€ 5.5.1 ì´ë‹¤.
serverless-webpackì˜ ë²„ì „ì´ ì˜¬ë¼ê°€ë©´ ê¸€ì˜ ë‚´ìš©ê³¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤.</p><h2 id=íŒ¨í‚¤ì§•ì´-ì˜¤ë˜-ê±¸ë¦°ë‹¤>íŒ¨í‚¤ì§•ì´ ì˜¤ë˜ ê±¸ë¦°ë‹¤</h2><p><code>npx sls webpack</code>ë¥¼ ì‹¤í–‰í•œí›„ ê¸°ë‹¤ë¦¬ë©´ <code>.webpack/</code>, <code>.serverless/</code> ë””ë ‰í† ë¦¬ê°€ ìƒê¸´ë‹¤.
<code>.serverless/</code> ì•ˆì—ëŠ” ë°°í¬ íŒ¨í‚¤ì§€ <code>xxx.zip</code>ê°€ ë“¤ì–´ìˆë‹¤.
ë°°í¬ íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ëŠ” ì‹œê°„ì´ ë¹ ë¥´ë©´ ë°°í¬ ê³¼ì •ë„ ë¹ ë¥¼ ê²ƒì´ë‹¤.
ê·¼ë° <code>npx sls webpack</code>ëŠ” ìƒê°ë³´ë‹¤ ë§¤ìš° ì˜¤ë˜ ê±¸ë¦°ë‹¤.
ì˜ˆì œëŠ” ëª‡ì¤„ë„ ì•ˆë˜ëŠ” íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë‹ˆê¹Œ ì›¹íŒ© ë¹Œë“œëŠ” ë§¤ìš° ë¹ ë¥¼ ê²ƒì´ë‹¤.
ì˜ì¡´ì„± ê±¸ë¦° íŒ¨í‚¤ì§€ëŠ” ì´ë¯¸ ë¡œì»¬ <code>node_modules/</code>ì— ë“¤ì–´ìˆë‹¤.</p><p>ëŒ€ì²´ ì™œ ëŠë¦°ê±°ì§€?</p><h3 id=ì¤‘ë³µëœ-ë³µì‚¬>ì¤‘ë³µëœ ë³µì‚¬</h3><p>ì›¹íŒ© ë¹Œë“œ ê²°ê³¼ë¬¼ì„ ë’¤ì ¸ë³´ë©´ ë‘ê°œì˜ <code>node_modules/</code> ê°€ ìƒˆë¡œ ìƒê¸´ë‹¤.
ìˆ˜ì‹­MBì˜ íŒŒì¼, ìˆ˜ë§Œê°œì˜ íŒŒì¼ì´ ìƒˆë¡œ ìƒê²¼ìœ¼ë‹ˆ íŒ¨í‚¤ì§• ì†ë„ê°€ ë¹ ë¥¼ ìˆ˜ ì—†ë‹¤.</p><p>ê·¼ë° ì™œ <code>node_modules</code>ê°€ ë‘ê°œë‚˜ ìƒê¸´ê±°ì§€? ë””ë ‰í† ë¦¬ ë‚´ë¶€ë¥¼ ë¹„êµí•´ë³´ë©´ ì¬ë°Œë‹¤.
ì´ì „ê¸€ì—ì„œ ë°°í¬ íŒ¨í‚¤ì§€ í¬ê¸°ë¥¼ ì¤„ì´ë ¤ê³  <code>npx rimraf "node_modules/@types"</code>ë¥¼ ì»ë‹¤.</p><ul><li><code>.webpack/dependencies/node_modules</code><ul><li><code>@types</code> ìˆìŒ</li></ul></li><li><code>.webpack/services/node_modules</code><ul><li><code>@types</code> ì—†ìŒ</li></ul></li></ul><p>ê²°ê³¼ë¬¼ì„ ë³´ê³  serverless-webpackì˜ ì½”ë“œë¥¼ ë³´ì§€ ì•Šê³ ë„ ë™ì‘ì„ ìƒìƒí•  ìˆ˜ ìˆë‹¤.</p><ol><li>ìƒì„±: <code>.webpack/dependencies/node_modules</code></li><li>ë³µì‚¬: <code>.webpack/dependencies/node_modules</code> -> <code>.webpack/services/node_modules</code></li><li>ì‚­ì œ: <code>.webpack/services/node_modules/@types</code></li><li>zip: <code>.webpack/services</code> -> <code>.webpack/xxx.zip</code></li></ol><p>ê·¼ë° node_modulesëŠ” ëŒ€ì²´ ì™œ ë§Œë“¤ì–´ì§„ê±°ì§€?</p><h3 id=npm-install>npm install</h3><p>serverless-webpackì€ npm, yarnì„ ì§€ì›í•œë‹¤.
ì½”ë“œë¥¼ ë’¤ì ¸ë³´ë©´ ê°ê°ì˜ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ì— ëŒ€ì‘í•˜ëŠ” install ì´ ìˆë‹¤.</p><p><a href=https://github.com/serverless-heaven/serverless-webpack/blob/v5.5.1/lib/packagers/npm.js#L110>npm</a></p><pre><code class="language-js line-numbers">static install(cwd) {
	const command = /^win/.test(process.platform) ? &#39;npm.cmd&#39; : &#39;npm&#39;;
	const args = [&#39;install&#39;];

	return Utils.spawnProcess(command, args, { cwd }).return();
}</code></pre><p><a href=https://github.com/serverless-heaven/serverless-webpack/blob/v5.5.1/lib/packagers/yarn.js#L135>yarn</a></p><pre><code class="language-js line-numbers">static install(cwd, packagerOptions) {
	const command = /^win/.test(process.platform) ? &#39;yarn.cmd&#39; : &#39;yarn&#39;;
	const args = [ &#39;install&#39;, &#39;--non-interactive&#39; ];
	...
	return Utils.spawnProcess(command, args, { cwd }).return();
}</code></pre><p>ë‘ install í•¨ìˆ˜ ëª¨ë‘ <code>Utils.spawnProcess()</code>ë¥¼ ì“´ë‹¤.
ì´ í•¨ìˆ˜ëŠ” ì§„ì§œë¡œ processë¥¼ spawní•œë‹¤.
<code>.webpack/dependencies/node_modules</code>ëŠ” <code>npm install</code>ì— ì˜í•´ì„œ ë§Œë“¤ì–´ì§„ ê²ƒì´ë‹¤.
npm installì´ ì‹¤í–‰ë˜ê³  ì¸í„°ë„·ì—ì„œ íŒ¨í‚¤ì§€ë¥¼ ë°›ì„í…Œë‹ˆ íŒ¨í‚¤ì§• ì†ë„ê°€ ëŠë¦°ê±´ ì–´ì©” ìˆ˜ ì—†ë‹¤.</p><p><a href=https://github.com/serverless-heaven/serverless-webpack/blob/v5.5.1/lib/utils.js#L73>https://github.com/serverless-heaven/serverless-webpack/blob/v5.5.1/lib/utils.js#L73</a></p><pre><code class="language-js line-numbers">function spawnProcess(command, args, options) {
	return new BbPromise((resolve, reject) =&gt; {
		const child = childProcess.spawn(command, args, options);</code></pre><p>npm install í•˜ë ¤ë©´ package.jsonì´ í•„ìš”í•œë° ì´ê±´ ì–´ë–»ê²Œ ë§Œë“¤ì–´ì§„ê±°ì§€?</p><h2 id=ìƒˆë¡œìš´-packagejson>ìƒˆë¡œìš´ package.json</h2><p>serverless-webpackì´ ì–¼ë§ˆë‚˜ ë˜‘ë˜‘í•œì§€ ë³´ì—¬ì£¼ë ¤ê³  ë©ì²­í•œ ì§“ì„ í•´ë´¤ë‹¤.
<code>p-limit</code>ì€ package.jsonì—ëŠ” ìˆì§€ë§Œ handler.tsì—ëŠ” ì—†ë‹¤.
package.jsonì—ëŠ” ì˜ì¡´ì„±ì´ ì •ì˜ë˜ì–´ ìˆì§€ë§Œ ì‹¤ì œë¡œëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” íŒ¨í‚¤ì§€ì´ë‹¤.
<code>aws-xray-sdk-core</code>ëŠ” package.jsonì—ëŠ” ì—†ì§€ë§Œ handler.tsì—ëŠ” ìˆë‹¤.
<code>dynamo-types</code>ëŠ” <code>aws-xray-sdk-core</code>ì— ì˜ì¡´í•˜ê³  ìˆì–´ì„œ package.jsonì— ë„£ì§€ ì•Šì•„ë„ ì“¸ ìˆ˜ ìˆë‹¤.</p><p>package.json</p><pre class=markdown-textblock><code>"dependencies": {
	"aws-sdk": "^2.958.0",
	"dynamo-types": "^2.10.1",
	"lodash": "^4.17.21",
	"mysql": "^2.18.1",
	"p-limit": "^3.1.0",
	"typeorm": "^0.2.36"
},
"devDependencies": {
	"@types/aws-lambda": "^8.10.71",
	"@types/lodash": "^4.14.171",
	"@types/node": "^14.14.25",
	....</code></pre><p>src/handler.ts</p><pre><code class="language-ts line-numbers">import &#39;aws-sdk&#39;;
import &#39;dynamo-types&#39;;
import &#39;lodash&#39;;
import &#39;typeorm&#39;;
import &#39;mysql&#39;;

import &#39;aws-xray-sdk-core&#39;;</code></pre><p><code>npx sls webpack</code>ì„ ëŒë¦¬ë©´ ì•„ë˜ì™€ ê°™ì€ ë¡œê·¸ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.</p><pre class=markdown-textblock><code>Serverless: WARNING: Could not determine version of module aws-xray-sdk-core
Serverless: Excluding external modules: aws-sdk@^2.958.0
Serverless: Package lock found - Using locked versions
Serverless: Packing external modules: dynamo-types@^2.10.1, lodash@^4.17.21, typeorm@^0.2.36, mysql@^2.18.1, aws-xray-sdk-core
Serverless: WARNING: Could not determine version of module aws-xray-sdk-core
Serverless: Copying existing artifacts...</code></pre><p>.webpack/dependencies/package.json ê°€ ìƒì„±ëœë‹¤.</p><pre><code class="language-json line-numbers">{
  &#34;name&#34;: &#34;webpack-flaw&#34;,
  &#34;version&#34;: &#34;1.0.0&#34;,
  &#34;description&#34;: &#34;Packaged externals for webpack-flaw&#34;,
  &#34;private&#34;: true,
  &#34;scripts&#34;: {
    &#34;script0&#34;: &#34;npx rimraf \&#34;node_modules/{aws-sdk,figlet}\&#34;&#34;,
    &#34;script1&#34;: &#34;npx rimraf \&#34;node_modules/@types\&#34;&#34;
  },
  &#34;dependencies&#34;: {
    &#34;dynamo-types&#34;: &#34;^2.10.1&#34;,
    &#34;lodash&#34;: &#34;^4.17.21&#34;,
    &#34;typeorm&#34;: &#34;^0.2.36&#34;,
    &#34;mysql&#34;: &#34;^2.18.1&#34;,
    &#34;aws-xray-sdk-core&#34;: &#34;&#34;
  }
}</code></pre><p>package.jsonë¥¼ ë³´ë©´ ë¡œê·¸ë¥¼ í•´ì„í•  ìˆ˜ ìˆë‹¤.</p><pre class=markdown-textblock><code>Serverless: WARNING: Could not determine version of module aws-xray-sdk-core</code></pre><p>handler.tsì—ì„œ <code>aws-xray-sdk-core</code>ë¥¼ ì“°ë‹ˆê¹Œ ì˜ì¡´ì„±ì— ë¼ì›Œë„£ëŠ”ë‹¤.
í•˜ì§€ë§Œ ë²„ì „ì´ ë­”ì§€ ëª¨ë¥´ë‹ˆê¹Œ ê³µë°±ìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤. <code>"aws-xray-sdk-core": ""</code>.</p><pre class=markdown-textblock><code>Serverless: Excluding external modules: aws-sdk@^2.958.0</code></pre><p>ì´ì „ê¸€ì—ì„œ <code>serverless.yml</code> í¸ì§‘ì„ í†µí•´ì„œ <code>aws-sdk</code>ë¥¼ ì œì™¸í•˜ëŠ” ë°©ë²•ì„ ë‹¤ë¤˜ë‹¤.
ê·¸ë˜ì„œ ìƒì„±ëœ package.jsonì—ëŠ” <code>aws-sdk</code>ê°€ ì—†ë‹¤.</p><pre class=markdown-textblock><code>Serverless: Package lock found - Using locked versions
Serverless: Packing external modules: dynamo-types@^2.10.1, lodash@^4.17.21, typeorm@^0.2.36, mysql@^2.18.1, aws-xray-sdk-core</code></pre><p>ì›ë³¸ package.jsonì—ì„œ ë²„ì „ì„ ì°¾ì„ìˆ˜ ìˆëŠ”ê±´ ê·¸ëŒ€ë¡œ ìƒˆë¡œìš´ package.jsonì—ë„ í¬í•¨ëœë‹¤.</p><p>serverless-webpackì´ ì˜ ë§Œë“¤ì–´ì ¸ìˆì–´ì„œ ì½”ë“œì—ì„œ ì‚¬ìš©ë˜ì§€ ì•Šì€ <code>p-limit</code>ì„ ì§€ìš´ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><h3 id=phantom-dependencies>Phantom dependencies</h3><p>npmì˜ ê²½ìš° ì§ì ‘ ì„¤ì¹˜í•œì  ì—†ì§€ë§Œ ì˜ì¡´ì„±ì— ì˜í•´ì„œ ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ë¥¼ ì½”ë“œì—ì„œ ì“¸ ìˆ˜ ìˆë‹¤.
ì´ë¥¼ <a href=https://rushjs.io/pages/advanced/phantom_deps/>Phantom dependencies</a>ë¼ê³  ë¶€ë¥¸ë‹¤.</p><p>package.jsonì—ì„œëŠ” <code>aws-xray-sdk-core</code>ë¥¼ ì„¤ì¹˜í•œì  ì—†ë‹¤.
<code>dynamo-types</code>ê°€ ì„¤ì¹˜ë ë•Œ <code>aws-xray-sdk-core</code>ê°€ ê°™ì´ ì„¤ì¹˜ë˜ì„œ ì“¸ ìˆ˜ ìˆëŠ”ê±°ë‹¤.
ë‚˜ìœ ì½”ë“œì§€ë§Œ ì•„ë¬´íŠ¼ ëŒì•„ê°„ë‹¤. í•˜ì§€ë§Œ ë‚˜ìœ ì½”ë“œì—ëŠ” ì´ìœ ê°€ ìˆë‹¤.</p><p>ì˜¤ëŠ˜ì˜ <code>aws-xray-sdk-core</code>ì˜ ìµœì‹ ë²„ì „ì´ <code>2.3.6</code>ë¼ê³  ê°€ì •í•˜ì.
ì˜¤ëŠ˜ <code>npx sls webpack</code>ë¥¼ ëŒë¦¬ë©´ <code>"aws-xray-sdk-core": ""</code>ì— ì˜í•´ì„œ ì˜¤ëŠ˜ì˜ ìµœì‹ ë²„ì „ì´ ê¹”ë¦°ë‹¤.
<code>aws-xray-sdk-core@2.3.6</code>ì´ ê¹”ë¦°ë‹¤.
ì›ë³¸ <code>package-lock.json</code>ë„ ì˜¤ëŠ˜ì˜ ìµœì‹  ë²„ì „ì¸ <code>2.3.6</code>ìœ¼ë¡œ ê¸°ë¡ë  ê²ƒì´ë‹¤.</p><p>ëª‡ë‹¬ë’¤ì— <code>aws-xray-sdk-core</code>ì˜ ë²„ì „ì´ ë§ì´ ì˜¬ë¼ê°€ì„œ <code>3.3.3</code>ì´ ë˜ì—ˆë‹¤ê³  ì¹˜ì.
ë¯¸ë˜ì— <code>npx sls webpack</code>ë¥¼ ëŒë¦¬ë©´ <code>"aws-xray-sdk-core": ""</code>ì— ì˜í•´ì„œ ë¯¸ë˜ì˜ ìµœì‹ ë²„ì „ì´ ê¹”ë¦°ë‹¤.
<code>aws-xray-sdk-core@3.3.3</code>ì´ ê¹”ë¦°ë‹¤.</p><p><code>aws-xray-sdk-core</code>ê°€ ëŒ€ê²©ë³€ íŒ¨ì¹˜ë¥¼ ë„ˆë¬´ ë§ì´ í•´ì„œ <code>2.x</code>ì™€ <code>3.x</code>ì˜ í˜¸í™˜ì„±ì´ ê¹¨ì¡Œë‹¤ê³  ì¹˜ì.
<code>2.x</code>ì— ìˆë˜ í•¨ìˆ˜ê°€ <code>3.x</code>ì—ì„œ ì‚¬ë¼ì§ˆìˆ˜ë„ ìˆëŠ”ê±° ì•„ë‹ˆê² ëŠ”ê°€?</p><p>ë‚´ ì»´í“¨í„°ì—ì„œ ëª‡ë‹¬ë’¤ì— <code>npm install</code>ì„ ëŒë ¤ë„ package-lock.jsonì— ì˜í•´ì„œ <code>2.3.6</code>ê°€ ì„¤ì¹˜ë  ê²ƒì´ë‹¤.
ê·¼ë° serverless-webpackì„ ê±°ì³ì„œ ë°°í¬í•˜ë©´ ì˜¤ëŠ˜ì€ <code>2.3.6</code>ê°€ ê¹”ë¦¬ëŠ”ë° ëª‡ë‹¬ë’¤ì—ëŠ” <code>3.3.3</code>ì´ ê¹”ë¦°ë‹¤.
ì½”ë“œ í•œì¤„ ì•ˆê³ ì¹˜ê³  ë°°í¬ë§Œ ë‹¤ì‹œ ëŒë ¸ëŠ”ë° ì„œë¹„ìŠ¤ê°€ ë§ê°€ì¡Œë‹¤!</p><blockquote><p>// (1.a.2) Copy package-lock.json if it exists, to prevent unwanted upgrades
<a href=https://github.com/serverless-heaven/serverless-webpack/blob/v5.5.1/lib/packExternalModules.js#L291>https://github.com/serverless-heaven/serverless-webpack/blob/v5.5.1/lib/packExternalModules.js#L291</a></p></blockquote><p>serverless-webpackë„ íŒ¨í‚¤ì§€ê°€ ê°•ì œë¡œ ì—…ë°ì´íŠ¸ ë‹¹í•˜ëŠ” ë¬¸ì œë¥¼ í”¼í•˜ë ¤ê³  ë…¸ë ¥ì„ í–ˆë‹¤.
phantom dependenciesë¥¼ ë§‰ì§€ ëª»í•˜ëŠ”ê±´ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ì˜ ì˜ëª»ì´ë‹ˆê¹Œ serverless-webpackì˜ ë¬¸ì œëŠ” ì•„ë‹ˆë‹¤.</p><h2 id=ì‹œëŒ€ì—-ë’¤ì³ì§„-íŒ¨í‚¤ì§€-ê´€ë¦¬ì>ì‹œëŒ€ì— ë’¤ì³ì§„ íŒ¨í‚¤ì§€ ê´€ë¦¬ì</h2><p>node.js íŒ¨í‚¤ì§€ ê´€ë¦¬ìëŠ” ê³„ì† ë°œì „í•˜ê³  ìˆë‹¤.
íŒ¨í‚¤ì§€ ê´€ë¦¬ìê°€ ê°œì„ ë ìˆ˜ë¡ install ì†ë„ë„ ë¹¨ë¼ì§ˆ ê²ƒì´ë‹¤.
ìƒˆë¡œìš´ ê°œë…ì˜ íŒ¨í‚¤ì§€ ê´€ë¦¬ìê°€ ë“±ì¥í•´ì„œ install ì†ë„ê°€ ë§¤ìš° ë¹¨ë¼ì§€ê¸°ë„ í•œë‹¤.</p><p>í•˜ì§€ë§Œ serverless-webpackì—ëŠ” ê³µì§œ ì ì‹¬ì´ ì—†ë‹¤.
serverless-webpackì€ npmê³¼ yarn 1ë§Œ ì§€ì›í•œë‹¤.
yarn ë²„ì „ë„ 3.0.1ê¹Œì§€ ì˜¬ë¼ê°”ê³  pnpm ê°™ì´ ì¢‹ì€ íŒ¨í‚¤ì§€ ê´€ë¦¬ìë„ ë§Œë“¤ì–´ì¡ŒëŠ”ë° ì“¸ ìˆ˜ ì—†ë‹¤.</p><h2 id=ì–´ë–»ê²Œ-í•˜ë©´-ë¬¸ì œë¥¼-í•´ê²°í• -ìˆ˜-ìˆëŠ”ê°€>ì–´ë–»ê²Œ í•˜ë©´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ”ê°€?</h2><p>ë¬¸ì œê°€ ë­”ì§€ ì•Œì•˜ìœ¼ë‹ˆ serverless-webpackì„ ëœ¯ì–´ê³ ì¹˜ë©´ ëœë‹¤.
&mldr;ë¥¼ ì‹œë„í•˜ë ¤ê³  í–ˆìœ¼ë‚˜ serverless-webpack ì½”ë“œ ì—´ì–´ë³´ê³  ì ‘ì—ˆë‹¤.
ë‚˜ëŠ” ëŒ€ë‹¨í•œ ì‚¬ëŒì´ ì•„ë‹ˆë¼ì„œ serverless-webpack ëª»ê³ ì¹˜ê² ë”ë¼.</p><p>íŒ¨í‚¤ì§€ë¥¼ ì¸í„°ë„·ì—ì„œ ìƒˆë¡œ ë°›ëŠ”ì§“ì„ ì•ˆí•˜ë©´ ë¹¨ë¼ì§ˆê²ƒì´ë‹¤.
pnpmì˜ ê²½ìš° ë°›ì€ íŒ¨í‚¤ì§€ë¥¼ ë¡œì»¬ì— ì €ì¥í•´ë‘”ë‹¤.
ë‚˜ì¤‘ì— ê°™ì€ ë²„ì „ì„ installí•˜ë©´ ì¸í„°ë„·ì—ì„œ ë°›ëŠ” ëŒ€ì‹ ì— ë¡œì»¬ì— ì €ì¥ëœê²ƒì„ ì‚¬ìš©í•˜ë‹ˆê¹Œ ë¹ ë¥´ë‹¤.</p><p>Phantom dependenciesê°€ ìƒê¸°ì§€ ì•Šë„ë¡ ì½”ë”©ì„ ì˜ í•˜ë©´ ëœë‹¤.
ì´ê±´ ê±´ê°•í•œ ëª¸ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œ ì¢‹ì€ê±¸ ë¨¹ê³  ìš´ë™ì„ ì—´ì‹¬íˆ í•˜ë¼ëŠ” ì†Œë¦¬ì™€ ë˜‘ê°™ë‹¤.
ì˜ ì§œëŠ”ê²ƒë³´ë‹¤ ì›ë³¸ package.json, package lock fileì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ëŠ”ê²Œ ì‰¬ìš¸ê±°ê°™ë”ë¼.</p><h2 id=next>next?</h2><p>serverless-webpackì€ ëª»ì“°ê² ëŠ”ë° ì§ì ‘ serverless-webpackê°™ì€ê±° ë§Œë“¤ìë‹ˆ ê·€ì°®ë”ë¼.
ì´ëŸ´ë•ŒëŠ” ë¬´ì‹í•œ ë°©ë²•ì„ ì“°ë©´ ëœë‹¤. ì»¨í…Œì´ë„ˆë¡œ í¬ì¥í•´ì„œ ë„ì»¤ë¡œ ëŒë¦¬ë©´ ëœë‹¤.
<a href=https://aws.amazon.com/ko/blogs/korea/new-for-aws-lambda-container-image-support/>ì§€ê¸ˆ</a>ì€ ëŒë‹¤ì—ì„œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ëŒë¦´ ìˆ˜ ìˆë‹¤.
4ë¶€ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•´ì„œ ëŒë‹¤ ë°°í¬í•˜ëŠ” ì‚½ì§ˆì´ ë  ê²ƒì´ë‹¤.</p></div><div class=tags><a href=https://if1live.github.io/tags/serverless/>serverless</a></div><hr><div class=pagination><div class="left pagination-item"><a href=https://if1live.github.io/posts/deploying-serverless-2-serverless-webpack-advance/>ğŸ¡° serverless ë°°í¬í•˜ê¸° (2) serverless-webpack ê¸°ë°˜ìœ¼ë¡œ ë°°í¬ íŒ¨í‚¤ì§€ í¬ê¸° ì¤„ì´ê¸°</a></div><div class="right pagination-item"><a href=https://if1live.github.io/posts/typescript-pitfall-of-promise-and-error/>íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ + Promise + async/await + Error = ??? ğŸ¡²</a></div></div><div class=see-also><h2>See Also</h2><ul><li><a href=/posts/deploying-serverless-2-serverless-webpack-advance/>serverless ë°°í¬í•˜ê¸° (2) serverless-webpack ê¸°ë°˜ìœ¼ë¡œ ë°°í¬ íŒ¨í‚¤ì§€ í¬ê¸° ì¤„ì´ê¸°</a></li><li><a href=/posts/deploying-serverless-1-serverless-webpack-beginning/>serverless ë°°í¬í•˜ê¸° (1) serverless-webpack ì´ˆê¸‰</a></li><li><a href=/posts/trap-callback-waits-for-empty-event-loop/>callbackWaitsForEmptyEventLoopì™€ AWS Lambdaì˜ í•¨ì •</a></li><li><a href=/posts/serverless-framework-plugins/>serverless framework plugins</a></li></ul></div><div id=comment><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//libsora.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></section></div><footer class=sora-footer><p><a href=//gohugo.io/ title=Hugo>Hugo</a> |
<a href=//twitter.com/if1live/ title=@if1live>@if1live</a></p></footer><script src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js integrity="sha512-BttltKXFyWnGZQcRWj6osIg7lbizJchuAMotOkdLxHxwt/Hyo+cl47bZU0QADg+Qt5DJwni3SbYGXeGMB5cBcw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-clike.min.js integrity="sha512-/Rynaa6ehLZJO9fdk+EUsgiOdJqFSFUB4Qgy+gP4vU4U1DrmPJWypfXe1CgyaV7rRdZjGxdpLe9djxhx1ZHvqQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js integrity="sha512-8VrjxGFLIkS0mgEmO3p46A5OkqATHhrNVwyv2V7yUeZrk1jmSDuI3SOEpC9XHEHUWEOsfzzcJeBlUkee9lKGrw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js integrity="sha512-namzGTZvHaug0jeipHRN2pMepMiJj+EbrloktVFlMYGnA0EwZhbdLeENjBYLCgoghVbZGinIz/FFYHmB0o3wLw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js integrity="sha512-uOw7XYETzS/DPmmirpP5UCMihSDNMeyTS965J0/456OSPfxn9xEtHHjj5Q/5WefVdqyMfN/afmQnNpZd/tpkcA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js integrity="sha512-AKaNmg8COK0zEbjTdMHJAPJ0z6VeNqvRvH4/d5M4sHJbQQUToMBtodq4HaV4fa+WV2UTfoperElm66c9/8cKmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js integrity="sha512-jwrwRWZWW9J6bjmBOJxPcbRvEBSQeY4Ad0NEXSfP0vwYi/Yu9x5VhDBl3wz6Pnxs8Rx/t1P8r9/OHCRciHcT7Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js integrity="sha512-xKcnbsdT0KMoA4yrozkqZM1XJVTrPsjdQwvigxlAlxEDu8YDvC/jl+LfVqn0fY3Vs6m2y4a89JCHEIA/Z9zpmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js integrity="sha512-pmt3kb6dRndjFXFFwCa3rSzuUQ0GjeCfC5QULWde+8ZBIsUzuP1heOIOSAMfAyXHSufrrTp8h7UHw85K4IJ2/g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js integrity="sha512-whYhDwtTmlC/NpZlCr6PSsAaLOrfjVg/iXAnC4H/dtiHawpShhT2SlIMbpIhT/IL/NrpdMm+Hq2C13+VKpHTYw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-ruby.min.js integrity="sha512-/Dti0iV9cxgJe8r0U/89YJIv9ZBQu1ExEWffVyBj4juMQ4GNglQ3TQ0Up4gcbiHvg0g87arcUFbKBtw2PxH1Dw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js integrity="sha512-w200Nz1i9KgDNi+IpPMgpZBVRIvfVK/V5vskyHjkz7XJkVnRJcb1uNmpiHhDv0/Ln+GG2VqScKKz/1izBfg64Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-less.min.js integrity="sha512-lL5HvfIycntK04Iiai/VTsyuj7mvDkhz9k+cA8fqXr932s4jLJ1YwplIs6Dhpw0pzVwAe1jGe8sGwbyuHG44QQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-scss.min.js integrity="sha512-aczOaJ+mB9uGT6dMJbDaUsS2PWG+XII+1ypFQ0L22Z132V6kMM6m70pQssXsPAFmLI5xkgx/hknBuUuJIJKZfA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js integrity="sha512-uMdVuOpm+9lNPCT7mV/YaMb9YQ/R4+eeON7aEMj6Ig/f4BoU+Q5k6iaZkDsX7LH9cjTHZt0CuKxbzd0/fndrWA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js integrity="sha512-QXFMVAusM85vUYDaNgcYeU3rzSlc+bTV4JvkfJhjxSHlQEo+ig53BtnGkvFTiNJh8D+wv6uWAQ2vJaVmxe8d3w==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js integrity="sha512-6O/PZimM3TD1NN3yrazePA4AbZrPcwt1QCGJrVY7WoHDJROZFc9TlBvIKMe+QfqgcslW4lQeBzNJEJvIMC8WhA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-batch.min.js integrity="sha512-tPgIjUKiv2HcUAIWXA3v6G4cNuWXkoMsF+ibxfHLnp+/s1C3Bw5/qp78+JjhrfoyWIiHXHx0LtH4M/LAwyQqWg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lisp.min.js integrity="sha512-W461RnQzrhSCQQMfEGFKOHbK2DuJTVxrXs2PzctPaxV3A+qPB/TcnMgucSsBNkyccNK8VoENBsAnbf/SuBE71g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin=anonymous></script>
<script>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]});for(var inlineMathArray=document.querySelectorAll("script[type='math/tex']"),inlineMath,tex,replaced,displayMathArray,displayMath,i=0;i<inlineMathArray.length;i++)inlineMath=inlineMathArray[i],tex=inlineMath.innerText||inlineMath.textContent,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex,{displayMode:!1}),inlineMath.parentNode.replaceChild(replaced,inlineMath);displayMathArray=document.querySelectorAll("script[type='math/tex; mode=display']");for(i=0;i<displayMathArray.length;i++)displayMath=displayMathArray[i],tex=displayMath.innerHTML,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex.replace(/%.*/g,""),{displayMode:!0}),displayMath.parentNode.replaceChild(replaced,displayMath)</script></body></html>