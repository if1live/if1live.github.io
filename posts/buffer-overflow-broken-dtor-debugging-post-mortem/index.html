<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.116.1"><title>ë””ë²„ê¹… í¬ìŠ¤íŠ¸ëª¨í…œ - ë°•ì‚´ë‚œ ì†Œë©¸ì - if1live space</title><meta name=author content="if1live"><meta name=title content="ë””ë²„ê¹… í¬ìŠ¤íŠ¸ëª¨í…œ - ë°•ì‚´ë‚œ ì†Œë©¸ì"><meta name=description content="ê°œìš” ìµœê·¼ì— ë ˆê±°ì‹œ ì½”ë“œì— ìˆ¨ê²¨ì§„ ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ë²„ê·¸ë¥¼ ì¡ëŠë¼ê³  í•˜ë£¨ë¥¼ ë‚ ë ¸ìŠµë‹ˆë‹¤. ì°¾ê³ ë‚˜ë‹ˆ ê°„ë‹¨í•œ ë²„ê·¸ì˜€ì§€ë§Œ í•˜ë£¨ì”©ì´ë‚˜ ê±¸ë ¸ìŠµë‹ˆë‹¤. ë²„ê·¸ë¥¼ ì¡ì€ ë‹¤ìŒì— ìƒê°"><meta name=keywords content="lldb,buffer overflow,buffer overrun,memory bug,debug,debugging,destructor,postmortem"><meta name=naver-site-verification content="2ddc1a56777489f4a64a4f6a59822f8b1c1ea502"><meta name=google-site-verification content="VsvNNnJZUV-iLEYKNju16p-HtDqZeqL15H-VVy-HwpA"><meta name=gc:client-id content="785d47c81cbc2fd42b65"><meta name=gc:client-secret content="5e5d558f0b16fae154aa47fc9d94f7c09e540ec7"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><script type=text/javascript>var host="if1live.github.io";host==window.location.host&&window.location.protocol!="https:"?window.location.protocol="https":console.log("skip https redirect")</script><link rel=stylesheet href=/css/style.ad6245cc6a90c30a30dba42b8bbe9be63bed9ea169e339d8ecfc6b9afc6eb8382bbd422b2d31dc71c3355c79f057ddcaa7e1ca96b5eb7f5f16a28a34e74051db.css integrity="sha512-rWJFzGqQwwow26Qri76b5jvtnqFp4znY7PxrmvxuuDgrvUIrLTHcccM1XHnwV93Kp+HKlrXrf18Wooo050BR2w=="><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css integrity="sha512-cbQXwDFK7lj2Fqfkuxbo5iD1dSbLlJGXGpfTDqbggqjHJeyzx88I3rfwjS38WJag/ihH7lzuGlGHpDBymLirZQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin=anonymous><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-3043297488880636",enable_page_level_ads:!0})</script><meta property="og:title" content="ë””ë²„ê¹… í¬ìŠ¤íŠ¸ëª¨í…œ - ë°•ì‚´ë‚œ ì†Œë©¸ì"><meta property="og:description" content="ê°œìš” ìµœê·¼ì— ë ˆê±°ì‹œ ì½”ë“œì— ìˆ¨ê²¨ì§„ ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ë²„ê·¸ë¥¼ ì¡ëŠë¼ê³  í•˜ë£¨ë¥¼ ë‚ ë ¸ìŠµë‹ˆë‹¤. ì°¾ê³ ë‚˜ë‹ˆ ê°„ë‹¨í•œ ë²„ê·¸ì˜€ì§€ë§Œ í•˜ë£¨ì”©ì´ë‚˜ ê±¸ë ¸ìŠµë‹ˆë‹¤. ë²„ê·¸ë¥¼ ì¡ì€ ë‹¤ìŒì— ìƒê°"><meta property="og:type" content="article"><meta property="og:url" content="https://if1live.github.io/posts/buffer-overflow-broken-dtor-debugging-post-mortem/"><meta property="og:image" content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-01-17T00:00:00+00:00"><meta property="article:modified_time" content="2016-01-17T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta name=twitter:title content="ë””ë²„ê¹… í¬ìŠ¤íŠ¸ëª¨í…œ - ë°•ì‚´ë‚œ ì†Œë©¸ì"><meta name=twitter:description content="ê°œìš” ìµœê·¼ì— ë ˆê±°ì‹œ ì½”ë“œì— ìˆ¨ê²¨ì§„ ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ë²„ê·¸ë¥¼ ì¡ëŠë¼ê³  í•˜ë£¨ë¥¼ ë‚ ë ¸ìŠµë‹ˆë‹¤. ì°¾ê³ ë‚˜ë‹ˆ ê°„ë‹¨í•œ ë²„ê·¸ì˜€ì§€ë§Œ í•˜ë£¨ì”©ì´ë‚˜ ê±¸ë ¸ìŠµë‹ˆë‹¤. ë²„ê·¸ë¥¼ ì¡ì€ ë‹¤ìŒì— ìƒê°"><meta name=twitter:site content="@if1live"><script async src="https://www.googletagmanager.com/gtag/js?id=G-SKE54STL16"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SKE54STL16",{anonymize_ip:!1})}</script></head><body><nav class=sora-navigation><a href=/ title=home><h1>if1live space</h1></a><ul class=menu-button-list><li><a href=/posts title=archive><i class="fa-solid fa-box-archive"></i>
<span hidden>archive</span></a></li><li><a href=/tags title=tags><i class="fa-solid fa-tags"></i>
<span hidden>tags</span></a></li><li><a href=//github.com/if1live title=GitHub><i class="fa-brands fa-github"></i>
<span hidden>GitHub</span></a></li><li><a href=/about title=about><i class="fa-solid fa-info"></i>
<span hidden>about</span></a></li><li><a href=https://if1live.github.io/index.xml title=RSS><i class="fa-solid fa-rss"></i>
<span hidden>RSS</span></a></li></ul></nav><div class=main><section id=single><h1 class=title><span>ë””ë²„ê¹… í¬ìŠ¤íŠ¸ëª¨í…œ - ë°•ì‚´ë‚œ ì†Œë©¸ì</span><br><small>LLDBë¥¼ ì´ìš©í•´ì„œ ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ì°¾ê¸°</small></h1><div class=tip><time datetime="2016-01-17 00:00:00 +0000 UTC">2016. 01. 17</time></div><div class=content><h2 id=ê°œìš”>ê°œìš”</h2><p>ìµœê·¼ì— ë ˆê±°ì‹œ ì½”ë“œì— ìˆ¨ê²¨ì§„ ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ë²„ê·¸ë¥¼ ì¡ëŠë¼ê³  í•˜ë£¨ë¥¼
ë‚ ë ¸ìŠµë‹ˆë‹¤. ì°¾ê³ ë‚˜ë‹ˆ ê°„ë‹¨í•œ ë²„ê·¸ì˜€ì§€ë§Œ í•˜ë£¨ì”©ì´ë‚˜ ê±¸ë ¸ìŠµë‹ˆë‹¤. ë²„ê·¸ë¥¼
ì¡ì€ ë‹¤ìŒì— ìƒê°í•˜ë‹ˆ ì—¬ëŸ¬ê°€ì§€ ìš”ì†Œê°€ ê²°í•©ë˜ì–´ì„œ ë””ë²„ê¹…ì´ ì˜¤ë˜ ê±¸ë¦°ê±°
ê°™ì•˜ìŠµë‹ˆë‹¤.</p><ul><li>ì½œìŠ¤íƒì´ ì´ìƒí•˜ê²Œ ë‚˜ì™€ì„œ ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ë²„ê·¸ì¸ì§€ ê°ì„ ì¡ëŠ”ë° ì˜¤ë˜ ê±¸ë¦¼</li><li>step in, step out, continue, next ì´ì™¸ì˜ ë””ë²„ê±° ê¸°ëŠ¥ì„ ì•ˆì¨ë´¤ë‹¤.</li><li>ë§ë¡œë§Œ ë“£ê³  í•œë²ˆë„ ì•ˆì¨ë³¸ watchpoint ì‚¬ìš©ë²•ì„ ì°¾ì•„ë³´ëŠ”ë° ì˜¤ë˜ ê±¸ë¦¼</li><li>gdbë§Œ ì“°ë‹¤ê°€ lldbë¥¼ ì²˜ìŒ ì¨ë´„. gdbì™€ lldbì˜ ëª…ë ¹ì–´ëŠ” ë‹¤ë¥´ë‹¤</li></ul><p>ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ê°€ìƒ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‘ì„±í•˜ê³  ì´ë¥¼
ë””ë²„ê¹…í•¨ìœ¼ë¡œì¨ ë‚˜ì¤‘ì— ê°™ì€ ë²„ê·¸ë¥¼ ë§Œë‚¬ì„ë•Œ ë¹ ë¥´ê²Œ ëŒ€ì‘í•˜ëŠ”ê±¸ ëª©í‘œë¡œ
ë””ë²„ê¹… í¬ìŠ¤íŠ¸ëª¨í…œì„ ì‘ì„±í•´ë³´ì•˜ìŠµë‹ˆë‹¤.</p><ul><li>ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ì´ ë°œìƒí•˜ëŠ” ì˜ˆì œ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤.</li><li>LLDBì˜ ê°„ë‹¨í•œ ì‚¬ìš©ë²•ì„ ìµíŒë‹¤.</li><li>watchpointë¥¼ ì´ìš©í•´ì„œ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ì°¾ëŠ”ë‹¤.</li></ul><h2 id=ê°„ë‹¨í•œ-ìŠ¤í¬ë¦½íŠ¸-ì—”ì§„ì„-ë§Œë“¤ì>ê°„ë‹¨í•œ ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì„ ë§Œë“¤ì</h2><p>ê°„ë‹¨í•œ ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì„ ë§Œë“¤ì–´ ë´…ì‹œë‹¤. ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì€ í…ìŠ¤íŠ¸ íŒŒì¼ì„
ì½ì„ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• í˜•íƒœëŠ” <code>&lt;command> &lt;name>:&lt;text></code> ì…ë‹ˆë‹¤.
ëª¨ë“  ëª…ë ¹ì€ í•œì¤„ ë‹¨ìœ„ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.</p><pre><code class="language-txt line-numbers">say ì² ìˆ˜:hello
play ì˜í¬:game
??? ë¯¼ìˆ˜:dummy text</code></pre><p>ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ê³¼ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ê°™ì´ ì‹¤í–‰í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ì¶œë ¥ì´
ë‚˜ì˜µë‹ˆë‹¤. í˜„ì¬ëŠ” ì½˜ì†”ë¡œë§Œ ì¶œë ¥í•˜ì§€ë§Œ GUI, ê²Œì„ ì—”ì§„ì„ ë¶™ì—¬ì„œ í™•ì¥í•˜ë©´
ê°„ë‹¨í•œ í…ìŠ¤íŠ¸ ì–´ë“œë²¤ì³ëŠ” ë§Œë“¤ìˆ˜ ìˆì„ê²ë‹ˆë‹¤.</p><pre class=markdown-textblock><code>$ clang++ main.cpp -g -W -Wall -std=c++11
$ ./a.out normal.txt
ì² ìˆ˜ say "hello".
ì˜í¬ play game.
Unknown: cmd=???, name=ë¯¼ìˆ˜, text=dummy text.</code></pre><p>ì–´ë–¤ê±¸ ë§Œë“¤ì–´ì•¼í•˜ëŠ”ì§€ ì•Œì•˜ìœ¼ë‹ˆ êµ¬í˜„í•´ë³´ì•˜ìŠµë‹ˆë‹¤.</p><h2 id=ì½”ë“œ>ì½”ë“œ</h2><pre><code class="language-cpp line-numbers">class ScriptEngine {
public:
  ScriptEngine(const char *filename);
  ~ScriptEngine();

  void parseLine(bool *has_next);
  void executeLine();

private:
  void open();
  void close();

private:
  // state
  int curr_pos_;
  char cmd_[8];
  char name_[8];
  char text_[8];

  // raw script content
  std::string filename_;
  const char *data_;
  int length_;
  int fd_;
};</code></pre><p>ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì˜ í—¤ë”ì…ë‹ˆë‹¤. ìƒì„±ìë¡œ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ì´ë¦„ì„ ë°›ìŠµë‹ˆë‹¤.
í•œì¤„ì”© ì½ì–´ì„œ ëª…ë ¹ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì½ì€ ëª…ë ¹ì„ ì„ì‹œë¡œ ì €ì¥í•˜ê¸° ìœ„í•´ ë¬¸ìì—´
ë°°ì—´ <code>cmd_</code>, <code>name_</code>, <code>text_</code> ì„ ì´ìš©í•©ë‹ˆë‹¤. ì—´ì–´ë†“ì€ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„
ê´€ë¦¬í•˜ëŠ” ëª©ì ì˜ ë³€ìˆ˜ë„ ë©¤ë²„ ë³€ìˆ˜ë¡œ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p><pre><code class="language-cpp line-numbers">int main(int argc, char *argv[0])
{
  if(argc != 2) {
    printf(&#34;Usage: %s &lt;script filepath&gt;\n&#34;, argv[0]);
    exit(0);
  }

  ScriptEngine script_engine(argv[1]);

  bool has_next = true;
  while(has_next) {
    script_engine.parseLine(&amp;has_next);
    script_engine.executeLine();
  }
  return 0;
}</code></pre><p><code>main()</code> ì…ë‹ˆë‹¤. ëª…ë ¹ì¤„ ì¸ìˆ˜ë¡œ ì‹¤í–‰í•  ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ëª…ì„ ë°›ìŠµë‹ˆë‹¤.
ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì€ ë‹¤ìŒ ëª…ë ¹ì´ ì—†ì„ë•Œê¹Œì§€ í•œì¤„ì”© ì½ê³  ì²˜ë¦¬í•©ë‹ˆë‹¤.</p><pre><code class="language-cpp line-numbers">ScriptEngine::ScriptEngine(const char *filename)
  : curr_pos_(0), filename_(filename), data_(nullptr), length_(-1), fd_(-1)
{
  std::fill(cmd_, cmd_ &#43; sizeof(cmd_), 0);
  std::fill(name_, name_ &#43; sizeof(name_), 0);
  std::fill(text_, text_ &#43; sizeof(text_), 0);

  open();
}

ScriptEngine::~ScriptEngine()
{
  close();
}</code></pre><p>ìƒì„±ìì—ì„œëŠ” ë©¤ë²„ ë³€ìˆ˜ë¥¼ ì´ˆê¸°í™”í•˜ê³  ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì—½ë‹ˆë‹¤. ì†Œë©¸ìì—ì„œëŠ”
ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ë‹«ìŠµë‹ˆë‹¤. íŒŒì¼ì„ ì—´ê³  ë‹«ëŠ” ìƒì„¸ ê³¼ì •ì€ ë³„ë„ì˜ í•¨ìˆ˜ì—
êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.</p><pre><code class="language-cpp line-numbers">void ScriptEngine::open()
{
  // open
  fd_ = ::open(filename_.data(), O_RDONLY, 0);
  if(fd_ == -1) {
    err(1, &#34;open&#34;);
  }

  // get file size
  struct stat sb;
  if(fstat(fd_, &amp;sb) &lt; 0) {
    err(1, &#34;fstat&#34;);
  }
  length_ = sb.st_size;

  //memory map
  data_ = (char *)mmap(NULL, length_, PROT_READ, MAP_SHARED, fd_, 0);
  if(data_ == MAP_FAILED) {
    err(1, &#34;mmap&#34;);
  }
}

void ScriptEngine::close()
{
  if(fd_ != -1) {
    munmap((void*)data_, length_);
    ::close(fd_);

    fd_ = -1;
  }
}</code></pre><p><code>ScriptEngine::open()</code>, <code>ScriptEngine::close()</code> ëŠ”
<a href=https://en.wikipedia.org/wiki/Mmap>mmap</a> ì„ ì´ìš©í•´ì„œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
íŒŒì¼ì„ ì—´ì–´ì„œ <code>data_</code> ì— ì—°ê²°í•˜ê³  íŒŒì¼ì˜ í¬ê¸°ëŠ” <code>length_</code> ì—
ì €ì¥í•´ë‘¡ë‹ˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ í•œì¤„ì”© ì½ì–´ì„œ ì²˜ë¦¬í• ë•Œ ìœ„ì˜ ë‘ ë³€ìˆ˜ë¥¼
ì´ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.</p><pre><code class="language-cpp line-numbers">void ScriptEngine::parseLine(bool *has_next)
{</code></pre><p>ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ë¡œë¶€í„° ëª…ë ¹ì„ í•œì¤„ì”© ì½ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. ì½ì€ ë‚´ìš©ì€ <code>cmd_</code>,
<code>name_</code>, <code>text_</code> ì— ì €ì¥í•©ë‹ˆë‹¤.</p><pre><code class="language-cpp line-numbers">  // syntax
  // &lt;cmd&gt; &lt;name&gt;:&lt;text&gt;
  enum ParseState {
    STATE_CMD,
    STATE_NAME,
    STATE_TEXT,
    STATE_FINISH,
  };

  struct ParseCommand {
    ParseState curr_state;
    ParseState next_state;
    char delim;
    char *buffer;
    int buffer_size;
  };

  ParseCommand cmds[] = {
    { STATE_CMD, STATE_NAME, &#39; &#39;, cmd_, sizeof(cmd_) },
    { STATE_NAME, STATE_TEXT, &#39;:&#39;, name_, sizeof(name_) },
    { STATE_TEXT, STATE_FINISH, &#39;\n&#39;, text_, sizeof(text_) },
  };

  ParseState parse_state = STATE_CMD;</code></pre><p>FSMì„ ì´ìš©í•´ì„œ ëª…ë ¹ì¤„ íŒŒì‹±ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ìƒíƒœëŠ” <code>STATE_CMD</code> ->
<code>STATE_NAME</code> -> <code>STATE_TEXT</code> -> <code>STATE_FINISH</code> ë¡œ ë°”ë€Œë©´ì„œ ê°ê°ì˜
ë‚´ìš©ì„ ì½ìŠµë‹ˆë‹¤. íŠ¹ë³„í•œ ë¬¸ìì—´(delim)ì„ ë§Œë‚˜ë©´ ë‹¤ìŒ ìƒíƒœë¡œ ì „ì´í•©ë‹ˆë‹¤.
ê°ê°ì˜ ìƒíƒœì—ì„œ ì½ì€ ë‚´ìš©ì„ ì €ì¥í•˜ê¸° ìœ„í•œ ë²„í¼ì˜ ì£¼ì†Œ, í¬ê¸°ë„ ìƒíƒœì—
í¬í•¨ì‹œí‚µë‹ˆë‹¤.</p><pre><code class="language-cpp line-numbers">  char buffer[1024];
  int len = 0;

  while((curr_pos_ &lt; length_) &amp;&amp; (parse_state != STATE_FINISH)) {
    char ch = data_[curr_pos_&#43;&#43;];

    for(const ParseCommand &amp;cmd : cmds) {
      if(cmd.curr_state == parse_state) {
        if(cmd.delim == ch) {
          memset(cmd.buffer, 0, cmd.buffer_size);
          memcpy(cmd.buffer, buffer, len);

          parse_state = cmd.next_state;
          len = 0;
        } else {
          buffer[len&#43;&#43;] = ch;
        }
        break;
      }
    }
  }</code></pre><p>ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì˜ ëì´ë‚˜ <code>STATE_FINISH</code> ë¥¼ ë§Œë‚˜ê¸° ì „ê¹Œì§€ í•œ ê¸€ìì”©
ì½ìŠµë‹ˆë‹¤. delimì„ ë§Œë‚˜ì„œ ìƒíƒœë¥¼ ë°”ê¿”ì•¼ë˜ëŠ” ìƒí™©ì´ ì˜¤ë©´ ì§€ì—­ ë³€ìˆ˜
<code>buffer</code> ì— ì €ì¥ëœ ë‚´ìš©ì„ ê²°ê³¼ ë²„í¼ì— ë³µì‚¬í•©ë‹ˆë‹¤. ì´ë•Œ <code>memset()</code>,
<code>memcpy()</code> ë¥¼ ì´ìš©í•©ë‹ˆë‹¤.</p><pre><code class="language-cpp line-numbers">  *has_next = (curr_pos_ &lt; length_);
}</code></pre><p>ë”ì´ìƒ íŒŒì‹±í• ìˆ˜ ì—†ìœ¼ë©´ ìŠ¤í¬ë¦½íŠ¸ê°€ ëë‚¬ë‹¤ëŠ”ê±¸ ì•Œë ¤ì¤ë‹ˆë‹¤.</p><pre><code class="language-cpp line-numbers">void ScriptEngine::executeLine()
{
  // add complex feature here
  if(std::string(&#34;play&#34;) == cmd_) {
    printf(&#34;%s %s %s.\n&#34;, name_, cmd_, text_);

  } else if(std::string(&#34;say&#34;) == cmd_) {
    printf(&#34;%s %s \&#34;%s\&#34;.\n&#34;, name_, cmd_, text_);

  } else {
    printf(&#34;Unknown: cmd=%s, name=%s, text=%s.\n&#34;, cmd_, name_, text_);
  }
}</code></pre><p><code>parseLine()</code> ì—ì„œ ì½ì–´ë‘” ë‚´ìš©ì„ ì´ìš©í•´ì„œ ëª…ë ¹ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ê°€
ì–´ë–¤ ì‘ì—…ì„ ìˆ˜í–‰í• ì§€ëŠ” ì—¬ê¸°ì— ì ì ˆíˆ êµ¬í˜„í•©ë‹ˆë‹¤.</p><h2 id=epic-fail>EPIC FAIL</h2><p>ìµœì´ˆì— ì˜ˆì œë¡œ ì •í•œ íŒŒì¼ì— ëŒ€í•´ì„œëŠ” ì˜ ëŒì•„ê°€ì§€ë§Œ ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼
ì•ì—ì„œëŠ” ë§í•©ë‹ˆë‹¤.</p><pre><code class="language-txt line-numbers">say ì² ìˆ˜:abcdefghijklmnopqrstuvwxyz123456
play ì˜í¬:game</code></pre><pre class=markdown-textblock><code>$ clang++ main.cpp -g -W -Wall -std=c++11
$ ./a.out long.txt
ì² ìˆ˜ say "abcdefghijklmnopqrstuvwxyz123456".
ì˜í¬ play game.
a.out(6937,0x7f...) malloc: *** error for object 0x36353433: pointer being freed was not allocated
*** set a breakpoint in malloc_error_break to debug
make: *** [run] Abort trap: 6</code></pre><p>??? new, allocê³¼ ê°™ì€ ë™ì í• ë‹¹ì„ ì§ì ‘ ìˆ˜í–‰í•œì ì´ ì—†ëŠ”ë° í”„ë¡œê·¸ë¨ì€
mallocì™€ ê´€ë ¨ëœ ë¬¸ì œë¡œ ì£½ìŠµë‹ˆë‹¤. ì™œ ì£½ì—ˆë‚˜ ë””ë²„ê¹…ì„ í•©ì‹œë‹¤.</p><h2 id=lldbì™€-í•¨ê»˜í•˜ëŠ”-ë””ë²„ê¹…>LLDBì™€ í•¨ê»˜í•˜ëŠ” ë””ë²„ê¹…</h2><p><a href=https://en.wikipedia.org/wiki/LLDB_%28debugger%29>LLDB</a> ëŠ” Clangì—
ë¶™ì–´ìˆëŠ” ë””ë²„ê±°ì…ë‹ˆë‹¤. Max OSXì—ì„œ xcodeë¥¼ ì„¤ì¹˜í–ˆë”ë‹ˆ gdbëŒ€ì‹  lldbë°–ì—
ì—†ì–´ì„œ ì´ê±°ë¡œ ë””ë²„ê¹…í•´ë´…ë‹ˆë‹¤. (ì£¼ì˜: lldbì™€ gdbëŠ” ëª…ë ¹ì´ ë‹¤ë¦…ë‹ˆë‹¤)</p><h3 id=ì–´ë””ì„œ-ì£½ì—ˆë‚˜-ì°¾ì•„ë‚´ê¸°>ì–´ë””ì„œ ì£½ì—ˆë‚˜ ì°¾ì•„ë‚´ê¸°</h3><p>ì½˜ì†”ì— ì°íŒ ì •ë³´ë§Œìœ¼ë¡œëŠ” ì–´ë””ì„œ ì£½ì—ˆë‚˜ ì˜ ëª¨ë¥´ê² ìœ¼ë‹ˆ ì¼ë‹¨ ì£½ì—¬ë´…ì‹œë‹¤.
main.cpp ë¥¼ <code>-g</code> ì˜µì…˜ìœ¼ë¡œ ì»´íŒŒì¼í•´ì„œ ë””ë²„ê·¸ ì •ë³´ë¥¼ ë„£ì–´ë‘¡ë‹ˆë‹¤. ê·¸ë¦¬ê³ 
lldbë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p><pre class=markdown-textblock><code>$ clang++ main.cpp -g -W -Wall -std=c++11
$ lldb a.out
(lldb) target create "a.out"
Current executable set to 'a.out' (x86_64).</code></pre><p>ì¼ë‹¨ ëŒë ¤ë³´ê³  ì–´ë””ì„œ ì£½ë‚˜ ë´…ì‹œë‹¤. process launch ë¥¼ ì´ìš©í•´ì„œ í”„ë¡œê·¸ë¨ì„
ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¡œ ëª…ë ¹ì¤„ ì¸ìˆ˜ë¥¼ ê°™ì´ ë„˜ê¸¸ìˆ˜
ìˆìŠµë‹ˆë‹¤. <code>process launch -- long.txt</code></p><pre class=markdown-textblock><code>(lldb) process launch -- long.txt
Process 7611 launched: '..../a.out' (x86_64)
ì² ìˆ˜ say "abcdefghijklmnopqrstuvwxyz123456".
ì˜í¬ play game.
a.out(7611,0x7f...) malloc: *** error for object 0x36353433: pointer being freed was not allocated
*** set a breakpoint in malloc_error_break to debug
Process 7611 stopped
* thread #1: tid = 0x13ca2, 0x00007fff869280ae libsystem_kernel.dylib`__pthread_kill + 10,...
    frame #0: 0x00007fff869280ae libsystem_kernel.dylib`__pthread_kill + 10
    libsystem_kernel.dylib`__pthread_kill:
->  0x7fff869280ae <+10>: jae    0x7fff869280b8            ; <+20>
    0x7fff869280b0 <+12>: movq   %rax, %rdi
    0x7fff869280b3 <+15>: jmp    0x7fff869233ef            ; cerror_nocancel
    0x7fff869280b8 <+20>: retq</code></pre><p>ì£½ëŠ”ê±¸ í™•ì¸í–ˆìœ¼ë‹ˆ ì–´ë””ì—ì„œ ì£½ì—ˆë‚˜ ì½œìŠ¤íƒì„ ì°ì–´ë´…ì‹œë‹¤.
<code>thread backtrace</code> ë¥¼ ì´ìš©í•˜ë©´ ë³¼ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¤„ì—¬ì„œ <code>bt</code> ë¥¼ ì“¸ìˆ˜ë„
ìˆìŠµë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ lldb ëª…ë ¹ì–´ëŠ” ì¤„ì—¬ì„œ ì“°ëŠ”ê²Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p><pre class=markdown-textblock><code>(lldb) bt
* thread #1: tid = 0x13ca2, 0x00007fff869280ae libsystem_kernel.dylib`__pthread_kill + 10,...
  * frame #0: 0x00007f... libsystem_kernel.dylib`__pthread_kill + 10
    frame #1: 0x00007f... libsystem_pthread.dylib`pthread_kill + 90
    frame #2: 0x00007f... libsystem_c.dylib`abort + 129
    frame #3: 0x00007f... libsystem_malloc.dylib`free + 425
    frame #4: 0x000000... a.out`ScriptEngine::~ScriptEngine(this=0x00007f...) + 47 at main.cpp:72
    frame #5: 0x000000... a.out`ScriptEngine::~ScriptEngine(this=0x00007f...) + 21 at main.cpp:70
    frame #6: 0x000000... a.out`main(argc=2, argv=0x00007fff5fbff1c8) + 197 at main.cpp:55
    frame #7: 0x00007f... libdyld.dylib`start + 1
    frame #8: 0x00007f... libdyld.dylib`start + 1
(lldb)</code></pre><p>ì½œìŠ¤íƒì„ ì°ì–´ë³´ë‹ˆ frame #4ì— <code>ScriptEngine::~ScriptEngine()</code> ê°€
ë“¤ì–´ìˆìŠµë‹ˆë‹¤. ì†Œë©¸ì ì•ˆì—ì„œ í”„ë¡œê·¸ë¨ì´ ì£½ì—ˆìŠµë‹ˆë‹¤.</p><p>???</p><h3 id=ì†Œë©¸ìì—ì„œ-ì£½ëŠ”ë‹¤>ì†Œë©¸ìì—ì„œ ì£½ëŠ”ë‹¤?</h3><p>ì†Œë©¸ìì—ì„œ ì£½ëŠ” ê²½ìš°ëŠ” ê·¸ë ‡ê²Œ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤. ì–´ë””ì—ì„ ê°€ vtable (ê°€ìƒ
í•¨ìˆ˜ í…Œì´ë¸”)ì„ ê±´ë“œë ¤ì„œ ì£½ëŠ” ê²½ìš°ë„ ìˆìŠµë‹ˆë‹¤ë§Œ ì˜ˆì œ ì½”ë“œì—ëŠ” virtualì´
ì—†ê¸° ë•Œë¬¸ì— vtable ë¡œ ì¸í•œ ë¬¸ì œëŠ” ì—†ì„ê²ë‹ˆë‹¤.</p><p>ê·¸ë ‡ë‹¤ë©´ ì–´ë–¤ ë¬¸ì œê°€ ë‚¨ì•„ìˆì„ê¹Œìš”? ì£½ì€ ì§€ì ì„ ì¡°ê¸ˆë” ìì„¸íˆ ë´…ì‹œë‹¤.
ì½ì„ ìˆ˜ ìˆëŠ” ì½”ë“œ ì¤‘ì—ì„œ <code>main.cpp:72</code> ê°€ ê°€ì¥ ìœ„ì— ìˆìŠµë‹ˆë‹¤. 72ë²ˆì§¸ ì¤„
ì½”ë“œì˜ ë‚´ìš©ì€ ì†Œë©¸ìì˜ <code>}</code> ì…ë‹ˆë‹¤. ì†Œë©¸ìì˜ ê°€ì¥ ë§ˆì§€ë§‰ì—ì„œ ë¬¸ì œê°€
ìƒê¸´ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. ê°ì²´ê°€ ì†Œë©¸ë ë•Œ ë©¤ë²„ ë³€ìˆ˜ë¥¼ ì •ë¦¬í•˜ëŠ” ê²ƒë„ ì†Œë©¸ìì˜
ì—­í• ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ì´ ê³¼ì •ì¤‘ì— ë¬¸ì œê°€ ìƒê¸´ê±° ì•„ë‹ê¹Œìš”?</p><h3 id=ì†Œë©¸ìì—ì„œ-ì£½ëŠ”-ì§€ì -ë¶„ì„>ì†Œë©¸ìì—ì„œ ì£½ëŠ” ì§€ì  ë¶„ì„</h3><p>ScriptEngineì—ì„œ ê°ì²´ë¡œ ëœ ë©¤ë²„ ë³€ìˆ˜ê°€ <code>filename_</code> í•˜ë‚˜ë¿ì…ë‹ˆë‹¤.
ë‚˜ë¨¸ì§€ëŠ” ë©¤ë²„ ë³€ìˆ˜ëŠ” primitive data typeì´ê¸° ë•Œë¬¸ì— ì†Œë©¸ìë¡œ ë¬¸ì œê°€ ìƒê¸¸
ì—¬ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p><p>ì£½ì€ ì‹œì ì˜ <code>filename_</code> ì˜ ê°’ì„ í™•ì¸í•´ë´…ì‹œë‹¤. btë¡œ ë³´ì•˜ì„ë•Œ í˜„ì¬ ìŠ¤íƒ
í”„ë ˆì„ì€ 0ì…ë‹ˆë‹¤. <code>filename_</code> ë¡œ ì ‘ê·¼í•˜ê¸° ìœ„í•´ì„œ 4ë²ˆ ìŠ¤íƒ í”„ë ˆì„ìœ¼ë¡œ
ë°”ê¾¸ê³  ê°’ì„ í™•ì¸í•´ë´…ì‹œë‹¤. <code>frame select 4</code> ë¡œ í”„ë ˆì„ì„ ì„ íƒí• ìˆ˜ ìˆê³ 
<code>p filename_</code> ë¡œ ë³€ìˆ˜ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><pre class=markdown-textblock><code>(lldb) frame select 4
frame #4: 0x000000010... a.out`ScriptEngine::~ScriptEngine(this=0x00007f...) + 47 at main.cpp:72
   69   ScriptEngine::~ScriptEngine()
   70  {
   71     close();
-> 72   }
   73
   74   void ScriptEngine::open()
   75   {
(lldb) p filename_
(std::__1::string) $0 = ""</code></pre><p>???</p><p><code>filename_</code> ì˜ ê°’ì€ ìƒì„±ìì—ì„œ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ì´ë¦„ì„ ì €ì¥í•œ ì´í›„
ê±´ë“œë¦°ì ì´ ì—†ëŠ”ë° ë°”ë€Œì–´ìˆìŠµë‹ˆë‹¤. ì½”ë“œì—ì„œë„ <code>filename_</code> ë¥¼ ê±´ë“œë¦°ì ì€
ì—†ìŠµë‹ˆë‹¤. ë²„í¼ ì˜¤ë²„í”Œë¡œìš°(buffer overflow), ë²„í¼ ì˜¤ë²„ëŸ°(buffer
overrun)ì´ ë°œìƒí•´ì„œ ì˜ë„í•˜ì§€ ì•Šê²Œ <code>filename_</code> ê°€ ë°”ë€ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.
ë¬¸ì œì˜ ì›ì¸ì€ ì°¾ì€ê±° ê°™ìœ¼ë‹ˆ ì–´ë””ì—ì„œ ëˆ„ê°€ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ì¼ìœ¼ì¼°ëŠ”ì§€
í™•ì¸í•´ë´…ì‹œë‹¤.</p><h3 id=watchpoint-ì´ìš©í•´ì„œ-ë²„í¼-ì˜¤ë²„í”Œë¡œìš°-ì°¾ê¸°>watchpoint ì´ìš©í•´ì„œ ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ì°¾ê¸°</h3><p><code>filename_</code> ì˜ ê°’ì´ ë°”ë€ŒëŠ” ìˆœê°„ì„ ì°¾ì„ ìˆ˜ ìˆìœ¼ë©´ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ê°€
ë°œìƒí•œ ì‹œì ì„ ì•Œ ìˆ˜ ìˆì„ê²ë‹ˆë‹¤. watchpoint ëª…ë ¹ì„ ì´ìš©í•˜ë©´ íŠ¹ì • ì£¼ì†Œê°’ì„
ê°ì‹œí•˜ê³  ìˆë‹¤ ê°’ì´ ë°”ë€ŒëŠ” ìƒí™©ì— ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ê°€ ê±¸ë¦½ë‹ˆë‹¤.</p><p>ìƒì„±ìì— ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ë¥¼ ê±¸ì–´ë‘ê³  í”„ë¡œê·¸ë¨ì„ ë‹¤ì‹œ ì‹¤í–‰í•©ë‹ˆë‹¤. ë¸Œë ˆì´í¬
í¬ì¸íŠ¸ëŠ” <code>b main.cpp:62</code> ë¡œ ê±¸ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆì œì—ì„œëŠ” íŒŒì¼ì´ í•˜ë‚˜ë¿ì´ê¸°
ë•Œë¬¸ì— <code>b 62</code> ë¡œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p><pre class=markdown-textblock><code>(lldb) b 62
Breakpoint 1: where = a.out`ScriptEngine::ScriptEngine(char const*) + 275 at main.cpp:62,...
(lldb) process launch -- long.txt
There is a running process, kill it and restart?: [Y/n] y
Process 7611 exited with status = 9 (0x00000009)
Process 7625 launched: '.../a.out' (x86_64)
Process 7625 stopped
* thread #1: tid = 0x.... a.out`ScriptEngine::ScriptEngine(...) + 275 at main.cpp:62..
    frame #0: 0x000... a.out`ScriptEngine::ScriptEngine(...) + 275 at main.cpp:62
   59   ScriptEngine::ScriptEngine(const char *filename)
   60     : curr_pos_(0), filename_(filename), data_(nullptr), length_(-1), fd_(-1)
   61   {
-> 62     std::fill(cmd_, cmd_ + sizeof(cmd_), 0);
   63     std::fill(name_, name_ + sizeof(name_), 0);
   64     std::fill(text_, text_ + sizeof(text_), 0);
   65
(lldb)</code></pre><p>lldbì—ì„œëŠ” <code>watchpoint set variable this->length_</code> ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë©¤ë²„
ë³€ìˆ˜ì— watchpointë¥¼ ê±¸ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><pre class=markdown-textblock><code>(lldb) watchpoint set variable this->length_
Watchpoint created: Watchpoint 1: addr = 0x7f... size = 4 state = enabled type = w
    watchpoint spec = 'this->length_'
    new value: -1</code></pre><p>ê·¸ë ‡ë‹¤ë©´ <code>watchpoint set variable this->filename_</code> ë¡œ <code>filename_</code> ì—
watchpointë¥¼ ê±¸ë©´ ë˜ê² êµ°ìš”!</p><pre class=markdown-textblock><code>(lldb) watchpoint set variable this->filename_
error: Watchpoint creation failed (addr=0x7f..., size=24, variable expression='this->filename_').
error: watch size of 24 is not supported</code></pre><p>ëŠ” ì•ˆë©ë‹ˆë‹¤. ê·¸ë˜ë„ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ watchpointë¥¼ ê±¸ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë©¤ë²„
ë³€ìˆ˜ì— watchpointë¥¼ ê±°ëŠ”ê²Œ ì•ˆëœë‹¤ë©´ ë©¤ë²„ ë³€ìˆ˜ì˜ ì£¼ì†Œì— watchpointë¥¼
ê±¸ë©´ë©ë‹ˆë‹¤. ì£¼ì†Œê°’ìœ¼ë¡œ watchpointë¥¼ ì¶”ê°€í• ë•ŒëŠ” variableëŒ€ì‹  expressionê°€
ë“¤ì–´ê°‘ë‹ˆë‹¤.</p><pre class=markdown-textblock><code>(lldb) watchpoint set expression -- (void*)(&(this->filename_))
Watchpoint created: Watchpoint 3: addr = 0x7f... size = 8 state = enabled type = w
new value: 0x78742e676e6f6c10</code></pre><p>watchpointë¥¼ ê±¸ì—ˆìœ¼ë‹ˆ í”„ë¡œê·¸ë¨ì„ ì§„í–‰ì‹œí‚¤ê³  ì–´ë””ì—ì„œ ë©”ëª¨ë¦¬ ì¹¨ë²”í–ˆëŠ”ì§€
í™•ì¸í•´ë´…ì‹œë‹¤.</p><pre class=markdown-textblock><code>(lldb) c
Process 7661 resuming
Process 7661 stopped
* thread #1: tid = 0x175d8, 0x00007fff8e20efb1 libsystem_platform.dylib`_platform_memmove$VARI...
    frame #0: 0x00007fff8e20efb1 libsystem_platform.dylib`_platform_memmove$VARIANT$Haswell + 145
libsystem_platform.dylib`_platform_memmove$VARIANT$Haswell:
->  0x7fff8e20efb1 <+145>: movups %xmm4, (%rdi,%rdx)
    0x7fff8e20efb5 <+149>: popq   %rbp
    0x7fff8e20efb6 <+150>: retq
    0x7fff8e20efb7 <+151>: subq   $0x8, %rdx

Watchpoint 1 hit:
old value: 0x78742e676e6f6c10
new value: 0x78742e67706f6e6d</code></pre><p>watchpointê°€ ë©”ëª¨ë¦¬ ì¹¨ë²”í•˜ëŠ” ìˆœê°„ì„ ì¡ì•˜ìŠµë‹ˆë‹¤. ìŠ¤íƒ í”„ë ˆì„ì„ ë´…ì‹œë‹¤.</p><pre class=markdown-textblock><code>(lldb) bt
* thread #1: tid = 0x175d8, 0x00007fff8e20efb1 libsystem_platform.dylib`_platform_memm...
  * frame #0: 0x.. libsystem_platform.dylib`_platform_memmove$VARIANT$Haswell + 145
    frame #1: 0x.. a.out`ScriptEngine::parseLine(this=0x0.., has_next=0x0..) + 495 at main.cpp:143
    frame #2: 0x.. a.out`main(argc=2, argv=0x00007fff5fbff1c8) + 127 at main.cpp:52
    frame #3: 0x.. libdyld.dylib`start + 1
    frame #4: 0x.. libdyld.dylib`start + 1</code></pre><p>frame #1, <code>ScriptEngine::parseLine()</code>, 143ë²ˆì§¸ ì¤„ì´ ì‚¬ê³ ì³¤ìŠµë‹ˆë‹¤.
ì´ì§€ì ì— ë­ê°€ ìˆì„ê¹Œìš”? <code>l 143</code> ì„ ì´ìš©í•´ì„œ ì½”ë“œë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><pre class=markdown-textblock><code>(lldb) l 143
143            memcpy(cmd.buffer, buffer, len);
...</code></pre><p>memcpyê°€ ë¬¸ì œë¥¼ ì¼ìœ¼ì¼°ìŠµë‹ˆë‹¤.</p><h3 id=ì •í™•íˆ-ì–´ë–¤-ìƒí™©ì—ì„œ-ë¬¸ì œê°€-ë°œìƒí–ˆëŠ”ê°€>ì •í™•íˆ ì–´ë–¤ ìƒí™©ì—ì„œ ë¬¸ì œê°€ ë°œìƒí–ˆëŠ”ê°€?</h3><p>ì–´ë–¤ê°’ì´ memcpyë¡œ ë“¤ì–´ê°”ì„ë•Œ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ì¼ìœ¼ì¼°ì„ê¹Œìš”? memcpyê°€
í˜¸ì¶œë˜ê¸° ì§ì „ì— ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ë¥¼ ê±¸ì–´ë‘ê³  <code>buffer</code> ì— ë”°ë¼ì„œ
<code>filename_</code> ê°€ ì–´ë–»ê²Œ ë°”ë€Œë‚˜ í™•ì¸í•´ë´…ì‹œë‹¤.</p><pre class=markdown-textblock><code>(lldb) b 143
Breakpoint 3: where = a.out`ScriptEngine::parseLine(bool*) + 462 at main.cpp:143, ...
....
(lldb) c
...
   142            memset(cmd.buffer, 0, cmd.buffer_size);
-> 143            memcpy(cmd.buffer, buffer, len);
...
(lldb) p buffer
(char [1024]) $5 = "abcdefghijklmnopqrstuvwxyz123456"
(lldb) p this->filename_
(std::__1::string) $6 = "long.txt"
(lldb) n
...
-> 145            parse_state = cmd.next_state;
...
(lldb) p this->filename_
(std::__1::string) $7 = ""</code></pre><p>long.txtì˜ ì²«ì¤„ì˜ textì— í•´ë‹¹í•˜ëŠ” <code>abcdefghijklmnopqrstuvwxyz123456</code> ë¥¼
<code>text_</code> ë¡œ ë³µì‚¬í• ë•Œ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì™œ ë¬¸ì œê°€ ë˜ëŠ”ì§€
ì½”ë“œë¥¼ ì½ì–´ë´…ì‹œë‹¤.</p><pre><code class="language-cpp line-numbers">  char text_[8];

  // raw script content
  std::string filename_;</code></pre><p><code>text_</code> ì˜ í¬ê¸°ëŠ” 8ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ë³µì‚¬í•˜ë ¤ëŠ” textì˜ í¬ê¸°ëŠ” ì´ë³´ë‹¤ í›¨ì”¬
í½ë‹ˆë‹¤. ê·¸ë˜ì„œ <code>text_</code> ì˜ ë‹¤ìŒì— ìˆëŠ” ë©¤ë²„ë³€ìˆ˜ <code>filename_</code> ì˜ ë‚´ìš©ì„
ë®ì–´ì¨ë²„ë ¸ìŠµë‹ˆë‹¤.</p><h2 id=í•´ê²°ì±…íšŒí”¼>í•´ê²°ì±…/íšŒí”¼</h2><p>ë²„í¼ ì˜¤ë²„í”Œë¡œìš°, ë²„í¼ ì˜¤ë²„ëŸ°ì€ ë§ì´ ì•Œë ¤ì§„ ë²„ê·¸ì¸ ë™ì‹œì— ì°¾ê¸° ì–´ë ¤ìš´
ë²„ê·¸ì…ë‹ˆë‹¤. ì´ë¥¼ ë°©ì§€í•˜ëŠ” ë°©ë²•ì€ ë§ì´ ì•Œë ¤ì ¸ìˆê¸° ë•Œë¬¸ì— ì—¬ê¸°ì—ì„œëŠ” ì§ì ‘
ë‹¤ë£¨ì§€ ì•ŠìŠµë‹ˆë‹¤.</p><ul><li><a href=https://en.wikipedia.org/wiki/Buffer_overflow#Protective_countermeasures>Buffer overflow :: Protective countermeasures</a></li><li><a href=https://www.microsoft.com/korea/msdn/columns/contents/CodeSecure/secure05202002/default.aspx>ë²„í¼ ì˜¤ë²„ëŸ° í•´ê²°!</a></li><li><a href="https://msdn.microsoft.com/ko-kr/library/windows/desktop/ms717795%28v=vs.85%29.aspx">Avoiding Buffer Overruns</a></li><li><a href=http://maintainablecode.logdown.com/posts/159916-memcpy-memmove-and-memset-are-deprecated>memcpy, memmove, and memset are obsolete!</a></li></ul></div><div class=tags><a href=https://if1live.github.io/tags/lldb/>lldb</a>
<a href=https://if1live.github.io/tags/buffer-overflow/>buffer overflow</a>
<a href=https://if1live.github.io/tags/buffer-overrun/>buffer overrun</a>
<a href=https://if1live.github.io/tags/memory-bug/>memory bug</a>
<a href=https://if1live.github.io/tags/debug/>debug</a>
<a href=https://if1live.github.io/tags/debugging/>debugging</a>
<a href=https://if1live.github.io/tags/destructor/>destructor</a>
<a href=https://if1live.github.io/tags/postmortem/>postmortem</a></div><hr><div class=pagination><div class="left pagination-item"><a href=https://if1live.github.io/posts/golang-first-impression/>ğŸ¡° Go language ì²«ì¸ìƒ</a></div><div class="right pagination-item"><a href=https://if1live.github.io/posts/multiple-assignment-python-and-ruby/>ì˜ˆì œë¡œ ë³´ëŠ” Pythonê³¼ Rubyì˜ ë¬¸ë²• ì°¨ì´ - Multiple Assignment ğŸ¡²</a></div></div><div class=see-also><h2>See Also</h2><ul><li><a href=/posts/doge-math-post-mortem/>Doge Math ê°œë°œ í¬ìŠ¤íŠ¸ëª¨í…œ</a></li></ul></div><div id=comment><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//libsora.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></section></div><footer class=sora-footer><p><a href=//gohugo.io/ title=Hugo>Hugo</a> |
<a href=//twitter.com/if1live/ title=@if1live>@if1live</a></p></footer><script src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js integrity="sha512-BttltKXFyWnGZQcRWj6osIg7lbizJchuAMotOkdLxHxwt/Hyo+cl47bZU0QADg+Qt5DJwni3SbYGXeGMB5cBcw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-clike.min.js integrity="sha512-/Rynaa6ehLZJO9fdk+EUsgiOdJqFSFUB4Qgy+gP4vU4U1DrmPJWypfXe1CgyaV7rRdZjGxdpLe9djxhx1ZHvqQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js integrity="sha512-8VrjxGFLIkS0mgEmO3p46A5OkqATHhrNVwyv2V7yUeZrk1jmSDuI3SOEpC9XHEHUWEOsfzzcJeBlUkee9lKGrw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js integrity="sha512-namzGTZvHaug0jeipHRN2pMepMiJj+EbrloktVFlMYGnA0EwZhbdLeENjBYLCgoghVbZGinIz/FFYHmB0o3wLw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js integrity="sha512-uOw7XYETzS/DPmmirpP5UCMihSDNMeyTS965J0/456OSPfxn9xEtHHjj5Q/5WefVdqyMfN/afmQnNpZd/tpkcA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js integrity="sha512-AKaNmg8COK0zEbjTdMHJAPJ0z6VeNqvRvH4/d5M4sHJbQQUToMBtodq4HaV4fa+WV2UTfoperElm66c9/8cKmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js integrity="sha512-jwrwRWZWW9J6bjmBOJxPcbRvEBSQeY4Ad0NEXSfP0vwYi/Yu9x5VhDBl3wz6Pnxs8Rx/t1P8r9/OHCRciHcT7Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js integrity="sha512-xKcnbsdT0KMoA4yrozkqZM1XJVTrPsjdQwvigxlAlxEDu8YDvC/jl+LfVqn0fY3Vs6m2y4a89JCHEIA/Z9zpmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js integrity="sha512-pmt3kb6dRndjFXFFwCa3rSzuUQ0GjeCfC5QULWde+8ZBIsUzuP1heOIOSAMfAyXHSufrrTp8h7UHw85K4IJ2/g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js integrity="sha512-whYhDwtTmlC/NpZlCr6PSsAaLOrfjVg/iXAnC4H/dtiHawpShhT2SlIMbpIhT/IL/NrpdMm+Hq2C13+VKpHTYw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-ruby.min.js integrity="sha512-/Dti0iV9cxgJe8r0U/89YJIv9ZBQu1ExEWffVyBj4juMQ4GNglQ3TQ0Up4gcbiHvg0g87arcUFbKBtw2PxH1Dw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js integrity="sha512-w200Nz1i9KgDNi+IpPMgpZBVRIvfVK/V5vskyHjkz7XJkVnRJcb1uNmpiHhDv0/Ln+GG2VqScKKz/1izBfg64Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-less.min.js integrity="sha512-lL5HvfIycntK04Iiai/VTsyuj7mvDkhz9k+cA8fqXr932s4jLJ1YwplIs6Dhpw0pzVwAe1jGe8sGwbyuHG44QQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-scss.min.js integrity="sha512-aczOaJ+mB9uGT6dMJbDaUsS2PWG+XII+1ypFQ0L22Z132V6kMM6m70pQssXsPAFmLI5xkgx/hknBuUuJIJKZfA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js integrity="sha512-uMdVuOpm+9lNPCT7mV/YaMb9YQ/R4+eeON7aEMj6Ig/f4BoU+Q5k6iaZkDsX7LH9cjTHZt0CuKxbzd0/fndrWA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js integrity="sha512-QXFMVAusM85vUYDaNgcYeU3rzSlc+bTV4JvkfJhjxSHlQEo+ig53BtnGkvFTiNJh8D+wv6uWAQ2vJaVmxe8d3w==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js integrity="sha512-6O/PZimM3TD1NN3yrazePA4AbZrPcwt1QCGJrVY7WoHDJROZFc9TlBvIKMe+QfqgcslW4lQeBzNJEJvIMC8WhA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-batch.min.js integrity="sha512-tPgIjUKiv2HcUAIWXA3v6G4cNuWXkoMsF+ibxfHLnp+/s1C3Bw5/qp78+JjhrfoyWIiHXHx0LtH4M/LAwyQqWg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lisp.min.js integrity="sha512-W461RnQzrhSCQQMfEGFKOHbK2DuJTVxrXs2PzctPaxV3A+qPB/TcnMgucSsBNkyccNK8VoENBsAnbf/SuBE71g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin=anonymous></script>
<script>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]});for(var inlineMathArray=document.querySelectorAll("script[type='math/tex']"),inlineMath,tex,replaced,displayMathArray,displayMath,i=0;i<inlineMathArray.length;i++)inlineMath=inlineMathArray[i],tex=inlineMath.innerText||inlineMath.textContent,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex,{displayMode:!1}),inlineMath.parentNode.replaceChild(replaced,inlineMath);displayMathArray=document.querySelectorAll("script[type='math/tex; mode=display']");for(i=0;i<displayMathArray.length;i++)displayMath=displayMathArray[i],tex=displayMath.innerHTML,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex.replace(/%.*/g,""),{displayMode:!0}),displayMath.parentNode.replaceChild(replaced,displayMath)</script></body></html>