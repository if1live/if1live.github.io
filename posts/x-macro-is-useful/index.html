<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.116.1"><title>int main() { #include "data.txt" return 0; } - if1live space</title><meta name=author content="if1live"><meta name=title content="int main() { #include &#34;data.txt&#34; return 0; }"><meta name=description content="í‘ë§ˆë²•ì€ ë§ì´ ì§œë´¤ì§€ë§Œ int foo() { #include &ldquo;data.txt&rdquo; } ë¥¼ ì´ê¸¸ ë¬¼ê±´ì€ ì•„ì§ ì§œì§€ ëª»í–ˆë‹¤. ë‚´ ëª…ì‘ í‘ë§ˆë²•ì´ì—ˆëŠ”ë° ë¦¬í™í† ë§ í•˜ë ¤ë‹¤ c++ ì ‘ì–´ì„œ ë°©ì¹˜ íŠ¸ìœ„í„°ì—ì„œ ë‚¨ë“¤ì˜ í‘ë§ˆë²• ì½”ë“œë¥¼ ë³´ë‹¤ê°€"><meta name=keywords content="black magic,x-macro,define,include,c,preprocessor"><meta name=naver-site-verification content="2ddc1a56777489f4a64a4f6a59822f8b1c1ea502"><meta name=google-site-verification content="VsvNNnJZUV-iLEYKNju16p-HtDqZeqL15H-VVy-HwpA"><meta name=gc:client-id content="785d47c81cbc2fd42b65"><meta name=gc:client-secret content="5e5d558f0b16fae154aa47fc9d94f7c09e540ec7"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><script type=text/javascript>var host="if1live.github.io";host==window.location.host&&window.location.protocol!="https:"?window.location.protocol="https":console.log("skip https redirect")</script><link rel=stylesheet href=/css/style.ad6245cc6a90c30a30dba42b8bbe9be63bed9ea169e339d8ecfc6b9afc6eb8382bbd422b2d31dc71c3355c79f057ddcaa7e1ca96b5eb7f5f16a28a34e74051db.css integrity="sha512-rWJFzGqQwwow26Qri76b5jvtnqFp4znY7PxrmvxuuDgrvUIrLTHcccM1XHnwV93Kp+HKlrXrf18Wooo050BR2w=="><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css integrity="sha512-cbQXwDFK7lj2Fqfkuxbo5iD1dSbLlJGXGpfTDqbggqjHJeyzx88I3rfwjS38WJag/ihH7lzuGlGHpDBymLirZQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin=anonymous><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-3043297488880636",enable_page_level_ads:!0})</script><meta property="og:title" content="int main() { #include &#34;data.txt&#34; return 0; }"><meta property="og:description" content="í‘ë§ˆë²•ì€ ë§ì´ ì§œë´¤ì§€ë§Œ int foo() { #include &ldquo;data.txt&rdquo; } ë¥¼ ì´ê¸¸ ë¬¼ê±´ì€ ì•„ì§ ì§œì§€ ëª»í–ˆë‹¤. ë‚´ ëª…ì‘ í‘ë§ˆë²•ì´ì—ˆëŠ”ë° ë¦¬í™í† ë§ í•˜ë ¤ë‹¤ c++ ì ‘ì–´ì„œ ë°©ì¹˜ íŠ¸ìœ„í„°ì—ì„œ ë‚¨ë“¤ì˜ í‘ë§ˆë²• ì½”ë“œë¥¼ ë³´ë‹¤ê°€"><meta property="og:type" content="article"><meta property="og:url" content="https://if1live.github.io/posts/x-macro-is-useful/"><meta property="og:image" content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-01-30T00:00:00+00:00"><meta property="article:modified_time" content="2017-01-30T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta name=twitter:title content="int main() { #include &#34;data.txt&#34; return 0; }"><meta name=twitter:description content="í‘ë§ˆë²•ì€ ë§ì´ ì§œë´¤ì§€ë§Œ int foo() { #include &ldquo;data.txt&rdquo; } ë¥¼ ì´ê¸¸ ë¬¼ê±´ì€ ì•„ì§ ì§œì§€ ëª»í–ˆë‹¤. ë‚´ ëª…ì‘ í‘ë§ˆë²•ì´ì—ˆëŠ”ë° ë¦¬í™í† ë§ í•˜ë ¤ë‹¤ c++ ì ‘ì–´ì„œ ë°©ì¹˜ íŠ¸ìœ„í„°ì—ì„œ ë‚¨ë“¤ì˜ í‘ë§ˆë²• ì½”ë“œë¥¼ ë³´ë‹¤ê°€"><meta name=twitter:site content="@if1live"><script async src="https://www.googletagmanager.com/gtag/js?id=G-SKE54STL16"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SKE54STL16",{anonymize_ip:!1})}</script></head><body><nav class=sora-navigation><a href=/ title=home><h1>if1live space</h1></a><ul class=menu-button-list><li><a href=/posts title=archive><i class="fa-solid fa-box-archive"></i>
<span hidden>archive</span></a></li><li><a href=/tags title=tags><i class="fa-solid fa-tags"></i>
<span hidden>tags</span></a></li><li><a href=//github.com/if1live title=GitHub><i class="fa-brands fa-github"></i>
<span hidden>GitHub</span></a></li><li><a href=/about title=about><i class="fa-solid fa-info"></i>
<span hidden>about</span></a></li><li><a href=https://if1live.github.io/index.xml title=RSS><i class="fa-solid fa-rss"></i>
<span hidden>RSS</span></a></li></ul></nav><div class=main><section id=single><h1 class=title><span>int main() { #include "data.txt" return 0; }</span><br><small>ë‹¤ì‹œ ë³´ëŠ” includeì™€ define, ê·¸ë¦¬ê³  X-Macro</small></h1><div class=tip><time datetime="2017-01-30 00:00:00 +0000 UTC">2017. 01. 30</time></div><div class=content><blockquote><p>í‘ë§ˆë²•ì€ ë§ì´ ì§œë´¤ì§€ë§Œ</p><p>int foo() {
#include &ldquo;data.txt&rdquo;
}</p><p>ë¥¼ ì´ê¸¸ ë¬¼ê±´ì€ ì•„ì§ ì§œì§€ ëª»í–ˆë‹¤. ë‚´ ëª…ì‘ í‘ë§ˆë²•ì´ì—ˆëŠ”ë° ë¦¬í™í† ë§ í•˜ë ¤ë‹¤ c++ ì ‘ì–´ì„œ ë°©ì¹˜</p></blockquote><p>íŠ¸ìœ„í„°ì—ì„œ ë‚¨ë“¤ì˜ í‘ë§ˆë²• ì½”ë“œë¥¼ ë³´ë‹¤ê°€ 5ë…„ì „ì— ì§  í‘ë§ˆë²• ì½”ë“œê°€ ìƒê°ë‚˜ì„œ ê¸€ì„ ì¨ë³¸ë‹¤.
C, C++ ë§ì´ í•´ë³¸ ì‚¬ëŒì€ ë‹¤ ì•Œê³ ìˆì„ ë»”í•œ ì£¼ì œë‹¤.
í•˜ì§€ë§Œ ì²˜ìŒí•˜ëŠ” ì‚¬ëŒì€ ê¸€ì„ ì½ê³  include, defineì— ëŒ€í•œ ìƒˆë¡œìš´ ê´€ì ì„ ë°°ìš¸ ìˆ˜ ìˆì„ê±°ë‹¤.</p><h2 id=ë‹¤ì‹œ-ë³´ëŠ”-include>ë‹¤ì‹œ ë³´ëŠ” include</h2><p>Cì»´íŒŒì¼ëŸ¬ëŠ” í•˜ë‚˜ì˜ ì†ŒìŠ¤ë§Œ ì½ê³  ì»´íŒŒì¼í•  ìˆ˜ ìˆë‹¤.
ê·¼ë° ìš°ë¦¬ëŠ” stdio.h ê°™ì€ íŒŒì¼ì„ main.cì—ì„œ ì“°ì–ì•„?
Cì „ì²˜ë¦¬ê¸°ê°€ <code>#include &lt;stdio.h></code>ë¥¼ ì°¾ì•„ì„œ stdio.hì˜ ë‚´ìš©ì„ main.cì— ë³µì‚¬-ë¶™ì—¬ë„£ê¸°í•´ì„œ í•˜ë‚˜ì˜ íŒŒì¼ë¡œ ë§Œë“ í›„, ì´ë¥¼ ì»´íŒŒì¼ëŸ¬ì—ê²Œ ì „ë‹¬í•˜ê¸°ë•Œë¬¸ì— ì»´íŒŒì¼ì´ ë˜ëŠ”ê±°ë‹¤.
ì¦‰, includeì˜ ì—­í• ì€ <strong>ë³µë¶™</strong>ì´ë‹¤.</p><h2 id=ë‹¤ì‹œ-ë³´ëŠ”-define>ë‹¤ì‹œ ë³´ëŠ” define</h2><p>C ì „ì²˜ë¦¬ê¸°ì˜ ëª…ë ¹ì–´ ì¤‘ì—ëŠ” defineì´ ìˆë‹¤.
ì´ˆê¸‰ C í•™ìŠµì„œì—ì„œëŠ” defineì„ ë§¤í¬ë¡œ ìƒìˆ˜, ë§¤í¬ë¡œ í•¨ìˆ˜ë¥¼ ë§Œë“¤ë•Œ ì‚¬ìš©í•œë‹¤ê³  ì„¤ëª…í•œë‹¤.
ì´ ì„¤ëª…ì€ defineë¡œ ê°€ëŠ¥í•œê²ƒì„ ì„¤ëª…í•œê±°ì§€ defineì˜ ì§„ì§œ ê¸°ëŠ¥ì„ ë§í•œê²Œ ì•„ë‹ˆë‹¤.
defineì˜ ì§„ì§œ ê¸°ëŠ¥ì€ <strong>ì¹˜í™˜</strong>ì´ë‹¤.</p><p>ê·¸ë˜ì„œ ì•„ë˜ì™€ ê°™ì€ ì½”ë“œê°€ ê°€ëŠ¥í•˜ë‹¤.
cocos2d-xì— ìˆëŠ” ì½”ë“œì¸ë° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì—´ê³  ë‹«ëŠ” ì½”ë“œë¥¼ ì§ì ‘ ì“°ì§€ ì•Šê³  ë§¤í¬ë¡œë¡œ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•œë‹¤.</p><pre><code class="language-cpp line-numbers">#ifdef __cplusplus
    #define NS_CC_BEGIN  namespace cocos2d {
    #define NS_CC_END    }
    #define USING_NS_CC  using namespace cocos2d
    #define NS_CC        ::cocos2d
#else
    #define NS_CC_BEGIN 
    #define NS_CC_END 
    #define USING_NS_CC 
    #define NS_CC
#endif </code></pre><h2 id=x-macro>X-Macro</h2><p><a href=https://en.wikipedia.org/wiki/X_Macro>X-Macro</a>ëŠ” ë§¤í¬ë¡œë¡œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“ í›„ ë‹¤ì–‘í•œ ë§¤í¬ë¡œë¥¼ ì ìš©í•´ì„œ ì½”ë“œë¥¼ ì°ì–´ë‚´ëŠ” ê¸°ë²•ì´ë‹¤.
ì´ë¥¼ ì´ìš©í•˜ë©´ ë…¸ê°€ë‹¤ ì½”ë”©ì„ ì¤„ì´ëŠ”ê²Œ ê°€ëŠ¥í•˜ë‹¤.
ë§ë¡œ ì„¤ëª…í•˜ëŠ”ê²ƒë³´ë‹¤ ì½”ë“œë¥¼ ë³´ëŠ”ê²Œ ì´í•´í•˜ê¸° ì‰¬ìš¸ê±°ë‹¤.
wikipediaì˜ ì˜ˆì œì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ê°€ì ¸ì™”ë‹¤.</p><pre><code class="language-cpp line-numbers">#define LIST_OF_VARIABLES \
    X(value1) \
    X(value2) \
    X(value3)

#define X(name) int name;
LIST_OF_VARIABLES
#undef X

void print_variables()
{
#define X(name) printf(&#34;%s = %d\n&#34;, #name, name);
LIST_OF_VARIABLES
#undef X
}</code></pre><pre><code class="language-cpp line-numbers">int value1;
int value2;
int value3;

void print_variables()
{
    printf(&#34;%s = %d\n&#34;, &#34;value1&#34;, value1);
    printf(&#34;%s = %d\n&#34;, &#34;value2&#34;, value2);
    printf(&#34;%s = %d\n&#34;, &#34;value3&#34;, value3);
}</code></pre><h2 id=ì˜ˆì œ>ì˜ˆì œ</h2><p>ê°„ë‹¨í•œ ì˜ˆì œ ì½”ë“œë¥¼ ë§Œë“¤ì–´ë´¤ë‹¤. í•„ìš”í•œ ê¸°ëŠ¥ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ul><li>í´ë˜ìŠ¤ì—ëŠ” month, day ë©¤ë²„ ë³€ìˆ˜ê°€ ìˆì–´ì•¼í•œë‹¤.</li><li>ë¹ˆ ê°ì²´ë¥¼ ìƒì„±í•˜ë©´ 1, 1ë¡œ ì´ˆê¸°í™” ë˜ì–´ì•¼í•œë‹¤.</li><li>month, dayë¥¼ 1, 1ë¡œ ì´ˆê¸°í™”í•˜ëŠ” <code>reset_date()</code> í•¨ìˆ˜ê°€ í•„ìš”í•˜ë‹¤</li><li>ë©¤ë²„ë³€ìˆ˜ì˜ ê°’ì„ ì¶œë ¥í•˜ëŠ” <code>print_date()</code> í•¨ìˆ˜ê°€ í•„ìš”í•˜ë‹¤.</li></ul><pre><code class="language-cpp line-numbers">#include &lt;cstdio&gt;

struct DateSimple {
    int month = 1;
    int day = 1;
};

void reset_date(DateSimple &amp;obj) {
    obj.month = 1;
    obj.day = 1;
}

void print_date(DateSimple &amp;obj) {
    printf(&#34;M: %d\n&#34;, obj.month);
    printf(&#34;D: %d\n&#34;, obj.day);
}

int main() {
    DateSimple d = {2, 5};
    print_date(d);

    reset_date(d);
    print_date(d);
    return 0;
}</code></pre><pre><code class="language-bash line-numbers">$ g&#43;&#43; -o main_simple.exe main_simple.cpp -std=c&#43;&#43;14 &amp;&amp; ./main_simple.exe
M: 2
D: 5
M: 1
D: 1</code></pre><p>ì½”ë“œë¥¼ ì˜ ë³´ë©´ ì¤‘ë³µëœ ë¶€ë¶„ì´ ìˆë‹¤.</p><ul><li>í´ë˜ìŠ¤ì˜ ê¸°ë³¸ê°’ì¸ 1,1ì´ í´ë˜ìŠ¤ ì•ˆì—ë„ ìˆì§€ë§Œ reset_dateì—ë„ ìˆë‹¤.</li><li>month, day ë³€ìˆ˜ëŠ” ì´ 3ë²ˆ ë“±ì¥í•œë‹¤. í´ë˜ìŠ¤, reset_date, print_date</li></ul><p>ì˜ˆì œëŠ” ë³€ìˆ˜ê°€ ê³ ì‘ 2ê°œë°–ì— ì—†ìœ¼ë‹ˆê¹Œ ì¤‘ë³µì´ ì‹¬ê°í•œ ë¬¸ì œëŠ” ì•„ë‹ˆë‹¤.
í•˜ì§€ë§Œ ë³€ìˆ˜ì˜ ê°¯ìˆ˜ê°€ ë§ì•„ì§€ë§Œ ì´ëŸ° ì‚¬ì†Œí•œ ì¤‘ë³µë„ ìœ ì§€ë³´ìˆ˜ë¥¼ ê·€ì°®ê²Œ ë§Œë“ ë‹¤.</p><p>ì—¬ê¸°ì— X-Macroë¥¼ ë¼ì–¹ì–´ë³´ì.</p><p>ì¼ë‹¨ì€ ë§¤í¬ë¡œë¡œ ê°„ë‹¨í•œ ë©”íƒ€ ì–¸ì–´ë¥¼ ë§Œë“¤ì.
ê·¸ë¦¬ê³  ë©”íƒ€ ì–¸ì–´ë¥¼ ì´ìš©í•´ì„œ í´ë˜ìŠ¤ë¥¼ ì •ì˜í•´ë³´ì.
ì´ëŸ° ëŠë‚Œì´ë©´ ë ê±°ë‹¤.</p><pre><code class="language-txt line-numbers">STRUCT_BEGIN(Date)
    STRUCT_INT(month, 1, &#34;M: &#34;)
    STRUCT_INT(day, 1, &#34;D: &#34;)
STRUCT_END()</code></pre><p>ì½”ë“œ ì¤‘ë³µì´ ë“±ì¥í•˜ë˜ ë¶€ë¶„ì— X-Macroë¥¼ ë¼ì›Œë„£ì.</p><pre><code class="language-cpp line-numbers">#include &lt;cstdio&gt;

#undef STRUCT_BEGIN
#undef STRUCT_INT
#undef STRUCT_END

#define STRUCT_BEGIN(NAME) struct NAME {
#define STRUCT_INT(NAME, VALUE, LABEL) int NAME = VALUE;
#define STRUCT_END() };

#include &#34;struct_data.txt&#34;

void reset_date(Date &amp;obj) {
    #undef STRUCT_BEGIN
    #undef STRUCT_INT
    #undef STRUCT_END

    #define STRUCT_BEGIN(NAME)
    #define STRUCT_INT(NAME, VALUE, LABEL) obj.NAME = VALUE;
    #define STRUCT_END()

    #include &#34;struct_data.txt&#34;
}


void print_date(Date &amp;obj) {
    #undef STRUCT_BEGIN
    #undef STRUCT_INT
    #undef STRUCT_END

    #define STRUCT_BEGIN(NAME)
    #define STRUCT_INT(NAME, VALUE, LABEL) printf(LABEL &#34;%d\n&#34;, obj.NAME);
    #define STRUCT_END()

    #include &#34;struct_data.txt&#34;
}

int main() {
    Date d = {2, 5};
    print_date(d);

    reset_date(d);
    print_date(d);
    return 0;
}</code></pre><pre><code class="language-bash line-numbers">$ g&#43;&#43; -o main_xmcaro.exe main_xmacro.cpp -std=c&#43;&#43;14 &amp;&amp; ./main_xmcaro.exe
M: 2
D: 5
M: 1
D: 1</code></pre><p>ì´ì œ í´ë˜ìŠ¤ì— ë©¤ë²„ë³€ìˆ˜ê°€ ìˆ˜ì‹­ê°œê°€ ë˜ì–´ë„ ì¤‘ë³µìœ¼ë¡œ ê³ ì¹  ë¶€ë¶„ì€ ì—†ë‹¤.
ë©”íƒ€ ì–¸ì–´ë¡œ ì„ ì–¸ëœ í´ë˜ìŠ¤ë§Œ ê³ ì¹˜ë©´ ëœë‹¤.</p><h2 id=ì‘ìš©>ì‘ìš©</h2><ul><li>ë§¤í¬ë¡œë¥¼ ì˜ ì´ìš©í•˜ë©´ ë©”íƒ€ ì–¸ì–´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì„ê±°ê°™ì€ë°?</li><li>ë§¤í¬ë¡œë¥¼ êµì²´í•˜ë©´ ì—¬ëŸ¬ ì¢…ë¥˜ì˜ ì½”ë“œë¥¼ ì°ì–´ë‚¼ ìˆ˜ ìˆì„ê±°ê°™ì€ë°?</li></ul><p>ì´ë¥¼ ì´ìš©í•´ì„œ 5ë…„ì „ì— ì¬ë°ŒëŠ” ì½”ë“œë¥¼ ì§ ì ì´ ìˆë‹¤.</p><ul><li>ë§¤í¬ë¡œë¡œ í‘œí˜„ ê°€ëŠ¥í•œ ë©”íƒ€ ì–¸ì–´ë¥¼ ì„¤ê³„. ì´ ì–¸ì–´ë¡œëŠ” êµ¬ì¡°ì²´ë¥¼ í‘œí˜„í• ìˆ˜ ìˆë‹¤.</li><li>ë§¤í¬ë¡œë¥¼ ì˜ ì´ìš©í•´ì„œ êµ¬ì¡°ì²´ ì½”ë“œë¥¼ ì°ì–´ë‚¸ë‹¤.</li><li>ë§¤í¬ë¡œë¥¼ ì˜ ì´ìš©í•´ì„œ RTTI(Run-Time Type Information)ë¥¼ êµ¬í˜„í•œë‹¤.</li><li>RTTI ì •ë³´ë¥¼ ì˜ ì´ìš©í•´ì„œ êµ¬ì¡°ì²´ë¥¼ XMLë¡œ ì§ë ¬í™”, ì—­ì§ë ¬í™”í•œë‹¤.</li></ul><p><a href=https://github.com/if1live/hikaru>hikaru</a> : Simple C++ RTTI library</p><p>ì˜›ë‚ ì˜›ì  ì½”ë“œì—ì„œ ë§¤í¬ë¡œë¥¼ ì´ìš©í•œ ë¶€ë¶„ì„ ëœ¯ì–´ë‚¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.
X-Macro ê°€ ì–´ë–¤ ë¬¼ê±´ì¸ì§€ ë³µìŠµí•˜ë©´ì„œ ëŒì•„ê°€ë„ë¡ ë§Œë“¤ì—ˆë‹¤.
(5ë…„ ë¬µì€ ì½”ë“œ ì‚´ë ¤ë‘”ê±°ë¼ì„œ ì“°ëŠ”ê±¸ ê¶Œì¥í•˜ì§„ ì•ŠëŠ”ë‹¤)
ëŒ€ê°• ì´ëŸ° ëŠë‚Œìœ¼ë¡œ ì“´ë‹¤.</p><p>ë§¤í¬ë¡œ ìœ„ì—ì„œ ëŒì•„ê°ˆìˆ˜ ìˆëŠ” ë©”íƒ€ ì–¸ì–´ë¥¼ ì •ì˜í•œë‹¤.
ê·¸ë¦¬ê³  ì´ ë©”íƒ€ ì–¸ì–´ë¥¼ ì´ìš©í•´ì„œ ì´ìš©í•´ì„œ í´ë˜ìŠ¤ì˜ êµ¬ì¡°ë¥¼ ëª…ì‹œí•œë‹¤.
í´ë˜ìŠ¤ ì´ë¦„ì€ HKDemoStruct, ë²„ì „ì€ 1ì´ë‹¤.
(ê°™ì€ ì´ë¦„ì˜ ë²„ì „ì´ ë‹¤ë¥¸ í´ë˜ìŠ¤ì˜ ê²½ìš° migration êµ¬í˜„í•˜ëŠ”ê²Œ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„)
ì´ í´ë˜ìŠ¤ì—ëŠ” float íƒ€ì…ì˜ ë³€ìˆ˜ <code>float_val</code>ê³¼ int íƒ€ì…ì˜ ë³€ìˆ˜ <code>int_val</code>ì´ í¬í•¨ëœë‹¤.</p><pre><code class="language-cpp line-numbers">HK_STRUCT_BEGIN(HKDemoStruct, 1)
    HK_STRUCT_VAR_FLOAT(float_val)
    HK_STRUCT_VAR_INT(int_val)
HK_STRUCT_END()</code></pre><p>ì„ ì–¸ìš© ë§¤í¬ë¡œë¥¼ ì´ìš©í•´ì„œ ë©”íƒ€ ì–¸ì–´ë¥¼ í´ë˜ìŠ¤ë¥¼ ë§Œë“ ë‹¤.</p><pre><code class="language-cpp line-numbers">#define HK_STRUCT_BEGIN(BASE, VERSION)  \
    struct BASE##_##VERSION : public hikaru::BaseStruct {   \
    ....
#define HK_STRUCT_VAR_INT(NAME) int NAME;
#define HK_STRUCT_VAR_FLOAT(NAME) float NAME;
#define HK_STRUCT_END() };</code></pre><p>ì •ì˜ìš© ë§¤í¬ë¡œë¥¼ ì´ìš©í•´ì„œ ë©”íƒ€ ì–¸ì–´ë¡œ ë§Œë“¤ì–´ì§„ í´ë˜ìŠ¤ ì •ë³´ë¥¼ RTTI ì‹œìŠ¤í…œì— ë“±ë¡í•œë‹¤.</p><pre><code class="language-cpp line-numbers">#define HK_STRUCT_BEGIN(BASE, VERSION)  {   \
    typedef BASE##_##VERSION cls;   \
    hikaru::ClassAttribute class_attr(#BASE, #BASE &#34;_&#34; #VERSION, VERSION);
#define HK_STRUCT_VAR_INT(NAME) \
    class_attr.add(hikaru::FieldAttribute::createInt(#NAME, hikaru::offsetOf(&amp;cls::NAME)));
#define HK_STRUCT_VAR_FLOAT(NAME)   \
    class_attr.add(hikaru::FieldAttribute::createFloat(#NAME, hikaru::offsetOf(&amp;cls::NAME)));
#define HK_STRUCT_END() \
    hikaru::ClassDict::getInstance().add(class_attr);   \
}</code></pre><p>ì„ ì–¸ìš© ë§¤í¬ë¡œì™€ ë©”íƒ€ ì–¸ì–´ë¥¼ ì¸í´ë£¨ë“œí•´ì„œ í´ë˜ìŠ¤ë¥¼ ì„ ì–¸í•œë‹¤.
ì •ì˜ìš© ë§¤í¬ë¡œì™€ ë©”íƒ€ ì–¸ì–´ë¥¼ ì¸í´ë£¨ë“œí•´ì„œ í´ë˜ìŠ¤ë¥¼ RTTI ì‹œìŠ¤í…œì— ë“±ë¡í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“ ë‹¤.
ê·¸ëŸ¬ë©´ í´ë˜ìŠ¤ì˜ ë©¤ë²„ë³€ìˆ˜ ì •ë³´ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.
ì—¬ê¸°ì—ì„œ í•¨ìˆ˜ì•ˆì— include ì§‘ì–´ë„£ëŠ” í‘ë§ˆë²• ì½”ë“œê°€ ë“±ì¥í•œë‹¤.</p><pre><code class="language-cpp line-numbers">
#include &#34;hikaru.h&#34;
#include &#34;hk_declaration.h&#34;
#include &#34;struct_data.txt&#34;

int init_hikaru() {
    #include &#34;hk_definition.h&#34;
    #include &#34;struct_data.txt&#34;
    return 0;
}
static int initialized_hikaru = init_hikaru();

void demo_rtti() {
    auto dict = hikaru::ClassDict::getInstance();
    auto classname = dict.getClassName(&#34;HKDemoStruct&#34;, 1);
    auto classattr = dict.get(classname);

    printf(&#34;class name : %s\n&#34;, classattr-&gt;class_name().data());
    printf(&#34;base name : %s\n&#34;, classattr-&gt;base_name().data());
    printf(&#34;class version : %d\n&#34;, classattr-&gt;version());
    for (auto it = classattr-&gt;begin(); it != classattr-&gt;end(); it&#43;&#43;) {
        printf(&#34;field : name=%s type=%d offset=%d\n&#34;, it-&gt;name().data(), it-&gt;type(), it-&gt;offset());
    }
}</code></pre><h2 id=ë‹¨ì >ë‹¨ì </h2><p>ì´ë ‡ê²Œ ì¢‹ì€ ê¸°ìˆ ì´ ìˆëŠ”ë° ë§ì´ ì“°ì´ì§€ ì•ŠëŠ”ê±´ ì´ìœ ê°€ ìˆë‹¤.
ë§¤í¬ë¡œëŠ” ì»´íŒŒì¼ëŸ¬ì˜ í†µì œë²”ìœ„ ë°–ì´ë‹¤. ì „ì²˜ë¦¬ê¸°ì˜ ì˜ì—­ì´ë‹¤.
ê·¸ë˜ì„œ ì˜ëª» ì§œë©´ ì•Œì•„ë³´ê¸° í˜ë“  ì»´íŒŒì¼ ì—ëŸ¬ê°€ ëœ¬ë‹¤.
ë˜í•œ ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ìš´ ë¬¼ê±´ë„ ì•„ë‹ˆë‹¤.
ì½”ë“œ ì°ì–´ë‚´ëŠ” ëª©ì ìœ¼ë¡œ ë§¤í¬ë¡œë¥¼ ì“°ë©´ ì¤„ëì— <code>\</code>ë¥¼ ë„£ì–´ì•¼í•˜ëŠ”ë° ë¹¼ë¨¹ê¸° ì‰½ë‹¤.
ë§¤í¬ë¡œê¹Œì§€ syntax highlightingì´ ì˜ ë˜ëŠ” IDEëŠ” ë³„ë¡œ ì—†ë‹¤.</p><p>ê·¸ë˜ë„ ë‹¨ì ì„ ê°ì˜¤í•˜ë”ë¼ë„ X-Macroë¥¼ ì“°ë©´ ì¢‹ì„ë•Œê°€ ê°€ë”ì”© ìˆë‹¤.
RTTIê°€ ê·¸ëŸ° ì‚¬ë¡€ì´ë‹¤.</p><h2 id=ë”-ë³´ê¸°>ë” ë³´ê¸°</h2><p>ì´ ê¸€ì—ì„œëŠ” X-Macro ìœ„ì£¼ë¡œ ë‹¤ë¤˜ë‹¤.
ì´ë¥¼ ì´ìš©í•´ì„œ RTTIë¥¼ ì–´ë–»ê²Œ êµ¬í˜„í• ë•ŒëŠ” ì•„ë˜ì˜ ê¸€ì´ ë„ì›€ì´ ë ê±°ë‹¤.</p><ul><li><a href=http://lacti.me/2011/09/30/using-rtti-at-cpp/>c++ ì—ì„œ êµ¬ì¡°ì²´ RTTI ì •ë³´ ë‚¨ê¸°ê¸°</a></li><li><a href=http://lacti.me/2012/06/03/using-reflection-at-cpp-1/>c++ì—ì„œ reflection ì‚¬ìš©í•˜ê¸° 1</a></li></ul></div><div class=tags><a href=https://if1live.github.io/tags/black-magic/>black magic</a>
<a href=https://if1live.github.io/tags/x-macro/>x-macro</a>
<a href=https://if1live.github.io/tags/define/>define</a>
<a href=https://if1live.github.io/tags/include/>include</a>
<a href=https://if1live.github.io/tags/c/>c</a>
<a href=https://if1live.github.io/tags/preprocessor/>preprocessor</a></div><hr><div class=pagination><div class="left pagination-item"><a href=https://if1live.github.io/posts/unity-library-vfw/>ğŸ¡° MonoBehaviourë¥¼ ë” ì¢‹ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬, VFW</a></div><div class="right pagination-item"><a href=https://if1live.github.io/posts/unity-tip-remove-if-unity-editor/>[#if UNITY_EDITOR] ì¤„ì´ëŠ” í¸ë²• ğŸ¡²</a></div></div><div class=see-also><h2>See Also</h2><ul><li><a href=/posts/double-loop-with-array/>ë°˜ë³µë¬¸, ì¬ê·€ì—†ì´ í„°ë¯¸ë„ì— ë‹¤ì´ì•„ ê·¸ë¦¬ê¸°</a></li><li><a href=/posts/recursion-with-destructor/>delete this ì´ìš©í•´ì„œ í„°ë¯¸ë„ì— ì‚¼ê°í˜• ê·¸ë¦¬ê¸°</a></li><li><a href=/posts/printf-with-null-post-mortem/>printf("%s\n", NULL)ì˜ ì¶œë ¥ ê²°ê³¼ëŠ”?</a></li><li><a href=/posts/refactoring-c-macro-constant/>ë§¤í¬ë¡œ ìƒìˆ˜ë¥¼ ë³€ê²½í•˜ê¸° ì‰½ê²Œ ë°”ê¾¸ëŠ” í¸ë²•</a></li></ul></div><div id=comment><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//libsora.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></section></div><footer class=sora-footer><p><a href=//gohugo.io/ title=Hugo>Hugo</a> |
<a href=//twitter.com/if1live/ title=@if1live>@if1live</a></p></footer><script src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js integrity="sha512-BttltKXFyWnGZQcRWj6osIg7lbizJchuAMotOkdLxHxwt/Hyo+cl47bZU0QADg+Qt5DJwni3SbYGXeGMB5cBcw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-clike.min.js integrity="sha512-/Rynaa6ehLZJO9fdk+EUsgiOdJqFSFUB4Qgy+gP4vU4U1DrmPJWypfXe1CgyaV7rRdZjGxdpLe9djxhx1ZHvqQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js integrity="sha512-8VrjxGFLIkS0mgEmO3p46A5OkqATHhrNVwyv2V7yUeZrk1jmSDuI3SOEpC9XHEHUWEOsfzzcJeBlUkee9lKGrw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js integrity="sha512-namzGTZvHaug0jeipHRN2pMepMiJj+EbrloktVFlMYGnA0EwZhbdLeENjBYLCgoghVbZGinIz/FFYHmB0o3wLw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js integrity="sha512-uOw7XYETzS/DPmmirpP5UCMihSDNMeyTS965J0/456OSPfxn9xEtHHjj5Q/5WefVdqyMfN/afmQnNpZd/tpkcA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js integrity="sha512-AKaNmg8COK0zEbjTdMHJAPJ0z6VeNqvRvH4/d5M4sHJbQQUToMBtodq4HaV4fa+WV2UTfoperElm66c9/8cKmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js integrity="sha512-jwrwRWZWW9J6bjmBOJxPcbRvEBSQeY4Ad0NEXSfP0vwYi/Yu9x5VhDBl3wz6Pnxs8Rx/t1P8r9/OHCRciHcT7Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js integrity="sha512-xKcnbsdT0KMoA4yrozkqZM1XJVTrPsjdQwvigxlAlxEDu8YDvC/jl+LfVqn0fY3Vs6m2y4a89JCHEIA/Z9zpmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js integrity="sha512-pmt3kb6dRndjFXFFwCa3rSzuUQ0GjeCfC5QULWde+8ZBIsUzuP1heOIOSAMfAyXHSufrrTp8h7UHw85K4IJ2/g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js integrity="sha512-whYhDwtTmlC/NpZlCr6PSsAaLOrfjVg/iXAnC4H/dtiHawpShhT2SlIMbpIhT/IL/NrpdMm+Hq2C13+VKpHTYw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-ruby.min.js integrity="sha512-/Dti0iV9cxgJe8r0U/89YJIv9ZBQu1ExEWffVyBj4juMQ4GNglQ3TQ0Up4gcbiHvg0g87arcUFbKBtw2PxH1Dw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js integrity="sha512-w200Nz1i9KgDNi+IpPMgpZBVRIvfVK/V5vskyHjkz7XJkVnRJcb1uNmpiHhDv0/Ln+GG2VqScKKz/1izBfg64Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-less.min.js integrity="sha512-lL5HvfIycntK04Iiai/VTsyuj7mvDkhz9k+cA8fqXr932s4jLJ1YwplIs6Dhpw0pzVwAe1jGe8sGwbyuHG44QQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-scss.min.js integrity="sha512-aczOaJ+mB9uGT6dMJbDaUsS2PWG+XII+1ypFQ0L22Z132V6kMM6m70pQssXsPAFmLI5xkgx/hknBuUuJIJKZfA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js integrity="sha512-uMdVuOpm+9lNPCT7mV/YaMb9YQ/R4+eeON7aEMj6Ig/f4BoU+Q5k6iaZkDsX7LH9cjTHZt0CuKxbzd0/fndrWA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js integrity="sha512-QXFMVAusM85vUYDaNgcYeU3rzSlc+bTV4JvkfJhjxSHlQEo+ig53BtnGkvFTiNJh8D+wv6uWAQ2vJaVmxe8d3w==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js integrity="sha512-6O/PZimM3TD1NN3yrazePA4AbZrPcwt1QCGJrVY7WoHDJROZFc9TlBvIKMe+QfqgcslW4lQeBzNJEJvIMC8WhA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-batch.min.js integrity="sha512-tPgIjUKiv2HcUAIWXA3v6G4cNuWXkoMsF+ibxfHLnp+/s1C3Bw5/qp78+JjhrfoyWIiHXHx0LtH4M/LAwyQqWg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lisp.min.js integrity="sha512-W461RnQzrhSCQQMfEGFKOHbK2DuJTVxrXs2PzctPaxV3A+qPB/TcnMgucSsBNkyccNK8VoENBsAnbf/SuBE71g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin=anonymous></script>
<script>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]});for(var inlineMathArray=document.querySelectorAll("script[type='math/tex']"),inlineMath,tex,replaced,displayMathArray,displayMath,i=0;i<inlineMathArray.length;i++)inlineMath=inlineMathArray[i],tex=inlineMath.innerText||inlineMath.textContent,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex,{displayMode:!1}),inlineMath.parentNode.replaceChild(replaced,inlineMath);displayMathArray=document.querySelectorAll("script[type='math/tex; mode=display']");for(i=0;i<displayMathArray.length;i++)displayMath=displayMathArray[i],tex=displayMath.innerHTML,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex.replace(/%.*/g,""),{displayMode:!0}),displayMath.parentNode.replaceChild(replaced,displayMath)</script></body></html>