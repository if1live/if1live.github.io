<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.115.1"><title>DOOM에서 배우는 atan2(y, x) 구현 - if1live space</title><meta name=author content="if1live"><meta name=title content="DOOM에서 배우는 atan2(y, x) 구현"><meta name=description content="개요 sin, cos가 있으면 각도를 벡터로 변환할 수 있다. 반대로 벡터를 각도로 변환할때는 atan2를 쓰면 된다. DOOM에서는 atan2를 어떻게 구현했나 코드"><meta name=keywords content="fixed point,atan2"><meta name=naver-site-verification content="2ddc1a56777489f4a64a4f6a59822f8b1c1ea502"><meta name=google-site-verification content="VsvNNnJZUV-iLEYKNju16p-HtDqZeqL15H-VVy-HwpA"><meta name=gc:client-id content="785d47c81cbc2fd42b65"><meta name=gc:client-secret content="5e5d558f0b16fae154aa47fc9d94f7c09e540ec7"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><script type=text/javascript>var host="if1live.github.io";host==window.location.host&&window.location.protocol!="https:"?window.location.protocol="https":console.log("skip https redirect")</script><link rel=stylesheet href=/css/style.f2340c998d4e073dc7d9e2bca0e0c5d770466c4ad200bcc9528d7a7c240bb73ac2cb995257ae58afcf21dbc23e616a1700f146daf3f0f62c7584c4b8507359b2.css integrity="sha512-8jQMmY1OBz3H2eK8oODF13BGbErSALzJUo16fCQLtzrCy5lSV65Yr88h28I+YWoXAPFG2vPw9ix1hMS4UHNZsg=="><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css integrity="sha512-cbQXwDFK7lj2Fqfkuxbo5iD1dSbLlJGXGpfTDqbggqjHJeyzx88I3rfwjS38WJag/ihH7lzuGlGHpDBymLirZQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin=anonymous><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-3043297488880636",enable_page_level_ads:!0})</script><meta property="og:title" content="DOOM에서 배우는 atan2(y, x) 구현"><meta property="og:description" content="개요 sin, cos가 있으면 각도를 벡터로 변환할 수 있다. 반대로 벡터를 각도로 변환할때는 atan2를 쓰면 된다. DOOM에서는 atan2를 어떻게 구현했나 코드"><meta property="og:type" content="article"><meta property="og:url" content="https://if1live.github.io/posts/atan2-doom-version/"><meta property="og:image" content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-05-15T00:00:00+00:00"><meta property="article:modified_time" content="2016-05-15T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta name=twitter:title content="DOOM에서 배우는 atan2(y, x) 구현"><meta name=twitter:description content="개요 sin, cos가 있으면 각도를 벡터로 변환할 수 있다. 반대로 벡터를 각도로 변환할때는 atan2를 쓰면 된다. DOOM에서는 atan2를 어떻게 구현했나 코드"><meta name=twitter:site content="@if1live"><script async src="https://www.googletagmanager.com/gtag/js?id=G-SKE54STL16"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SKE54STL16",{anonymize_ip:!1})}</script></head><body><nav class=sora-navigation><a href=/ title=home><h1>if1live space</h1></a><ul class=menu-button-list><li><a href=/posts title=archive><i class="fa-solid fa-box-archive"></i>
<span hidden>archive</span></a></li><li><a href=/tags title=tags><i class="fa-solid fa-tags"></i>
<span hidden>tags</span></a></li><li><a href=//github.com/if1live title=GitHub><i class="fa-brands fa-github"></i>
<span hidden>GitHub</span></a></li><li><a href=/about title=about><i class="fa-solid fa-info"></i>
<span hidden>about</span></a></li><li><a href=https://if1live.github.io/index.xml title=RSS><i class="fa-solid fa-rss"></i>
<span hidden>RSS</span></a></li></ul></nav><div class=main><section id=single><h1 class=title><span>DOOM에서 배우는 atan2(y, x) 구현</span><br><small>386, 486 에서도 돌아가는 atan2</small></h1><div class=tip><time datetime="2016-05-15 00:00:00 +0000 UTC">2016. 05. 15</time></div><div class=content><h2 id=개요>개요</h2><p>sin, cos가 있으면 각도를 벡터로 변환할 수 있다.
반대로 벡터를 각도로 변환할때는 <a href=http://en.cppreference.com/w/c/numeric/math/atan2>atan2</a>를 쓰면 된다.
DOOM에서는 atan2를 어떻게 구현했나 코드를 뒤져봤다.</p><p>아래의 내용을 읽기전에 <a href=https://if1live.github.io/posts/angle-and-sine-doom-version/>DOOM에서 배우는 각도 표현하는 방법과 sin, cos 구현법</a>를 읽어보는 것을 권장한다.</p><h2 id=어떻게-돌아가는가>어떻게 돌아가는가?</h2><p>DOOM에서 <code>atan2(y, x)</code>는 몇단계에 걸쳐서 계산된다.</p><ol><li>tangent -> angle 로 변환할수 있는 Lookup table을 준비한다.</li><li><code>atan2(y, x)</code>를 lookup table의 인덱스로 변환하는 함수를 만든다. 0~45도만 지원하면 된다.</li><li>0~45도에서만 돌아가는 <code>atan2(y, x)</code>를 이용해서 나머지 각도에서도 돌아가도록 만든다.</li></ol><h2 id=in-doom-source>In DOOM Source</h2><h3 id=lookup-table>lookup table</h3><p><a href=https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/tables.h#L74-L84>https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/tables.h#L74-L84</a></p><pre><code class="language-c line-numbers">#define SLOPERANGE	   2048
#define SLOPEBITS	11
#define DBITS	(FRACBITS-SLOPEBITS)

typedef unsigned angle_t;

// Effective size is 2049;
// The &#43;1 size is to handle the case when x==y
//  without additional checking.
extern angle_t			tantoangle[SLOPERANGE&#43;1];</code></pre><p>tantoangle는 0~45도 구간의 tangent를 angle로 변할할수 있는 lookup table이다.
정확히 45도(x==y) 일때도 대응할수 있도록 크기를 <code>SLOPERANGE+1</code>로 잡았다.</p><p><a href=https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/tables.c#L1870>https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/tables.c#L1870</a></p><pre><code class="language-c line-numbers">angle_t tantoangle[2049] =
{
    0,333772,667544,...
    ...
    536870912
};</code></pre><p>lookup table에서 <code>tantoangle[0]</code> = 0 = 0 Degree 이다.
<code>tantoangle[2048]</code> = 536870912 = 0x2000 0000 = 45 Degree 이다.</p><h3 id=atan2y-x---lookup-table-index>atan2(y, x) -> lookup table index</h3><p><a href=https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/tables.c#L49-L62>https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/tables.c#L49-L62</a></p><p>0~45도 구간에서 atan2(y, x)를 lookup table에서의 인덱스로 변환하는 함수이다.</p><pre><code class="language-c line-numbers">int
SlopeDiv
( unsigned  num,
  unsigned  den)
{
    unsigned   ans;

    if (den &lt; 512)
        return SLOPERANGE;

    ans = (num&lt;&lt;3)/(den&gt;&gt;8);

    return ans &lt;= SLOPERANGE ? ans : SLOPERANGE;
}</code></pre><p>코드를 한줄씩 해석하자.</p><p><code>SlopeDiv(unsigned num, unsigned den)</code> :
<code>atan2(y, x)</code> num=y, den=x와 같은거다. 아래의 설명에서는 num, den보다 x, y를 사용할거다.
이 함수는 x >= 0, y >= 0, x >= y 상태에서 굴러간다.</p><p><code>if (den &lt; 512) { return SLOPERANGE; }</code> :
unsigned는 사실 <code>fixed_t</code> 이다. <code>fixed_t</code>는 Q16.16 규격의 고정소수점이다.
<code>fixed_t 512</code>는 고정소수점 <code>Q16.16(0x 00 00.01 00)</code>으로 <code>2 ** -8 = 0.00390625</code>이다.
<code>SLOPERANGE</code>는 tantoangle lookup table의 마지막 요소의 인덱스이다.</p><p>코드를 다시 쓰면 <code>if(x &lt; 0.00390625) { return tantoangle_LAST_INDEX; }</code>이다.
x가 매우 작은 경우는 적당히 예외 처리한 것으로 보인다. 하는김에 den=0를 막아서 divided by zero도 막고.</p><p><code>ans = (num&lt;&lt;3)/(den>>8);</code> :
실제로 계산하고 싶은 내용은 <code>ans = (y / x) * (2 ** 11)</code>이다.
<code>y/x</code>로 tangent를 구하고 <code>2048=2 ** 11</code>를 곱하면 0~2048사이의 값이 된다. (x >= 0, y >= 0, x >= y라면 0~45도 구간이다. 해당 구간에서 tangent는 0~1이다)
이 값을 lookup table의 인덱스로 이용할수 있다&mldr;.. 는 이론상 그런거고 현실에서는 다르다.</p><p>x, y는 unsigned int이다. 그리고 x >= y이다. 그리고 float는 쓰지 않았다.
x==y를 제외한 모든 경우에서 <code>y/x = 0</code>이 되어버린다.
그렇다고 <code>(y &lt;&lt; 11) / x)</code>를 계산하면 y가 별로 크지 않아도 오버플로우가 발생할수 있다 (32=2**5, 32&#171;11 = 1&#171;16, overflow!)
그래서 DOOM은 편법을 썻다.</p><ol><li><code>2 ** 11</code> = <code>(2 ** 3) / (2 ** -8)</code></li><li><code>den >> 8</code> : den은 512(2**9)보다 크거나 같다. 그렇기때문에 8비트를 오른쪽으로 shift해도 0이 되진 않을거다. (divided by zero 발생 안함)</li><li><code>num &lt;&lt; 3</code> : num을 너무 큰수로만 쓰지 않으면 오버플로우가 발생하지 않을거다. (<code>num &lt;&lt; 11</code>보다는 안전하다)</li></ol><p><code>return ans &lt;= SLOPERANGE ? ans : SLOPERANGE;</code> : ans가 tantoangle 배열 범위를 벗어나지 않도록 한번더 확인한다.</p><h3 id=045도-이외에서도-atan2y-x-돌아가도록>0~45도 이외에서도 atan2(y, x) 돌아가도록</h3><p><a href=https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/r_main.c#L835-L836>https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/r_main.c#L835-L836</a></p><pre><code class="language-c line-numbers">viewx = player-&gt;mo-&gt;x;
viewy = player-&gt;mo-&gt;y;</code></pre><p>viwex, viewy는 계산의 기준점(플레이어의 위치)이다.</p><p><a href=https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/r_main.c#L291-L374>https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/r_main.c#L291-L374</a></p><pre><code class="language-c line-numbers">angle_t
R_PointToAngle
( fixed_t x,
  fixed_t y )
{
    x -= viewx;
    y -= viewy;

    if ( (!x) &amp;&amp; (!y) )
        return 0;

    if (x&gt;= 0) {
        // x &gt;=0
        if (y&gt;= 0) {
            // y&gt;= 0

            if (x&gt;y) {
                // octant 0
                return tantoangle[ SlopeDiv(y,x)];
            } else {
                // octant 1
                return ANG90-1-tantoangle[ SlopeDiv(x,y)];
            }

        } else {
            // y&lt;0
            y = -y;

            if (x&gt;y) {
                // octant 8
                return -tantoangle[SlopeDiv(y,x)];
            } else {
                // octant 7
                return ANG270&#43;tantoangle[ SlopeDiv(x,y)];
            }
        }
    } else {
        // x&lt;0
        x = -x;

        if (y&gt;= 0) {
            // y&gt;= 0
            if (x&gt;y) {
                // octant 3
                return ANG180-1-tantoangle[ SlopeDiv(y,x)];
            } else {
                // octant 2
                return ANG90&#43; tantoangle[ SlopeDiv(x,y)];
            }
        } else {
            // y&lt;0
            y = -y;
            if (x&gt;y) {
                // octant 4
                return ANG180&#43;tantoangle[ SlopeDiv(y,x)];
            } else {
                // octant 5
                return ANG270-1-tantoangle[ SlopeDiv(x,y)];
            }
        }
    }
    return 0;
}</code></pre><p>코드는 길지만 별거없다. <a href=https://en.wikipedia.org/wiki/Octant_%28plane_geometry%29>360도를 8조각</a>으로 나눈것뿐이다.
그리고 각각의 조각에 대해 따로 처리했다.
0~45도에서만 돌아가는 SlopeDiv(y, x)를 구하기 위해서 x, y는 죄다 절대값을 사용하고 일부 각도 구간에서는 x, y축을 뒤집기도 했다.</p><ul><li>octant 0 (0~45deg) : tantoangle[ SlopeDiv(y,x)]</li><li>octant 1 (45~90deg) : ANG90-1-tantoangle[ SlopeDiv(x,y)]</li><li>octant 2 (90~135deg) : ANG90+ tantoangle[ SlopeDiv(x,y)]</li><li>octant 3 (135~180deg) : ANG180-1-tantoangle[ SlopeDiv(y,x)]</li><li>octant 4 (180~225deg) : ANG180+tantoangle[ SlopeDiv(y,x)]</li><li>octant 5 (225~270deg) : ANG270-1-tantoangle[ SlopeDiv(x,y)]</li><li>octant 6 (270~315deg) : ANG270+tantoangle[ SlopeDiv(x,y)]</li><li>octant 7 (315~360deg) : -tantoangle[SlopeDiv(y,x)]</li></ul></div><div class=tags><a href=https://if1live.github.io/tags/fixed-point/>fixed point</a>
<a href=https://if1live.github.io/tags/atan2/>atan2</a></div><div id=comment><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//libsora.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></section></div><footer class=sora-footer><p><a href=//gohugo.io/ title=Hugo>Hugo</a> |
<a href=//twitter.com/if1live/ title=@if1live>@if1live</a></p></footer><script src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js integrity="sha512-BttltKXFyWnGZQcRWj6osIg7lbizJchuAMotOkdLxHxwt/Hyo+cl47bZU0QADg+Qt5DJwni3SbYGXeGMB5cBcw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-clike.min.js integrity="sha512-/Rynaa6ehLZJO9fdk+EUsgiOdJqFSFUB4Qgy+gP4vU4U1DrmPJWypfXe1CgyaV7rRdZjGxdpLe9djxhx1ZHvqQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js integrity="sha512-8VrjxGFLIkS0mgEmO3p46A5OkqATHhrNVwyv2V7yUeZrk1jmSDuI3SOEpC9XHEHUWEOsfzzcJeBlUkee9lKGrw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js integrity="sha512-namzGTZvHaug0jeipHRN2pMepMiJj+EbrloktVFlMYGnA0EwZhbdLeENjBYLCgoghVbZGinIz/FFYHmB0o3wLw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js integrity="sha512-uOw7XYETzS/DPmmirpP5UCMihSDNMeyTS965J0/456OSPfxn9xEtHHjj5Q/5WefVdqyMfN/afmQnNpZd/tpkcA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js integrity="sha512-AKaNmg8COK0zEbjTdMHJAPJ0z6VeNqvRvH4/d5M4sHJbQQUToMBtodq4HaV4fa+WV2UTfoperElm66c9/8cKmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js integrity="sha512-jwrwRWZWW9J6bjmBOJxPcbRvEBSQeY4Ad0NEXSfP0vwYi/Yu9x5VhDBl3wz6Pnxs8Rx/t1P8r9/OHCRciHcT7Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js integrity="sha512-xKcnbsdT0KMoA4yrozkqZM1XJVTrPsjdQwvigxlAlxEDu8YDvC/jl+LfVqn0fY3Vs6m2y4a89JCHEIA/Z9zpmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js integrity="sha512-pmt3kb6dRndjFXFFwCa3rSzuUQ0GjeCfC5QULWde+8ZBIsUzuP1heOIOSAMfAyXHSufrrTp8h7UHw85K4IJ2/g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js integrity="sha512-whYhDwtTmlC/NpZlCr6PSsAaLOrfjVg/iXAnC4H/dtiHawpShhT2SlIMbpIhT/IL/NrpdMm+Hq2C13+VKpHTYw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-ruby.min.js integrity="sha512-/Dti0iV9cxgJe8r0U/89YJIv9ZBQu1ExEWffVyBj4juMQ4GNglQ3TQ0Up4gcbiHvg0g87arcUFbKBtw2PxH1Dw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js integrity="sha512-w200Nz1i9KgDNi+IpPMgpZBVRIvfVK/V5vskyHjkz7XJkVnRJcb1uNmpiHhDv0/Ln+GG2VqScKKz/1izBfg64Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-less.min.js integrity="sha512-lL5HvfIycntK04Iiai/VTsyuj7mvDkhz9k+cA8fqXr932s4jLJ1YwplIs6Dhpw0pzVwAe1jGe8sGwbyuHG44QQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-scss.min.js integrity="sha512-aczOaJ+mB9uGT6dMJbDaUsS2PWG+XII+1ypFQ0L22Z132V6kMM6m70pQssXsPAFmLI5xkgx/hknBuUuJIJKZfA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js integrity="sha512-uMdVuOpm+9lNPCT7mV/YaMb9YQ/R4+eeON7aEMj6Ig/f4BoU+Q5k6iaZkDsX7LH9cjTHZt0CuKxbzd0/fndrWA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js integrity="sha512-QXFMVAusM85vUYDaNgcYeU3rzSlc+bTV4JvkfJhjxSHlQEo+ig53BtnGkvFTiNJh8D+wv6uWAQ2vJaVmxe8d3w==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js integrity="sha512-6O/PZimM3TD1NN3yrazePA4AbZrPcwt1QCGJrVY7WoHDJROZFc9TlBvIKMe+QfqgcslW4lQeBzNJEJvIMC8WhA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-batch.min.js integrity="sha512-tPgIjUKiv2HcUAIWXA3v6G4cNuWXkoMsF+ibxfHLnp+/s1C3Bw5/qp78+JjhrfoyWIiHXHx0LtH4M/LAwyQqWg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lisp.min.js integrity="sha512-W461RnQzrhSCQQMfEGFKOHbK2DuJTVxrXs2PzctPaxV3A+qPB/TcnMgucSsBNkyccNK8VoENBsAnbf/SuBE71g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin=anonymous></script>
<script>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]});for(var inlineMathArray=document.querySelectorAll("script[type='math/tex']"),inlineMath,tex,replaced,displayMathArray,displayMath,i=0;i<inlineMathArray.length;i++)inlineMath=inlineMathArray[i],tex=inlineMath.innerText||inlineMath.textContent,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex,{displayMode:!1}),inlineMath.parentNode.replaceChild(replaced,inlineMath);displayMathArray=document.querySelectorAll("script[type='math/tex; mode=display']");for(i=0;i<displayMathArray.length;i++)displayMath=displayMathArray[i],tex=displayMath.innerHTML,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex.replace(/%.*/g,""),{displayMode:!0}),displayMath.parentNode.replaceChild(replaced,displayMath)</script></body></html>