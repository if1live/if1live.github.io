<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.116.1"><title>cocos2d-x ë©”ëª¨ë¦¬ ê´€ë¦¬ì— ëŒ€í•œ ê°„ë‹¨í•œ ì •ë¦¬ - if1live space</title><meta name=author content="if1live"><meta name=title content="cocos2d-x ë©”ëª¨ë¦¬ ê´€ë¦¬ì— ëŒ€í•œ ê°„ë‹¨í•œ ì •ë¦¬"><meta name=description content="cocos2d-xëŠ” cocos2dë¥¼ ê±°ì˜ ê·¸ëŒ€ë¡œ í¬íŒ…í•œ 2dê²Œì„ ì—”ì§„ì´ë‹¤. ì›ì‘ì´ objc ê¸°ë°˜ì¸ cocos2dë¥¼ C++ë¡œ ì˜®ê²¼ìœ¼ë‹ˆ ì™„ì „íˆ ë˜‘ê°™ì§€ëŠ” ì•Šë‹¤. íŠ¹íˆ"><meta name=keywords content="cpp,cocos2dx"><meta name=naver-site-verification content="2ddc1a56777489f4a64a4f6a59822f8b1c1ea502"><meta name=google-site-verification content="VsvNNnJZUV-iLEYKNju16p-HtDqZeqL15H-VVy-HwpA"><meta name=gc:client-id content="785d47c81cbc2fd42b65"><meta name=gc:client-secret content="5e5d558f0b16fae154aa47fc9d94f7c09e540ec7"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><script type=text/javascript>var host="if1live.github.io";host==window.location.host&&window.location.protocol!="https:"?window.location.protocol="https":console.log("skip https redirect")</script><link rel=stylesheet href=/css/style.ad6245cc6a90c30a30dba42b8bbe9be63bed9ea169e339d8ecfc6b9afc6eb8382bbd422b2d31dc71c3355c79f057ddcaa7e1ca96b5eb7f5f16a28a34e74051db.css integrity="sha512-rWJFzGqQwwow26Qri76b5jvtnqFp4znY7PxrmvxuuDgrvUIrLTHcccM1XHnwV93Kp+HKlrXrf18Wooo050BR2w=="><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css integrity="sha512-cbQXwDFK7lj2Fqfkuxbo5iD1dSbLlJGXGpfTDqbggqjHJeyzx88I3rfwjS38WJag/ihH7lzuGlGHpDBymLirZQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin=anonymous><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-3043297488880636",enable_page_level_ads:!0})</script><meta property="og:title" content="cocos2d-x ë©”ëª¨ë¦¬ ê´€ë¦¬ì— ëŒ€í•œ ê°„ë‹¨í•œ ì •ë¦¬"><meta property="og:description" content="cocos2d-xëŠ” cocos2dë¥¼ ê±°ì˜ ê·¸ëŒ€ë¡œ í¬íŒ…í•œ 2dê²Œì„ ì—”ì§„ì´ë‹¤. ì›ì‘ì´ objc ê¸°ë°˜ì¸ cocos2dë¥¼ C++ë¡œ ì˜®ê²¼ìœ¼ë‹ˆ ì™„ì „íˆ ë˜‘ê°™ì§€ëŠ” ì•Šë‹¤. íŠ¹íˆ"><meta property="og:type" content="article"><meta property="og:url" content="https://if1live.github.io/posts/cocos2dx-memory-management/"><meta property="og:image" content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta property="article:section" content="posts"><meta property="article:published_time" content="2013-01-25T00:00:00+00:00"><meta property="article:modified_time" content="2013-01-25T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta name=twitter:title content="cocos2d-x ë©”ëª¨ë¦¬ ê´€ë¦¬ì— ëŒ€í•œ ê°„ë‹¨í•œ ì •ë¦¬"><meta name=twitter:description content="cocos2d-xëŠ” cocos2dë¥¼ ê±°ì˜ ê·¸ëŒ€ë¡œ í¬íŒ…í•œ 2dê²Œì„ ì—”ì§„ì´ë‹¤. ì›ì‘ì´ objc ê¸°ë°˜ì¸ cocos2dë¥¼ C++ë¡œ ì˜®ê²¼ìœ¼ë‹ˆ ì™„ì „íˆ ë˜‘ê°™ì§€ëŠ” ì•Šë‹¤. íŠ¹íˆ"><meta name=twitter:site content="@if1live"><script async src="https://www.googletagmanager.com/gtag/js?id=G-SKE54STL16"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SKE54STL16",{anonymize_ip:!1})}</script></head><body><nav class=sora-navigation><a href=/ title=home><h1>if1live space</h1></a><ul class=menu-button-list><li><a href=/posts title=archive><i class="fa-solid fa-box-archive"></i>
<span hidden>archive</span></a></li><li><a href=/tags title=tags><i class="fa-solid fa-tags"></i>
<span hidden>tags</span></a></li><li><a href=//github.com/if1live title=GitHub><i class="fa-brands fa-github"></i>
<span hidden>GitHub</span></a></li><li><a href=/about title=about><i class="fa-solid fa-info"></i>
<span hidden>about</span></a></li><li><a href=https://if1live.github.io/index.xml title=RSS><i class="fa-solid fa-rss"></i>
<span hidden>RSS</span></a></li></ul></nav><div class=main><section id=single><h1 class=title><span>cocos2d-x ë©”ëª¨ë¦¬ ê´€ë¦¬ì— ëŒ€í•œ ê°„ë‹¨í•œ ì •ë¦¬</span></h1><div class=tip><time datetime="2013-01-25 00:00:00 +0000 UTC">2013. 01. 25</time></div><div class=content><p>cocos2d-xëŠ” cocos2dë¥¼ ê±°ì˜ ê·¸ëŒ€ë¡œ í¬íŒ…í•œ 2dê²Œì„ ì—”ì§„ì´ë‹¤.
ì›ì‘ì´ objc ê¸°ë°˜ì¸ cocos2dë¥¼ C++ë¡œ ì˜®ê²¼ìœ¼ë‹ˆ ì™„ì „íˆ ë˜‘ê°™ì§€ëŠ” ì•Šë‹¤.
íŠ¹íˆ ë©”ëª¨ë¦¬ ëª¨ë¸ì˜ ê²½ìš°ëŠ” ì–¸ì–´ìƒì˜ ì°¨ì´ë¡œ ë‹¤ë¥¼ìˆ˜ë°–ì— ì—†ë‹¤.</p><p>objcì˜ ë©”ëª¨ë¦¬ ê´€ë¦¬ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë ˆí¼ëŸ°ìŠ¤ ì¹´ìš´íŒ… ë°©ì‹ì´ë‹¤. ëª¨ë“  objcì˜ í´ë˜ìŠ¤ëŠ” NSObjectë¥¼ ìƒì†ë°›ëŠ”ë‹¤.
retain, releaseë¥¼ ì ì ˆíˆ ì¨ì„œ ë ˆëŸ¬ëŸ°ì„œ ì¹´ìš´íŒ… ìŒì„ ë§ì¶°ì£¼ë©´ ì ì ˆíˆ ë©”ëª¨ë¦¬ê°€ ê´€ë¦¬ëœë‹¤.
autoreleaseë¥¼ ì‚¬ìš©í•˜ë©´ NSAutoreleasePoolì— ìƒì„±ëœ ê°ì²´ê°€ ë“±ë¡ëœë‹¤.
ì´í›„ NSAutoreleasePoolì´ í•´ì œë˜ë©´ í’€ì— ë“±ë¡ëœ ëª¨ë“  ê°ì²´ì— ëŒ€í•´ì„œ releaseë¥¼ ìˆ˜í–‰í•œë‹¤.</p><p>í•˜ì§€ë§Œ C++ì—ëŠ” ê¸°ë³¸ì ìœ¼ë¡œëŠ” ì €ëŸ°ê¸°ëŠ¥ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. newë¡œ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  deleteë¡œ ê°ì²´ë¥¼ í•´ì œí•œë‹¤.
autorelase? ê·¸ë”´ê±´ ë‹ˆê°€ ë§Œë“¤ì–´ì•¼í•¨ã…‹
(ë¬¼ë¡  ì´ì œëŠ” í‘œì¤€ì´ëœ std::shared_ptr,
ì¼ë¶€ì»´íŒŒì¼ëŸ¬ì—ì„œëŠ” std::tr1::shared_ptrë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë ˆí¼ëŸ°ìŠ¤ ì¹´ìš´íŒ…ì´ ë˜ê¸´ í•œë‹¤.
cocos2dxëŠ” ê·¸ëŸ°ê±° ì—†ì´ ìì²´ êµ¬í˜„ë˜ì–´ìˆìœ¼ë‹ˆê¹Œ ì¼ë‹¨ ì‹ ê²½ì“°ì§€ ì•ŠëŠ”ë‹¤)</p><p>í•˜ì§€ë§Œ cocos2dxëŠ” cocos2dë¥¼ ê±°ì˜ ë¹„ìŠ·í•˜ê²Œ ë² ë¼ë ¤ë³´ë‹ˆê¹Œ cocos2dxë¥¼ ë³´ë©´ CCObjectë¼ëŠ” í´ë˜ìŠ¤ë¡œ objcì— ìˆëŠ” ë©”ëª¨ë¦¬ ëª¨ë¸ì„ ë¹„ìŠ·í•˜ê²Œ ë§Œë“¤ì–´ë†§ë‹¤.</p><pre><code class="language-cpp line-numbers">CCObject::CCObject(void)
{
    static unsigned int uObjectCount = 0;

    m_uID = &#43;&#43;uObjectCount;
    m_nLuaID = 0;

    // when the object is created, the refrence count of it is 1
    m_uReference = 1;		// &lt;--- CCObjectë¥¼ ìƒì†ë°›ì€ í´ë˜ìŠ¤ëŠ” ê°ì²´ê°€ ìƒì„±ë ë•Œ ì¹´ìš´í„°ê°€ 1
    m_bManaged = false;
}
CCObject::~CCObject(void)
{
    // if the object is managed, we should remove it
    // from pool manager
    if (m_bManaged)		//autoreleaseë¥¼ í–‡ë˜ ê²½ìš°ì— í”Œë˜ê·¸ ì˜¬ë¼ê°
    {
        CCPoolManager::sharedPoolManager()-&gt;removeObject(this);	//í’€ì—ì„œ ì œê±°
    }
	//ì ì ˆíˆ ìƒëµ
}
void CCObject::release(void)
{
    CCAssert(m_uReference &gt; 0, &#34;reference count should greater than 0&#34;);
    --m_uReference;		//releaseëŠ” ë ˆí¼ëŸ°ìŠ¤ ì¹´ìš´í„° ë‚´ë¦¬ê¸°

	//ë ˆí¼ëŸ°ìŠ¤ ì¹´ìš´í„° 0ë˜ë©´ í´ë˜ìŠ¤ ìã…‹í­ã…‹
	//ê·¸ë˜ì„œ releaseí›„ì— deleteë¥¼ ìˆ˜ë™ìœ¼ë¡œ í•˜ë©´ ë§í•œë‹¤
    if (m_uReference == 0)	
    {
        delete this;
    }
}

void CCObject::retain(void)
{
    CCAssert(m_uReference &gt; 0, &#34;reference count should greater than 0&#34;);
    &#43;&#43;m_uReference;		//retainì€ ë ˆí¼ëŸ°ìŠ¤ ì¹´ìš´í„° ì˜¬ë¦¬ê¸°
}

CCObject* CCObject::autorelease(void)
{
	//autorelaseë¥¼ í•˜ëŠ” ê²½ìš°, ì ì ˆíˆ autorlease poolì— ë“±ë¡í•˜ê³  í”Œë˜ê·¸ë¥¼ ì˜¬ë¦°ë‹¤
    CCPoolManager::sharedPoolManager()-&gt;addObject(this);
    m_bManaged = true;
    return this;
}</code></pre><p>ìœ„ì™€ ê°™ì´ CCObjectë¥¼ êµ¬í˜„í•´ì„œ objcì˜ retain,release,autorelaseì™€ ë™ì¼í•œ APIë¥¼ ìœ ì§€í• ìˆ˜ ìˆë„ë¡ ë˜ì–´ì‡ë‹¤.
ë‹¤ìŒìœ¼ë¡œ ì§„ì§œ cocos2dx ì‚¬ìš© ì˜ˆì œ ì†ŒìŠ¤ì—ì„œ ì–´ë–»ê²Œ ë©”ëª¨ë¦¬ê°€ ëŒì•„ê°€ë‚˜ ë³´ì</p><p>ìˆ˜ë™ìœ¼ë¡œ ë ˆí¼ëŸ°ìŠ¤ ì¹´ìš´íŒ…ì„ í•˜ë„ë¡ ì§œë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. ë ˆí¼ëŸ°ìŠ¤ ì¹´ìš´íŒ…ì˜ ë³€í™”ëŠ” ì£¼ì„ìœ¼ë¡œ ë‹¬ì•„ë†§ë‹¤</p><pre><code class="language-cpp line-numbers">bool SimpleLayer::init() {
	if(!CCLayer::init()) {
		return false;
	}
	CCSprite *sprite = new CCSprite();	//ref : 1
	sprite-&gt;initWithFile(&#34;asdf.png&#34;);	//ë ˆí¼ëŸ°ìŠ¤ ë³€í™”ì—†ìŒ
	this-&gt;addChild(sprite);		//CCArrayê°™ì€ cocoaì˜ ìë£Œêµ¬ì¡°ë¥¼ ë² ë‚€ê²ƒì— ì§‘ì–´ë„£ìœ¼ë©´ 1ì¦ê°€. ref : 2
	sprite-&gt;release();	//ìˆ˜ë™ìœ¼ë¡œ ë‚´ë ¤ì„œ ref : 1
	//ì´í›„ ì´ ë ˆì´ì–´ê°€ í•´ì œë ë•Œ
	//childrenìœ¼ë¡œ ë“±ë¡ë˜ì–´ì‡ëŠ” spriteì— ëŒ€í•´ì„œ releaseê°€ ì ì ˆíˆ ìˆ˜í–‰ë˜ì„œ ref : 0, ëˆ„ìˆ˜ì—†ì´ ê°ì²´ ì‚­ì œ
	return true;
}</code></pre><p>ìœ„ì˜ ì½”ë“œëŠ” í‰ë²”í•œ objcì½”ë“œë¥¼ c++ë¡œ ë°”ë¡œ ë³€í™˜í•œê±°ë‹ˆê¹Œ ë³„ë¡œ ì¤‘ìš”í•˜ì§€ ì•Šë‹¤.
autoreleaseë¥¼ ì“°ëŠ” ì˜ˆì œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. C++ì—ëŠ” ì›ë˜ ì¡´ì¬í•˜ì§€ ì•Šë˜ autoreleaeë¥¼ ì ì ˆíˆ ë§Œë“¤ì–´ë‚¸
cocos2dxì˜ ì‹ ë¬˜í•œ ë©”ëª¨ë¦¬ ê´€ë¦¬ì •ì±…ì„ ë³¼ìˆ˜ì‡ë‹¤</p><pre><code class="language-cpp line-numbers">bool SimpleLayer::init() {
	if(!CCLayer::init()) {
		return false;
	}
	CCSprite *sprite = CCSprite::spriteWithFile(&#34;asdf.png&#34;);	//ref:1, autorelease poolì— ë“±ë¡
	this-&gt;addChild(sprite);	//childrenë“±ë¡ë˜ë©´ì„œ &#43;1, ref:1
	//ì´í›„ ì´ ë ˆì´ì–´ê°€ í•´ì œë ë•Œ
	//childrenìœ¼ë¡œ ë“±ë¡ë˜ì–´ì‡ëŠ” spriteì— ëŒ€í•´ì„œ releaseê°€ ì ì ˆíˆ ìˆ˜í–‰ë˜ì„œ ref : 1
	//ANG? ref=1ì´ ë‚¨ì•—ë‹¤ê³ ? ì´ê±´ ê·¸ë ‡ë‹¤ë©´ ì–¸ì œ í•´ì œë˜ëŠ”ê±°ì§€?
	return true;
}</code></pre><p>ì˜ˆì œì˜ ì½”ë“œë§Œì„ ë³´ë©´ ref=1ì´ ë‚¨ì•„ìˆê³  autorelase poolì— ë“±ë¡ë˜ì–´ìˆëŠ” ìƒíƒœì´ë‹¤.
ê·¸ë ‡ë‹¤ë©´ ë ˆì´ì–´ê°€ ì†Œë©¸í–‡ì§€ë§Œ spriteëŠ” í•´ì œë˜ì§€ ì•Šê³  ë‚¨ì•„ì‡ëŠ” ìƒíƒœë¼ë‹ˆ ì´ê²Œ ë¬´ìŠ¨ì†Œë¦¬ì¸ê°€?</p><p>ëŠ” ê²Œì„ë‚´ë¶€ ì†ŒìŠ¤ë¥¼ ê¹Œë³´ë©´ ì‹ ë¬˜í•œ êµ¬í˜„ì„ ë³¼ìˆ˜ìˆë‹¤.</p><pre><code class="language-cpp line-numbers">void CCDisplayLinkDirector::mainLoop(void)
{
    if (m_bPurgeDirecotorInNextLoop)
    {
        m_bPurgeDirecotorInNextLoop = false;
        purgeDirector();
    }
    else if (! m_bInvalid)
     {
         drawScene();
     
         // release the objects
         CCPoolManager::sharedPoolManager()-&gt;pop();     //&lt;--- 
     }
}</code></pre><pre><code class="language-cpp line-numbers">void CCPoolManager::pop()
{
    if (! m_pCurReleasePool)
    {
        return;
    }
	int nCount = m_pReleasePoolStack-&gt;count();
    m_pCurReleasePool-&gt;clear();	//&lt;--
	.....
}</code></pre><pre><code class="language-cpp line-numbers">void CCAutoreleasePool::clear()
{
    if(m_pManagedObjectArray-&gt;count() &gt; 0)
    {
        CCObject* pObj = NULL;
        CCARRAY_FOREACH_REVERSE(m_pManagedObjectArray, pObj)
        {
            if(!pObj)
                break;

            pObj-&gt;m_bManaged = false;
            //(*it)-&gt;release();
            //delete (*it);
       }
        m_pManagedObjectArray-&gt;removeAllObjects();
    }
}
void CCAutoreleasePool::addObject(CCObject* pObject)
{
    m_pManagedObjectArray-&gt;addObject(pObject);
    CCAssert(pObject-&gt;m_uReference &gt; 1, &#34;reference count should be greater than 1&#34;);
    pObject-&gt;release(); // no ref count, in this case autorelease pool added.
}</code></pre><p>CCDirector::mainLoopëŠ” ë§¤ í”„ë ˆì„ë§ˆë‹¤ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì´ë‹¤. ì´ í•¨ìˆ˜ ì•ˆì—ëŠ” autorelease poolì„ í•´ì œí•˜ëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.
CCPoolManager::popì„ ê±°ì³ì„œ CCAutoreleasePool::clearê°€ í˜¸ì¶œë˜ì„œ ê³µìš© autorelease poolì— ë“±ë¡ëœ ê°ì²´ë¥¼ ì „ë¶€ í•´ì œí•œë‹¤.</p><p>autorelease poolì„ clearí•˜ëŠ” í•¨ìˆ˜ì˜ êµ¬í˜„ì„ ë³´ë©´
ëª¨ë“  ê°ì²´ì— ëŒ€í•´ì„œ
ê°ì²´ë¥¼ ê°•ì œë¡œ autorelease poolë¡œ ë“±ë¡í•˜ì§€ ì•Šì•—ë‹¤ê³  í”Œë˜ê·¸ë¥¼ ë°”ê¾¸ê³ 
ë°°ì—´ì„ í†µì§¸ë¡œ ë‚ ë¦°ë‹¤. (ë°°ì—´ì„ ë¹„ìš°ë©´ ë°°ì—´ì•ˆì˜ ìš”ì†Œì— ëŒ€í•´ì„œ releaseê°€ í˜¸ì¶œëœë‹¤)</p><p>autorelease poolì— ê°ì²´ë¥¼ ë“±ë¡í•˜ëŠ” ì½”ë“œë¥¼ ë³´ë©´ ë ˆí¼ëŸ°ìŠ¤ ì¹´ìš´í„°ë¥¼ ì›ë˜ìƒíƒœë¡œ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œ ë°°ì—´ì— ë„£ê³  releaseë¥¼ ìˆ˜í–‰í•œë‹¤</p><p>ì½”ë“œë¥¼ ê¹Œë´„ìœ¼ë¡œì¨ ì•Œê²Œëœ ì¶”ê°€ì‚¬í•­ì„ ë‹¤ì‹œ ì˜ˆì œì— ì ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤</p><pre><code class="language-cpp line-numbers">//ê°ì²´ ìƒì„±ë˜ì„œ ref=1
//autorelease poolì— ë“±ë¡í•´ë„ ref countëŠ” ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤. ref=1
CCSprite *sprite = CCSprite::spriteWithFile(&#34;asdf.png&#34;);
this-&gt;addChild(sprite);	//childrenë“±ë¡ë˜ë©´ì„œ &#43;1, ref:2
//ì´í›„ ì´ ë ˆì´ì–´ê°€ í•´ì œë ë•Œ
//childrenìœ¼ë¡œ ë“±ë¡ë˜ì–´ì‡ëŠ” spriteì— ëŒ€í•´ì„œ releaseê°€ ì ì ˆíˆ ìˆ˜í–‰ë˜ì„œ ref : 1

/*** í”„ë ˆì„ ì¢…ë£Œ, mainLoopì˜ ë ***/
//autorelase poolì— ë“±ë¡ëœ ê°ì²´ì— ëŒ€í•´ì„œ ì „ë¶€ relaseë¥¼ í˜¸ì¶œí•´ì„œ ì¹´ìš´í„° -1

//ìœ„ì—ì„œ ìƒì„±ëœ ê°ì²´ê°€ layerê°™ì€ê³³ì— ë“±ë¡ë˜ì–´ìˆì–´ì„œ ref count=2ì¸ ìƒíƒœì´ë©´ ref=1ë¡œ ë³€í•¨. 
//layerê°™ì€ê±°ì—ì„œ ì œê±°ë ë•Œ ë ˆí¼ëŸ°ìŠ¤ ì¹´ìš´í„°ê°€ 1 ì¤„ì–´ì„œ ì ì ˆíˆ ê°ì²´ í•´ì œë¨

//autorelaseë¡œ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì–´ë”” ë“±ë¡í•˜ì§€ ì•Šê³  ëƒ…ë‘”ê²½ìš°(ref=1)
//autorelaseê°€ ì ì ˆíˆ releaseë¥¼ í•´ì œí•´ì„œ ì¹´ìš´í„° 1 ì¤„ì–´ì„œ ë©”ëª¨ë¦¬ í•´ì œë¨. ëˆ„ìˆ˜ì—†ìŒ</code></pre><p>ì¢‹ì€ ë©”ëª¨ë¦¬ ê´€ë¦¬ ëª¨ë¸ì´ë‹¤.
ê°œë°œìëŠ” initXXXì„ ì¨ì„œ ìˆ˜ë™ìœ¼ë¡œ ê´€ë¦¬í•˜ê±´ spriteXXXë¥¼ ì¨ì„œ ìë™ìœ¼ë¡œ ë§¡ê¸°ê±´ ì–´ì¨‹ë“  ì˜ ì§œë©´ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ëŠ” ì—†ë‹¤</p><p>í•˜ì§€ë§Œ ì´ê±¸ë¡œ ëë‚˜ì§€ ì•ŠëŠ”ë‹¤. ëª‡ê°€ì§€ ë¬¸ì œì ì´ ì¡´ì¬í•œë‹¤</p><ul><li>retain, releaseëŠ” ë½ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. ë©€í‹° ì“°ë ˆë“œë¡œ ê°€ë©´ ì•„ë§ˆ ì‚¬ê³ ì¹ ê±°ë‹¤</li><li>autorelase poolì„ ì¤‘ì²©í•´ì„œ ì‚¬ìš©í• ìˆ˜ì—†ë‹¤<ul><li>mainLoopì—ì„œ ì²˜ë¦¬í•˜ëŠ” autorelase poolì€ ê³µìš© autorelase pool í•˜ë‚˜ë¿ì´ë‹¤</li></ul></li></ul><p>ë¬¼ë¡  <a href=http://cocos2d-x.org/projects/cocos2d-x/wiki/Memory_Management_in_Cocos2d-x>ìœ„í‚¤</a>ì—ë„ ì–¸ê¸‰ëœ ì‚¬í•­ì´ë‹¤.<br>ìœ„ì˜ ê°œë…ê³¼ ì—®ì—¬ì„œ ë°œìƒê°€ëŠ¥í•œ ë¬¸ì œë„ ìˆëŠ”ë° ì´ëŠ” ìœ„í‚¤ë¥¼ ì ì ˆíˆ ì°¸ê³ í•˜ì.
(í•˜ì§€ë§Œ ë‚˜ëŠ” ì˜ì–´ê°€ ë”¸ë ¤ì„œ ê²°êµ­ ì½”ë“œë¥¼ ê¹Œë´£ì§€&mldr;-_- ì°¨ë¼ë¦¬ C++ì´ ë” ì‰¬ì›Œ)</p></div><div class=tags><a href=https://if1live.github.io/tags/cpp/>cpp</a>
<a href=https://if1live.github.io/tags/cocos2dx/>cocos2dx</a></div><hr><div class=pagination><div class="left pagination-item"><a href=https://if1live.github.io/posts/class-init-with-memset/>ğŸ¡° memsetë¡œ í´ë˜ìŠ¤ ì´ˆê¸°í™” ì‰½ê²Œ í•˜ê¸°</a></div><div class="right pagination-item"><a href=https://if1live.github.io/posts/charp-like-property/>C#ì˜ í”„ë¡œí¼í‹° C++ì—ì„œ ì“°ê¸° ğŸ¡²</a></div></div><div class=see-also><h2>See Also</h2><ul><li><a href=/posts/ccpoint-lua/>cocos2d-x 1.x->2.0ìœ¼ë¡œ ë³€í•˜ë©´ì„œ ë°”ë€ ë¶€ë¶„ :: CCPoint</a></li><li><a href=/posts/box2d-stack-allocator/>Box2d Stack Allocator</a></li><li><a href=/posts/charp-like-property/>C#ì˜ í”„ë¡œí¼í‹° C++ì—ì„œ ì“°ê¸°</a></li><li><a href=/posts/auto-ptr/>auto_ptrì„ ì»ëŠ”ë° ì†Œë©¸ìê°€ ë¶ˆë¦¬ì§€ ì•ŠëŠ”ë‹¤?</a></li><li><a href=/posts/class-init-with-memset/>memsetë¡œ í´ë˜ìŠ¤ ì´ˆê¸°í™” ì‰½ê²Œ í•˜ê¸°</a></li></ul></div><div id=comment><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//libsora.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></section></div><footer class=sora-footer><p><a href=//gohugo.io/ title=Hugo>Hugo</a> |
<a href=//twitter.com/if1live/ title=@if1live>@if1live</a></p></footer><script src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js integrity="sha512-BttltKXFyWnGZQcRWj6osIg7lbizJchuAMotOkdLxHxwt/Hyo+cl47bZU0QADg+Qt5DJwni3SbYGXeGMB5cBcw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-clike.min.js integrity="sha512-/Rynaa6ehLZJO9fdk+EUsgiOdJqFSFUB4Qgy+gP4vU4U1DrmPJWypfXe1CgyaV7rRdZjGxdpLe9djxhx1ZHvqQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js integrity="sha512-8VrjxGFLIkS0mgEmO3p46A5OkqATHhrNVwyv2V7yUeZrk1jmSDuI3SOEpC9XHEHUWEOsfzzcJeBlUkee9lKGrw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js integrity="sha512-namzGTZvHaug0jeipHRN2pMepMiJj+EbrloktVFlMYGnA0EwZhbdLeENjBYLCgoghVbZGinIz/FFYHmB0o3wLw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js integrity="sha512-uOw7XYETzS/DPmmirpP5UCMihSDNMeyTS965J0/456OSPfxn9xEtHHjj5Q/5WefVdqyMfN/afmQnNpZd/tpkcA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js integrity="sha512-AKaNmg8COK0zEbjTdMHJAPJ0z6VeNqvRvH4/d5M4sHJbQQUToMBtodq4HaV4fa+WV2UTfoperElm66c9/8cKmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js integrity="sha512-jwrwRWZWW9J6bjmBOJxPcbRvEBSQeY4Ad0NEXSfP0vwYi/Yu9x5VhDBl3wz6Pnxs8Rx/t1P8r9/OHCRciHcT7Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js integrity="sha512-xKcnbsdT0KMoA4yrozkqZM1XJVTrPsjdQwvigxlAlxEDu8YDvC/jl+LfVqn0fY3Vs6m2y4a89JCHEIA/Z9zpmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js integrity="sha512-pmt3kb6dRndjFXFFwCa3rSzuUQ0GjeCfC5QULWde+8ZBIsUzuP1heOIOSAMfAyXHSufrrTp8h7UHw85K4IJ2/g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js integrity="sha512-whYhDwtTmlC/NpZlCr6PSsAaLOrfjVg/iXAnC4H/dtiHawpShhT2SlIMbpIhT/IL/NrpdMm+Hq2C13+VKpHTYw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-ruby.min.js integrity="sha512-/Dti0iV9cxgJe8r0U/89YJIv9ZBQu1ExEWffVyBj4juMQ4GNglQ3TQ0Up4gcbiHvg0g87arcUFbKBtw2PxH1Dw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js integrity="sha512-w200Nz1i9KgDNi+IpPMgpZBVRIvfVK/V5vskyHjkz7XJkVnRJcb1uNmpiHhDv0/Ln+GG2VqScKKz/1izBfg64Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-less.min.js integrity="sha512-lL5HvfIycntK04Iiai/VTsyuj7mvDkhz9k+cA8fqXr932s4jLJ1YwplIs6Dhpw0pzVwAe1jGe8sGwbyuHG44QQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-scss.min.js integrity="sha512-aczOaJ+mB9uGT6dMJbDaUsS2PWG+XII+1ypFQ0L22Z132V6kMM6m70pQssXsPAFmLI5xkgx/hknBuUuJIJKZfA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js integrity="sha512-uMdVuOpm+9lNPCT7mV/YaMb9YQ/R4+eeON7aEMj6Ig/f4BoU+Q5k6iaZkDsX7LH9cjTHZt0CuKxbzd0/fndrWA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js integrity="sha512-QXFMVAusM85vUYDaNgcYeU3rzSlc+bTV4JvkfJhjxSHlQEo+ig53BtnGkvFTiNJh8D+wv6uWAQ2vJaVmxe8d3w==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js integrity="sha512-6O/PZimM3TD1NN3yrazePA4AbZrPcwt1QCGJrVY7WoHDJROZFc9TlBvIKMe+QfqgcslW4lQeBzNJEJvIMC8WhA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-batch.min.js integrity="sha512-tPgIjUKiv2HcUAIWXA3v6G4cNuWXkoMsF+ibxfHLnp+/s1C3Bw5/qp78+JjhrfoyWIiHXHx0LtH4M/LAwyQqWg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lisp.min.js integrity="sha512-W461RnQzrhSCQQMfEGFKOHbK2DuJTVxrXs2PzctPaxV3A+qPB/TcnMgucSsBNkyccNK8VoENBsAnbf/SuBE71g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin=anonymous></script>
<script>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]});for(var inlineMathArray=document.querySelectorAll("script[type='math/tex']"),inlineMath,tex,replaced,displayMathArray,displayMath,i=0;i<inlineMathArray.length;i++)inlineMath=inlineMathArray[i],tex=inlineMath.innerText||inlineMath.textContent,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex,{displayMode:!1}),inlineMath.parentNode.replaceChild(replaced,inlineMath);displayMathArray=document.querySelectorAll("script[type='math/tex; mode=display']");for(i=0;i<displayMathArray.length;i++)displayMath=displayMathArray[i],tex=displayMath.innerHTML,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex.replace(/%.*/g,""),{displayMode:!0}),displayMath.parentNode.replaceChild(replaced,displayMath)</script></body></html>