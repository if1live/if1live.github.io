<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.116.1"><title>System Calls - if1live space</title><meta name=author content="if1live"><meta name=title content="System Calls"><meta name=description content="ì‹œìŠ¤í…œ í”„ë¡œê·¸ë˜ë° ì‹œí—˜ ê³µë¶€í•˜ë©´ì„œ ì •ë¦¬í•œ ë‚´ìš©ì´ë‹¤. ë‚´ìš© ê°±ì‹ ì€ ì•ìœ¼ë¡œ ì—†ë‹¤. System Call System Call Principles ì–´í”Œë¦¬ì¼€ì´ì…˜ê³¼ í•˜ë“œì›¨ì–´ ì‚¬ì´ì— ë³„ë„ì˜ ë ˆì´ì–´ë¥¼ ë¼ì›Œë„£ëŠ”ë‹¤ í”„ë¡œê·¸ë˜ë°"><meta name=keywords content="linux,system programming,system call"><meta name=naver-site-verification content="2ddc1a56777489f4a64a4f6a59822f8b1c1ea502"><meta name=google-site-verification content="VsvNNnJZUV-iLEYKNju16p-HtDqZeqL15H-VVy-HwpA"><meta name=gc:client-id content="785d47c81cbc2fd42b65"><meta name=gc:client-secret content="5e5d558f0b16fae154aa47fc9d94f7c09e540ec7"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><script type=text/javascript>var host="if1live.github.io";host==window.location.host&&window.location.protocol!="https:"?window.location.protocol="https":console.log("skip https redirect")</script><link rel=stylesheet href=/css/style.ad6245cc6a90c30a30dba42b8bbe9be63bed9ea169e339d8ecfc6b9afc6eb8382bbd422b2d31dc71c3355c79f057ddcaa7e1ca96b5eb7f5f16a28a34e74051db.css integrity="sha512-rWJFzGqQwwow26Qri76b5jvtnqFp4znY7PxrmvxuuDgrvUIrLTHcccM1XHnwV93Kp+HKlrXrf18Wooo050BR2w=="><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css integrity="sha512-cbQXwDFK7lj2Fqfkuxbo5iD1dSbLlJGXGpfTDqbggqjHJeyzx88I3rfwjS38WJag/ihH7lzuGlGHpDBymLirZQ==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin=anonymous><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-3043297488880636",enable_page_level_ads:!0})</script><meta property="og:title" content="System Calls"><meta property="og:description" content="ì‹œìŠ¤í…œ í”„ë¡œê·¸ë˜ë° ì‹œí—˜ ê³µë¶€í•˜ë©´ì„œ ì •ë¦¬í•œ ë‚´ìš©ì´ë‹¤. ë‚´ìš© ê°±ì‹ ì€ ì•ìœ¼ë¡œ ì—†ë‹¤. System Call System Call Principles ì–´í”Œë¦¬ì¼€ì´ì…˜ê³¼ í•˜ë“œì›¨ì–´ ì‚¬ì´ì— ë³„ë„ì˜ ë ˆì´ì–´ë¥¼ ë¼ì›Œë„£ëŠ”ë‹¤ í”„ë¡œê·¸ë˜ë°"><meta property="og:type" content="article"><meta property="og:url" content="https://if1live.github.io/posts/system-prog-system-call/"><meta property="og:image" content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-11-22T00:00:00+00:00"><meta property="article:modified_time" content="2014-11-22T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07?size=160"><meta name=twitter:title content="System Calls"><meta name=twitter:description content="ì‹œìŠ¤í…œ í”„ë¡œê·¸ë˜ë° ì‹œí—˜ ê³µë¶€í•˜ë©´ì„œ ì •ë¦¬í•œ ë‚´ìš©ì´ë‹¤. ë‚´ìš© ê°±ì‹ ì€ ì•ìœ¼ë¡œ ì—†ë‹¤. System Call System Call Principles ì–´í”Œë¦¬ì¼€ì´ì…˜ê³¼ í•˜ë“œì›¨ì–´ ì‚¬ì´ì— ë³„ë„ì˜ ë ˆì´ì–´ë¥¼ ë¼ì›Œë„£ëŠ”ë‹¤ í”„ë¡œê·¸ë˜ë°"><meta name=twitter:site content="@if1live"><script async src="https://www.googletagmanager.com/gtag/js?id=G-SKE54STL16"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SKE54STL16",{anonymize_ip:!1})}</script></head><body><nav class=sora-navigation><a href=/ title=home><h1>if1live space</h1></a><ul class=menu-button-list><li><a href=/posts title=archive><i class="fa-solid fa-box-archive"></i>
<span hidden>archive</span></a></li><li><a href=/tags title=tags><i class="fa-solid fa-tags"></i>
<span hidden>tags</span></a></li><li><a href=//github.com/if1live title=GitHub><i class="fa-brands fa-github"></i>
<span hidden>GitHub</span></a></li><li><a href=/about title=about><i class="fa-solid fa-info"></i>
<span hidden>about</span></a></li><li><a href=https://if1live.github.io/index.xml title=RSS><i class="fa-solid fa-rss"></i>
<span hidden>RSS</span></a></li></ul></nav><div class=main><section id=single><h1 class=title><span>System Calls</span><br><small>2014ë…„ 2í•™ê¸° ì‹œìŠ¤í…œ í”„ë¡œê·¸ë˜ë° ì‹œí—˜ ê³µë¶€</small></h1><div class=tip><time datetime="2014-11-22 00:00:00 +0000 UTC">2014. 11. 22</time></div><div class=content><p>ì‹œìŠ¤í…œ í”„ë¡œê·¸ë˜ë° ì‹œí—˜ ê³µë¶€í•˜ë©´ì„œ ì •ë¦¬í•œ ë‚´ìš©ì´ë‹¤. ë‚´ìš© ê°±ì‹ ì€ ì•ìœ¼ë¡œ ì—†ë‹¤.</p><h1 id=system-call>System Call</h1><h2 id=system-call-principles>System Call Principles</h2><ul><li>ì–´í”Œë¦¬ì¼€ì´ì…˜ê³¼ í•˜ë“œì›¨ì–´ ì‚¬ì´ì— ë³„ë„ì˜ ë ˆì´ì–´ë¥¼ ë¼ì›Œë„£ëŠ”ë‹¤<ul><li>í”„ë¡œê·¸ë˜ë° í•˜ê¸° ì‰½ë‹¤<ul><li>í•˜ë“œì›¨ì–´ ì¥ì¹˜ì˜ low-level í”„ë¡œê·¸ë˜ë° íŠ¹ì§•ì„ ëª°ë¼ë„ ëœë‹¤.</li></ul></li><li>ì‹œìŠ¤í…œ ë³´ì•ˆ í–¥ìƒ<ul><li>ì»¤ë„ì€ ì¸í„°í˜ì´ìŠ¤ ë ˆë²¨ì—ì„œ ìš”ì²­ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤</li><li>sys call == ì»¤ë„ê³¼ ì†Œí†µí•˜ëŠ” ìœ ì¼í•œ í†µë¡œ</li></ul></li><li>í”„ë¡œê·¸ë¨ ì´ì‹ì„± í–¥ìƒ¹</li></ul></li><li>System calls<ul><li>ìœ ì € ëª¨ë“œ í”„ë¡œì„¸ìŠ¤ - í•˜ë“œì›¨ì–´ ì¥ì¹˜ ì‚¬ì´ì˜ ì¸í„°í˜ì´ìŠ¤</li><li>ì»¤ë„ ì„œë¹„ìŠ¤ë¥¼ ìš”ì²­</li></ul></li></ul><h2 id=posix-apis-and-system-calls>POSIX APIs and System calls</h2><ul><li>API (Application Programming Interface)<ul><li>ì£¼ì–´ì§„ ì„œë¹„ìŠ¤ë¥¼ êµ¬í•˜ëŠ” ë°©ë²•ì„ ì§€ì •í•˜ëŠ” í•¨ìˆ˜ ì •ì˜</li><li>ex) POSIX APIì¸ malloc(), calloc(), free()ëŠ” libcì•ˆì— brk() system callë¡œ êµ¬í˜„ë˜ì–´ ìˆë‹¤.</li><li>í”„ë¡œê·¸ë˜ë¨¸ì˜ ê´€ì  : ìœ ì € ëª¨ë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬</li></ul></li><li>System call<ul><li>ì†Œí”„íŠ¸ì›¨ì–´ ì¸í„°ëŸ½íŠ¸ë¥¼ í†µí•œ ì»¤ë„ ëª¨ë“œë¡œì˜ ëª…ì‹œì  ìš”ì²­<ul><li>ì»¤ë„ ë””ìì´ë„ˆì˜ ê´€ì  : ì»¤ë„ ì•ˆì— ì†í•œë‹¤</li></ul></li><li>ì¼ë¶€ ì‹œìŠ¤í…œ ì½œì€ 1ê°œ ì´ìƒì˜ ì¸ìë¥¼ ë°›ëŠ”ë‹¤</li><li>Return interger value<ul><li>ì‹¤íŒ¨ì‹œ ë¦¬í„´ê°’ì€ -1, errnoë¥¼ ì„¤ì •(ì—ëŸ¬ì½”ë“œëŠ” include/asm-i386/errno.h ì°¸ê³ )</li></ul></li><li><strong>user spaceì•ˆì˜ libcì•ˆì— wrapperí•¨ìˆ˜ë¡œì¨ êµ¬í˜„</strong></li></ul></li></ul><h2 id=system-call-handling-in-ia32linux>System Call Handling in IA32/Linux</h2><h3 id=system-callì„-í˜¸ì¶œì¢…ë£Œí•˜ëŠ”-2ê°€ì§€-ë°©ë²•>system callì„ í˜¸ì¶œ/ì¢…ë£Œí•˜ëŠ” 2ê°€ì§€ ë°©ë²•</h3><ul><li><code>int 0x80</code>, <code>iret</code> Assembly ëª…ë ¹ì–´<ul><li>ì˜›ë‚  ë²„ì „ ë¦¬ëˆ…ìŠ¤ ì»¤ë„</li><li>ìœ ì €ëª¨ë“œì—ì„œ ì»¤ë„ëª¨ë“œë¡œ ë°”ê¾¸ëŠ” ìœ ì¼í•œ ë°©ë²•</li></ul></li><li><code>sysenter</code>, <code>sysexit</code> Assembly ëª…ë ¹ì–´<ul><li>Intel Pentinum II ë¶€í„° ì‚¬ìš© ê°€ëŠ¥</li><li>ë¦¬ëˆ…ìŠ¤ 2.6 ë¶€í„° ì§€ì›</li></ul></li></ul><h3 id=inplications>Inplications</h3><ul><li>ì»¤ë„ì€ <code>int 0x80</code>, <code>sysenter</code> ë¥¼ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ëª¨ë‘ ì§€ì›í•´ì•¼ í•œë‹¤.</li><li>sysenter ê¸°ë°˜ì˜ í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” int 0x80ë°–ì— ëª»ì“°ëŠ” ì˜›ë‚  ì»¤ë„ì—ë„ ëŒ€ì²˜í•´ì•¼ í•œë‹¤.</li><li>ì»¤ë„ê³¼ í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì˜›ë‚ /ìƒˆë¡œìš´ í”„ë¡œì„¸ì„œ ëª¨ë‘ì—ì„œ ì‘ë™í•´ì•¼ í•œë‹¤.</li></ul><h3 id=overview-of-system-call-handling>Overview of system call handling</h3><ol><li>ëŒ€ë¶€ë¶„ì˜ ë ˆì§€ìŠ¤í„° ë‚´ìš©ì„ ì»¤ë„ ëª¨ë“œ ìŠ¤íƒì— ì €ì¥</li><li>system call service routineì„ í˜¸ì¶œí•´ì„œ ì‹œìŠ¤í…œì½œ ì²˜ë¦¬<ul><li>system call ì§„ì… : int 0x80 or sysenter</li></ul></li><li>í•¸ë“¤ëŸ¬ì—ì„œ ë¹ ì ¸ë‚˜ì˜¬ë•Œ ë ˆì§€ìŠ¤í„° ë‚´ìš©ì„ ë³µêµ¬í•˜ê³  ìœ ì €ëª¨ë“œë¡œ ë³µê·€<ul><li>system call ì¢…ë£Œ : system_exit or sysexit</li></ul></li></ol><h2 id=system-call-wrapper-routines>System Call Wrapper Routines</h2><ul><li>ë§¤í¬ë¡œë¥¼ ì´ìš©í•´ì„œ ì‹œìŠ¤í…œì½œ ì •ì˜<ul><li>ì»¤ë„ ì“°ë ˆë“œëŠ” ì‹œìŠ¤í…œì½œì„ í˜¸ì¶œí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ í•¨ìˆ˜ ì‚¬ìš© ëª»í•¨</li><li>í•´ë‹¹ ë˜í¼ ë£¨í‹´ ì„ ì–¸ì„ ë‹¨ìˆœí™”</li><li>macro <code>_syscall0</code> ~ <code>_syscall6</code> (include/asm-i386/unistd.h)</li></ul></li><li>Macro _syscall0 ~ _syscall6<ul><li>0~6 : ì‹œìŠ¤í…œ ì½œì—ì„œ ì‚¬ìš©í•˜ëŠ” ì¸ì ê°¯ìˆ˜<ul><li>system call number ì œì™¸</li></ul></li><li>syscallN()ì€ ì •í™•íˆ (2+2*N)ê°œì˜ ì¸ì í•„ìš”</li><li>6ê°œë¥¼ ì´ˆê³¼í•˜ëŠ” ì¸ìê°€ í•„ìš”í•œ ì‹œìŠ¤í…œì½œ ì •ì˜ ë¶ˆê°€ëŠ¥</li><li>ë¹„í‘œì¤€ ë¦¬í„´ê°’(int ì•„ë‹Œê±°) ì‚¬ìš©í•˜ëŠ” ì‹œìŠ¤í…œì½œ ì •ì˜ ë¶ˆê°€ëŠ¥</li></ul></li></ul><h2 id=system-call-handling-via-int-0x80>System Call Handling via &ldquo;int 0x80&rdquo;</h2><ul><li>ìœ ì € ëª¨ë“œ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì‹œìŠ¤í…œì½œì„ í˜¸ì¶œí•˜ë©´&mldr;<ul><li>CPUëŠ” ì»¤ë„ëª¨ë“œë¡œ ë°”ê¾¸ê³  ì»¤ë„ í•¨ìˆ˜ ì‹¤í–‰ì„ ì‹œì‘</li><li>ë¦¬ëˆ…ìŠ¤ì˜ ê²½ìš°, <code>int $0x80</code> ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ìœ¼ë¡œ ì‹œìŠ¤í…œì½œì„ í˜¸ì¶œí•œë‹¤.</li><li>int 0x80ì€ vector 128ì„ ê°–ê³ ìˆëŠ” programmed exceptionì„ ë°œìƒì‹œí‚¨ë‹¤.</li></ul></li><li>System call number<ul><li>ìš”ì²­ëœ ì‹œìŠ¤í…œì½œì„ êµ¬ë¶„í•˜ëŠ” ëª©ì ìœ¼ë¡œ eax ë ˆì§€ìŠ¤í„°ë¥¼ ì‚¬ìš©</li></ul></li><li>ì‹œìŠ¤í…œ ì½œ í•¸ë“¤ëŸ¬ëŠ” ë‹¤ìŒ ì ˆì°¨ë¥¼ ìˆ˜í–‰<ol><li>system_call() : ì»¤ë„ ëª¨ë“œ ìŠ¤íƒì— ë ˆì§€ìŠ¤í„°ì˜ ë‚´ìš©ì„ ì €ì¥<ul><li><code>SAVE_ALL</code> macro</li></ul></li><li>dispatch table ê¸°ë°˜ì˜ system call service routineë¼ê³  ë¶€ë¥´ëŠ” Cí•¨ìˆ˜ í˜¸ì¶œí•´ì„œ ì‹œìŠ¤í…œì½œ ì²˜ë¦¬<ul><li><code>sys_SystemCallName()</code></li></ul></li><li>system_exit ë„ë‹¬í•˜ë©´ í•¸ë“¤ëŸ¬ ì¢…ë£Œ<ul><li><code>RESTORE_ALL</code> macro : ë ˆì§€ìŠ¤í„° ë‚´ìš© ë³µêµ¬</li></ul></li></ol></li><li>ì‹œìŠ¤í…œì½œ ì´ˆê¸°í™”<ul><li>ì»¤ë„ ì´ˆê¸°í™” ê³¼ì •ì—ì„œ í˜¸ì¶œí•˜ëŠ” <code>trap_init()</code></li><li>vector 128ì— ëŒ€ì‘ë˜ëŠ” IDT entryë¥¼ ì„¤ì •</li><li><code>set_system_gate(0x80, &amp;system_call);</code></li></ul></li><li><code>system_call()</code><ul><li>ì–´ì…ˆë¸”ë¦¬ë¡œ ì‘ì„±ëœ ì½”ë“œ</li><li>system call number (eax), exception handlerì—ì„œ ì‚¬ìš©í•˜ëŠ” CPU ë ˆì§€ìŠ¤í„°ë¥¼ ìŠ¤íƒì— ì €ì¥<ul><li>eflags, cs, eip, ss, espëŠ” ì œì™¸. ì´ê²ƒì€ hardware control unitê°€ ìë™ìœ¼ë¡œ ì €ì¥</li><li><code>pushl %eax</code></li><li><code>SAVE_ALL</code></li></ul></li><li>í˜„ì¬ í”„ë¡œì„¸ìŠ¤ì˜ thread_info ì£¼ì†Œë¥¼ ebpì— ì €ì¥<ul><li><code>GET_THREAD_INFO(%ebp)</code></li></ul></li><li>system call numberì˜ ê²€ì¦</li><li>ì˜¬ë°”ë¥´ë©´ system call numberì— ì—°ê²°ëœ ì„œë¹„ìŠ¤ ë£¨í‹´ í˜¸ì¶œ</li></ul></li></ul><h2 id=system-call-dispatch-table>System Call Dispatch Table</h2><ul><li>ì‹œìŠ¤í…œì½œì˜ ì„œë¹„ìŠ¤ ë£¨í‹´ ì£¼ì†Œë¥¼ ì €ì¥<ul><li><code>sys_call_table</code> ë°°ì—´</li><li><code>NR_syscalls</code> ê°œì˜ ì—”íŠ¸ë¦¬ (2.6.11 ê¸°ì¤€ 289)</li><li>2.6 ê¸°ì¤€ ì‹¤ì œë¡œ êµ¬í˜„ëœê±´ 280ê°œ ì •ë„</li><li><code>sys_ni_syscall</code> : not implemented. ë‚˜ì¤‘ì— ì“¸ ìˆ˜ ìˆë„ë¡ ì˜ˆì•½</li></ul></li></ul><h2 id=system-call-handling-via-int-0x80-summary>System Call Handling via &ldquo;int 0x80&rdquo; Summary</h2><ol><li>ìœ ì € í”„ë¡œì„¸ìŠ¤ì—ì„œ <code>fork()</code>ë¥¼ í˜¸ì¶œ</li><li><code>fork()</code>ê°€ ì •ì˜ëœ libc.aì—ì„œ <code>int $0x80</code></li><li>IDTì˜ 0x80(128)ë²ˆì§¸ entryì—ëŠ” <code>system_call()</code> í•¨ìˆ˜ê°€ ìˆë‹¤. ì´ë¥¼ í˜¸ì¶œ.</li><li><code>system_call()</code>ì—ì„œ eaxì— ì €ì¥ëœ system call numberë¥¼ ì´ìš©í•´ì„œ <code>sys_call_table</code> ì ‘ê·¼</li><li>forkì˜ ë²ˆí˜¸ëŠ” 2. <code>sys_call_table</code>ì˜ 2ë²ˆì§¸ í•­ëª©ì—ëŠ” <code>sys_fork()</code> ì£¼ì†Œê°€ ìˆë‹¤. ì´ë¥¼ í˜¸ì¶œ</li></ol><h2 id=system-call-handling-via-sysenter>System Call Handling via &ldquo;sysenter&rdquo;</h2><ul><li>ë¹ ë¥¸ ì‹œìŠ¤í…œì½œ<ul><li><code>int</code> ëª…ë ¹ì–´ëŠ” ëª‡ëª‡ ì¼ê´€ì„±/ë³´ì•ˆ ê²€ì¦ ë•Œë¬¸ì— ëŠë¦¬ë‹¤.</li><li><code>sysenter</code>ëŠ” ìœ ì €ëª¨ë“œì—ì„œ ì»¤ë„ëª¨ë“œë¡œ ë°”ê¾¸ëŠ” ë¹ ë¥¸ ë°©ë²•</li><li>ì¼ë¶€ x86ì—ì„œë§Œ ì‚¬ìš©ê°€ëŠ¥ (íœí‹°ì—„2ì—ì„œ ì¶”ê°€ë¨)</li><li>CPUì™€ ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì´ ë™ì‹œì— ì§€ì›í• ë•Œ libcì˜ ë˜í¼í•¨ìˆ˜ê°€ sysenterë¥¼ ì´ìš©í• ìˆ˜ ìˆë‹¤.</li></ul></li><li>ì‹œìŠ¤í…œ ì½œ ì§„ì…<ul><li><code>__kernel_vsyscall()</code>ì„ ì´ìš©í•´ì„œ ë ˆì§€ìŠ¤í„° ì €ì¥</li><li><code>sysenter_entry()</code>ëŠ” <code>system_call()</code> ê³¼ ìœ ì‚¬í•œ í–‰ë™</li></ul></li><li>ì‹œìŠ¤í…œ ì½œ íƒˆì¶œ(exit)<ul><li><code>sysexit</code> ëª…ë ¹ì–´ : ì»¤ë„ëª¨ë“œì—ì„œ ìœ ì €ëª¨ë“œë¡œ ë°”ê¾¸ëŠ” ë¹ ë¥¸ ë°©ë²•</li></ul></li></ul><h2 id=parameter-passing>Parameter Passing</h2><ul><li>CPU ë ˆì§€ìŠ¤í„°ë¥¼ í†µí•´ ì»¤ë„ ëª¨ë“œ ìŠ¤íƒìœ¼ë¡œ ë³µì‚¬<ul><li>ë ˆì§€ìŠ¤í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ì‹œìŠ¤í…œì½œ í•¸ë“¤ëŸ¬ì˜ êµ¬ì¡°ë¥¼ ë‹¤ë¥¸ exception í•¸ë“¤ëŸ¬ì™€ ìœ ì‚¬í•˜ê²Œ ë§Œë“¤ìˆ˜ ìˆë‹¤</li></ul></li><li>ë ˆì§€ìŠ¤í„°ë¡œ ì¸ì ë„˜ê¸°ê¸°<ul><li>ê°ê°ì˜ ì¸ìëŠ” 32bit</li><li>ë ˆì§€ìŠ¤í„° ê°¯ìˆ˜ ë•Œë¬¸ì— ì¸ì ìµœëŒ€ 6ê°œë¡œ ì œí•œ<ul><li>eax, ebx, ecx, edx, esi, edi</li></ul></li></ul></li><li>ë³µì¡í•œ ë°ì´í„°?<ul><li>32ë¹„íŠ¸ë³´ë‹¤ í¬ê±°ë‚˜ 6ê°œë¥¼ ë„˜ëŠ” ê²½ìš°?</li><li>POSIX í‘œì¤€ì˜ ê²½ìš°, ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ì¸ìë¡œ ë„˜ê²¨ì„œ ì´ë¥¼ ì²˜ë¦¬</li><li>ì»¤ë„ì€ ìœ ì €ëª¨ë“œ ë©”ëª¨ë¦¬ ì˜ì—­ì— ì½ê¸°/ì“°ê¸° ê°€ëŠ¥</li></ul></li></ul><h2 id=parameter-checking>Parameter Checking</h2><ul><li>ì»¤ë„ì´ ìœ ì €ì˜ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ì „ì— ëª¨ë“  ì¸ìë¥¼ í™•ì¸í•´ì•¼ í•œë‹¤.</li><li>ë°©ë²• : ì£¼ì†Œ ê²€ì‚¬<ul><li>ì¸ìê°€ ì£¼ì†Œë¡œ ë„˜ì–´ì˜¤ë©´ ì»¤ë„ì€ ê·¸ê²ƒì´ í”„ë¡œì„¸ìŠ¤ ì£¼ì†Œ ê³µê°„ì— ìˆëŠ”ì§€ í™•ì¸</li><li>2ê°€ì§€ ë°©ë²•</li></ul></li><li>Method 1<ul><li>í”„ë¡œì„¸ìŠ¤ì˜ ì£¼ì†Œê³µê°„ì— ìˆëŠ”ê°€? ë©”ëª¨ë¦¬ êµ¬ì—­ì€ ì ì ˆí•œ ì ‘ê·¼ ê¶Œí•œì´ ìˆëŠ”ê°€?</li><li>ì‹œê°„ì´ ê±¸ë¦¼ (ê¸°ì¡´ ë¦¬ëˆ…ìŠ¤ì—ì„œ ì‚¬ìš©)</li><li>êµ¬í˜„ì€ ë‹¨ìˆœ</li><li>ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë©”ëª¨ë¦¬ êµ¬ì—­ì˜ ì£¼ì†Œë¥¼ ë„˜ê¸°ëŠ” ë²„ê·¸ëŠ” ìì£¼ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ìƒê°ë³´ë‹¤ ì“¸ëª¨ì—†ëŠ” ê²€ì‚¬ê³¼ì •ì´ ë§ìŒ.</li></ul></li><li>Method 2<ul><li><code>PAGE_OFFSET</code> ë³´ë‹¤ ë‚®ì€ ì£¼ì†Œì¸ê°€?</li><li>íš¨ìœ¨ì ì´ì§€ë§Œ ëŒ€ì¶© ê²€ì¦</li><li>ì§„ì§œ ê²€ì¦ì€ í•„ìš”í•´ì§ˆ ë•Œê¹Œì§€ ë¯¸ë£¬ë‹¤ (dynamic address checking)</li><li>2.2 ë¶€í„° ì‚¬ìš©</li></ul></li></ul><h2 id=accessing-user-space-memory-address>Accessing User-Space Memory Address</h2><ul><li>ìš”êµ¬ì‚¬í•­<ul><li>ì‹œìŠ¤í…œ ì½œ ì„œë¹„ìŠ¤ ë£¨í‹´ì€ ìœ ì € ì£¼ì†Œ ê³µê°„ì— ë°ì´í„°ë¥¼ ì½ê¸°/ì“°ê¸° í•˜ëŠ” ì¼ì´ ìƒê¸´ë‹¤</li></ul></li><li>user-space memory access function<ul><li><code>get_user()</code>, <code>put_user()</code>, <code>copy_from()</code>, <code>copy_to_user()</code> &mldr;</li><li>macro (include/asm-i386/uaccess.h)</li><li><code>__get_user_x()</code>, <code>__put_user_x()</code> ë˜ëŠ” ë‹¤ë¥¸ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œ ì´ìš©</li></ul></li><li>example<ul><li>system call : int stime(time_t *t)</li><li>ëª©ì  : ì‹œìŠ¤í…œ ì‹œê°„ì„ të¡œ ì„¤ì •</li><li>ì¸ìëŠ” ë©”ëª¨ë¦¬ ì£¼ì†Œ</li></ul></li></ul><h2 id=adding-a-new-system-call>Adding a New System Call</h2><ol><li>user-space codeì— ë˜í¼í•¨ìˆ˜ ì¶”ê°€<ul><li>include &lt;linux/unistd.h></li><li>_syscall0() ~ _syscall6() ì´ìš©</li></ul></li><li><code>__NR_newsystemcall</code> ì¶”ê°€<ul><li>include/asm-i386/unistd.h</li><li><code>sys_ni_syscall</code> í•­ëª©ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤</li></ul></li><li>ì»¤ë„ì— ì„œë¹„ìŠ¤ ë£¨í‹´ ì‘ì„±<ul><li><code>asmlinkage int sys_newsyscall()</code></li></ul></li><li>system call dispatch tableì— í•­ëª© ì¶”ê°€<ul><li>arch/i386/kernel/entry.S:<code>entry(sys_call_table)</code></li><li><code>.long sys_newsyscall</code></li></ul></li></ol></div><div class=tags><a href=https://if1live.github.io/tags/linux/>linux</a>
<a href=https://if1live.github.io/tags/system-programming/>system programming</a>
<a href=https://if1live.github.io/tags/system-call/>system call</a></div><hr><div class=pagination><div class="left pagination-item"><a href=https://if1live.github.io/posts/system-prog-timing-measurements/>ğŸ¡° Timing Measurements</a></div><div class="right pagination-item"><a href=https://if1live.github.io/posts/system-prog-signals/>Signals ğŸ¡²</a></div></div><div class=see-also><h2>See Also</h2><ul><li><a href=/posts/system-prog-timing-measurements/>Timing Measurements</a></li><li><a href=/posts/sytem-prog-study-interrupt-and-exceptions/>Interrupt and Exceptions</a></li><li><a href=/posts/system-prog-linux-process-schduling/>Linux Process Scheduling</a></li><li><a href=/posts/system-prog-linux-processes/>Linux Processes</a></li></ul></div><div id=comment><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//libsora.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></section></div><footer class=sora-footer><p><a href=//gohugo.io/ title=Hugo>Hugo</a> |
<a href=//twitter.com/if1live/ title=@if1live>@if1live</a></p></footer><script src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js integrity="sha512-BttltKXFyWnGZQcRWj6osIg7lbizJchuAMotOkdLxHxwt/Hyo+cl47bZU0QADg+Qt5DJwni3SbYGXeGMB5cBcw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-clike.min.js integrity="sha512-/Rynaa6ehLZJO9fdk+EUsgiOdJqFSFUB4Qgy+gP4vU4U1DrmPJWypfXe1CgyaV7rRdZjGxdpLe9djxhx1ZHvqQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js integrity="sha512-8VrjxGFLIkS0mgEmO3p46A5OkqATHhrNVwyv2V7yUeZrk1jmSDuI3SOEpC9XHEHUWEOsfzzcJeBlUkee9lKGrw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js integrity="sha512-namzGTZvHaug0jeipHRN2pMepMiJj+EbrloktVFlMYGnA0EwZhbdLeENjBYLCgoghVbZGinIz/FFYHmB0o3wLw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js integrity="sha512-uOw7XYETzS/DPmmirpP5UCMihSDNMeyTS965J0/456OSPfxn9xEtHHjj5Q/5WefVdqyMfN/afmQnNpZd/tpkcA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js integrity="sha512-AKaNmg8COK0zEbjTdMHJAPJ0z6VeNqvRvH4/d5M4sHJbQQUToMBtodq4HaV4fa+WV2UTfoperElm66c9/8cKmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js integrity="sha512-jwrwRWZWW9J6bjmBOJxPcbRvEBSQeY4Ad0NEXSfP0vwYi/Yu9x5VhDBl3wz6Pnxs8Rx/t1P8r9/OHCRciHcT7Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js integrity="sha512-xKcnbsdT0KMoA4yrozkqZM1XJVTrPsjdQwvigxlAlxEDu8YDvC/jl+LfVqn0fY3Vs6m2y4a89JCHEIA/Z9zpmQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js integrity="sha512-pmt3kb6dRndjFXFFwCa3rSzuUQ0GjeCfC5QULWde+8ZBIsUzuP1heOIOSAMfAyXHSufrrTp8h7UHw85K4IJ2/g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js integrity="sha512-whYhDwtTmlC/NpZlCr6PSsAaLOrfjVg/iXAnC4H/dtiHawpShhT2SlIMbpIhT/IL/NrpdMm+Hq2C13+VKpHTYw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-ruby.min.js integrity="sha512-/Dti0iV9cxgJe8r0U/89YJIv9ZBQu1ExEWffVyBj4juMQ4GNglQ3TQ0Up4gcbiHvg0g87arcUFbKBtw2PxH1Dw==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js integrity="sha512-w200Nz1i9KgDNi+IpPMgpZBVRIvfVK/V5vskyHjkz7XJkVnRJcb1uNmpiHhDv0/Ln+GG2VqScKKz/1izBfg64Q==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-less.min.js integrity="sha512-lL5HvfIycntK04Iiai/VTsyuj7mvDkhz9k+cA8fqXr932s4jLJ1YwplIs6Dhpw0pzVwAe1jGe8sGwbyuHG44QQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-scss.min.js integrity="sha512-aczOaJ+mB9uGT6dMJbDaUsS2PWG+XII+1ypFQ0L22Z132V6kMM6m70pQssXsPAFmLI5xkgx/hknBuUuJIJKZfA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js integrity="sha512-uMdVuOpm+9lNPCT7mV/YaMb9YQ/R4+eeON7aEMj6Ig/f4BoU+Q5k6iaZkDsX7LH9cjTHZt0CuKxbzd0/fndrWA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js integrity="sha512-QXFMVAusM85vUYDaNgcYeU3rzSlc+bTV4JvkfJhjxSHlQEo+ig53BtnGkvFTiNJh8D+wv6uWAQ2vJaVmxe8d3w==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js integrity="sha512-6O/PZimM3TD1NN3yrazePA4AbZrPcwt1QCGJrVY7WoHDJROZFc9TlBvIKMe+QfqgcslW4lQeBzNJEJvIMC8WhA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-batch.min.js integrity="sha512-tPgIjUKiv2HcUAIWXA3v6G4cNuWXkoMsF+ibxfHLnp+/s1C3Bw5/qp78+JjhrfoyWIiHXHx0LtH4M/LAwyQqWg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lisp.min.js integrity="sha512-W461RnQzrhSCQQMfEGFKOHbK2DuJTVxrXs2PzctPaxV3A+qPB/TcnMgucSsBNkyccNK8VoENBsAnbf/SuBE71g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin=anonymous></script>
<script>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]});for(var inlineMathArray=document.querySelectorAll("script[type='math/tex']"),inlineMath,tex,replaced,displayMathArray,displayMath,i=0;i<inlineMathArray.length;i++)inlineMath=inlineMathArray[i],tex=inlineMath.innerText||inlineMath.textContent,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex,{displayMode:!1}),inlineMath.parentNode.replaceChild(replaced,inlineMath);displayMathArray=document.querySelectorAll("script[type='math/tex; mode=display']");for(i=0;i<displayMathArray.length;i++)displayMath=displayMathArray[i],tex=displayMath.innerHTML,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex.replace(/%.*/g,""),{displayMode:!0}),displayMath.parentNode.replaceChild(replaced,displayMath)</script></body></html>