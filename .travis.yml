language: python

python:
  - "2.7"

env:
  global:
    - secure: "UDqqN6GDX8Bnwh+NJA4ZEDyqs3XJ1fA5noE4y5n2Lu6qXclZ0mEkB/PX+BLb7qQdx6iefrq5+HUQ/JCx7ARCHcPOkDtNalMEwvuAZYO1CrOx7olwFqVN2ORRpjqu4iA3hLrwpuWAiCMUsVkGi0xvTgrCANuW+uHfunO7AkRKngc="

before_install:
  - git config --global user.email "libsora25@gmail.com"
  - git config --global user.name "Travis"

install:
  - sudo apt-get install optipng libjpeg-turbo-progs
  - pip install -r requirements.txt -q
  - npm install -g less

script:
  - git clone --depth 1 --quiet https://${GH_TOKEN}@github.com/if1live/if1live.github.io.git output
  - make publish
  - cp CNAME output

after_success:
  - cd output
  - git add -f .
  - git commit -a -m "add new site content"
  - git push https://${GH_TOKEN}@github.com/if1live/if1live.github.io.git master

branches:
  only:
    - master

notifications:
  email: false

